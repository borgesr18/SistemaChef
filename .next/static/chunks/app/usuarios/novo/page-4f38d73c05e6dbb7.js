(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[184],{13603:function(e,r,a){Promise.resolve().then(a.bind(a,69114))},69114:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return d}});var s=a(3827),t=a(64090),o=a(47907),i=a(57418),n=a(32278),c=a(66651),l=a(99873),u=a(20703),m=e=>{let{className:r="",showTagline:a=!1}=e;return(0,s.jsxs)("span",{className:"inline-flex items-center space-x-2 ".concat(r),children:[(0,s.jsx)(u.default,{src:"/logo.svg",alt:"GastroChef",width:24,height:24}),(0,s.jsx)("span",{className:"font-bold",children:"GastroChef"}),a&&(0,s.jsx)("span",{className:"text-xs whitespace-nowrap",children:"Sistema de Fichas T\xe9cnicas"})]})};function d(){let e=(0,o.useRouter)(),{registrarUsuario:r,usuarioAtual:a}=(0,l.G)(),[u,d]=(0,t.useState)({nome:"",email:"",confirmarEmail:"",senha:"",confirmarSenha:"",role:"viewer"}),[h,f]=(0,t.useState)("");(0,t.useEffect)(()=>{a&&"admin"===a.role||e.replace("/login")},[a,e]);let x=e=>{d({...u,[e.target.name]:e.target.value})},p=async a=>{if(a.preventDefault(),u.email!==u.confirmarEmail){f("Emails n\xe3o conferem");return}if(u.senha!==u.confirmarSenha){f("Senhas n\xe3o conferem");return}if(!await r({nome:u.nome,email:u.email,senha:u.senha,role:u.role})){f("Email j\xe1 cadastrado ou senha fraca");return}e.push("/login")};return a&&"admin"===a.role?(0,s.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:(0,s.jsxs)(i.Z,{className:"w-96",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)(m,{className:"text-2xl"})}),(0,s.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"Novo Usu\xe1rio"}),h&&(0,s.jsx)("p",{className:"text-sm text-red-600",children:h}),(0,s.jsx)(n.Z,{label:"Nome",name:"nome",value:u.nome,onChange:x,required:!0}),(0,s.jsx)(n.Z,{label:"Email",type:"email",name:"email",value:u.email,onChange:x,required:!0}),(0,s.jsx)(n.Z,{label:"Confirmar Email",type:"email",name:"confirmarEmail",value:u.confirmarEmail,onChange:x,required:!0}),(0,s.jsx)(n.Z,{label:"Senha",type:"password",name:"senha",value:u.senha,onChange:x,required:!0}),(0,s.jsx)("p",{className:"text-xs text-gray-600",children:"A senha deve ter ao menos 8 caracteres, incluindo letras mai\xfasculas, min\xfasculas, n\xfameros e s\xedmbolos."}),(0,s.jsx)(n.Z,{label:"Confirmar Senha",type:"password",name:"confirmarSenha",value:u.confirmarSenha,onChange:x,required:!0}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Perfil"}),(0,s.jsxs)("select",{name:"role",value:u.role,onChange:x,className:"border border-[var(--cor-borda)] rounded-md p-2 w-full",children:[(0,s.jsx)("option",{value:"viewer",children:"Visualizador"}),(0,s.jsx)("option",{value:"editor",children:"Editor"}),(0,s.jsx)("option",{value:"manager",children:"Gerente"}),(0,s.jsx)("option",{value:"admin",children:"Administrador"})]})]}),(0,s.jsx)(c.Z,{type:"submit",variant:"primary",fullWidth:!0,children:"Cadastrar"})]})]})}):null}},66651:function(e,r,a){"use strict";var s=a(3827);a(64090),r.Z=e=>{let{children:r,variant:a="primary",size:t="md",isLoading:o=!1,fullWidth:i=!1,className:n="",disabled:c,...l}=e,u=c||o?"opacity-50 cursor-not-allowed":"";return(0,s.jsxs)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-[var(--cor-acao)] text-white hover:brightness-90 focus:ring-[var(--cor-acao)]",secondary:"bg-[var(--cor-secundaria)] text-white hover:brightness-90 focus:ring-[var(--cor-secundaria)]",success:"bg-[var(--cor-sucesso)] text-white hover:brightness-90 focus:ring-[var(--cor-sucesso)]",danger:"bg-[var(--cor-erro)] text-white hover:brightness-90 focus:ring-[var(--cor-erro)]",outline:"bg-white text-[var(--cor-texto-principal)] border border-[var(--cor-borda)] hover:bg-gray-50 focus:ring-[var(--cor-acao)]"}[a]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[t]," ").concat(i?"w-full":""," ").concat(u," ").concat(n),disabled:c||o,...l,children:[o&&(0,s.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})}},57418:function(e,r,a){"use strict";var s=a(3827);a(64090),r.Z=e=>{let{children:r,title:a,className:t="",footer:o}=e;return(0,s.jsxs)("div",{className:"card overflow-hidden ".concat(t),children:[a&&(0,s.jsx)("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:(0,s.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:a})}),(0,s.jsx)("div",{className:"p-6",children:r}),o&&(0,s.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:o})]})}},32278:function(e,r,a){"use strict";var s=a(3827);let t=(0,a(64090).forwardRef)((e,r)=>{let{label:a,error:t,helperText:o,className:i="",...n}=e;return(0,s.jsxs)("div",{className:"mb-4",children:[a&&(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--cor-texto-principal)"},children:a}),(0,s.jsx)("input",{ref:r,className:"w-full input ".concat(t?"border-[var(--cor-erro)]":""," ").concat(i),...n}),t&&(0,s.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--cor-erro)"},children:t}),o&&!t&&(0,s.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--cor-texto-secundario)"},children:o})]})});t.displayName="Input",r.Z=t},1877:function(e,r,a){"use strict";a.d(r,{O:function(){return s}});let s=(0,a(28896).createBrowserClient)("https://sutmfzcmrlqnocsusiav.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1dG1memNtcmxxbm9jc3VzaWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1MzgwODMsImV4cCI6MjA2NjExNDA4M30.BQRo64qRNzqB_XGNeSe4jkZ8Mzzji8eUYVbS_nWw8tI")},99873:function(e,r,a){"use strict";a.d(r,{G:function(){return n}});var s=a(64090),t=a(1877);a(3827),a(47907);let o=(0,s.createContext)(void 0),i=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},n=()=>{let{user:e,signOut:r}=i(),[a,o]=(0,s.useState)(null),[n,c]=(0,s.useState)([]),[l,u]=(0,s.useState)(!0),m=async()=>{if(!e)return;let{data:r,error:a}=await t.O.from("perfis_usuarios").select("*").eq("user_id",e.id).single();if(a){console.error("Erro ao buscar perfil do usu\xe1rio:",a);return}o(r)},d=async()=>{let{data:e,error:r}=await t.O.from("perfis_usuarios").select("*").order("nome");if(r){console.error("Erro ao buscar lista de usu\xe1rios:",r);return}c(e||[])};return(0,s.useEffect)(()=>{(async()=>{e&&(await m(),await d()),u(!1)})()},[e]),{usuarioAtual:a,usuarios:n,isLoading:l,logout:async()=>{await r(),o(null)},registrarUsuario:async e=>{var r;let{nome:a,email:s,senha:o,role:i}=e,{data:n,error:c}=await t.O.auth.admin.createUser({email:s,password:o,email_confirm:!0});if(c||!(null==n?void 0:null===(r=n.user)||void 0===r?void 0:r.id))return console.error("Erro ao criar usu\xe1rio:",c),!1;let{error:l}=await t.O.from("perfis_usuarios").insert({user_id:n.user.id,nome:a,role:i,ativo:!0});return l?(console.error("Erro ao inserir perfil:",l),!1):(await d(),!0)},editarUsuario:async(e,r)=>{let{nome:a,role:s}=r,{error:o}=await t.O.from("perfis_usuarios").update({nome:a,role:s}).eq("id",e);return o?(console.error("Erro ao editar usu\xe1rio:",o),!1):(await d(),!0)},alterarSenha:async(e,r)=>{let{error:a}=await t.O.auth.admin.updateUserById(e,{password:r});return!a||(console.error("Erro ao alterar senha:",a),!1)},removerUsuario:async e=>{let{error:r}=await t.O.from("perfis_usuarios").delete().eq("id",e);return r?(console.error("Erro ao remover usu\xe1rio:",r),!1):(await d(),!0)}}}}},function(e){e.O(0,[958,703,971,655,744],function(){return e(e.s=13603)}),_N_E=e.O()}]);