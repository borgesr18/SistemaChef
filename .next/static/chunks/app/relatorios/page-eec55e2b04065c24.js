(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4223],{20067:function(){},72061:function(){},56603:function(e,t,a){Promise.resolve().then(a.bind(a,65769))},65769:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(3827),r=a(64090),i=a(92493),o=a(25264),c=a(14323),n=a(57418),d=a(66651),l=a(79173),u=a(53500),h=a(20200),x=a(8792);function m(){let{gerarRelatorioCompleto:e,gerarRelatorioCustos:t,gerarRelatorioIngredientes:a,gerarRelatorioReceitas:m,gerarRelatorioEstoque:g}=(0,u.j)(),[j,p]=(0,r.useState)("completo"),[f,y]=(0,r.useState)(null),[b,N]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{N(!0);try{let s;switch(j){case"custos":s=await t();break;case"ingredientes":s=await a();break;case"receitas":s=await m();break;case"estoque":s=g();break;default:s=await e()}y(s)}catch(e){console.error("Erro ao carregar relat\xf3rio:",e)}finally{N(!1)}})()},[j,e,t,a,m,g]);let v=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),C=async()=>{if(!f)return null;switch(j){case"estoque":return{titulo:"Relat\xf3rio de Estoque",cabecalho:["Produto","Quantidade","Pre\xe7o","Valor Total"],linhas:f.itens.map(e=>[e.nome,String(e.quantidade),v(e.preco),v(e.valorTotal)]),rodape:"Total em estoque: ".concat(v(f.valorTotalEstoque))};case"ingredientes":return{titulo:"Relat\xf3rio de Ingredientes",cabecalho:["Ingrediente","Quantidade","Ocorr\xeancias"],linhas:f.ingredientesMaisUsados.map(e=>[e.nome,"".concat(e.quantidade," ").concat(e.unidade),String(e.ocorrencias)]),rodape:""};case"custos":return{titulo:"Relat\xf3rio de Custos",cabecalho:["Nome","Custo"],linhas:[...f.fichasMaisCustos.map(e=>[e.nome,v(e.custo)]),...f.fichasMenosCustos.map(e=>[e.nome,v(e.custo)])],rodape:"Custo total estimado: ".concat(v(f.custoTotalEstoque))};case"receitas":return{titulo:"Relat\xf3rio de Receitas",cabecalho:["Categoria","Quantidade"],linhas:f.distribuicaoCategoriasReceitas.map(e=>[e.categoria,String(e.quantidade)]),rodape:"Total de fichas t\xe9cnicas: ".concat(f.totalFichasTecnicas)};default:return{titulo:"Relat\xf3rio Completo",cabecalho:["M\xe9trica","Valor"],linhas:[["Total de Produtos",String(f.totalProdutos)],["Total de Fichas T\xe9cnicas",String(f.totalFichasTecnicas)],["Custo Total Estimado",v(f.custoTotalEstoque)],["Custo M\xe9dio por Ficha",v(f.custoMedioPorFicha)]],rodape:""}}},w=async()=>{let e=await C();if(!e)return;let t=new i.ZP;if(t.text(e.titulo,10,10),(0,o.ZP)(t,{head:[e.cabecalho],body:e.linhas,startY:20}),e.rodape){let a=t.lastAutoTable.finalY||20;t.text(e.rodape,10,a+10)}t.save("relatorio.pdf")},P=async()=>{let e=await C();if(!e)return;let t=c.P6.aoa_to_sheet([e.cabecalho,...e.linhas]),a=c.P6.book_new();c.P6.book_append_sheet(a,t,"Relatorio"),c.NC(a,"relatorio.xlsx")},T=()=>(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Total de Produtos"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:f.totalProdutos})]})}),(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Total de Fichas T\xe9cnicas"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:f.totalFichasTecnicas})]})}),(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Custo Total Estimado"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:v(f.custoTotalEstoque)})]})}),(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Custo M\xe9dio por Ficha"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:v(f.custoMedioPorFicha)})]})})]}),(0,s.jsx)(n.Z,{title:"Fichas T\xe9cnicas por Custo",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"Mais Caras"}),f.fichasMaisCustos.length>0?(0,s.jsx)(h.ZP,{headers:["Nome","Custo"],children:f.fichasMaisCustos.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:(0,s.jsx)(x.default,{href:"/fichas-tecnicas/".concat(e.id),className:"text-blue-600 hover:underline",children:e.nome})}),(0,s.jsx)(h.pj,{children:v(e.custo)})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"Mais Econ\xf4micas"}),f.fichasMenosCustos.length>0?(0,s.jsx)(h.ZP,{headers:["Nome","Custo"],children:f.fichasMenosCustos.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:(0,s.jsx)(x.default,{href:"/fichas-tecnicas/".concat(e.id),className:"text-blue-600 hover:underline",children:e.nome})}),(0,s.jsx)(h.pj,{children:v(e.custo)})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})]})]})}),(0,s.jsx)(n.Z,{title:"Ingredientes Mais Utilizados",children:f.ingredientesMaisUsados.length>0?(0,s.jsx)(h.ZP,{headers:["Ingrediente","Quantidade Total","Presente em"],children:f.ingredientesMaisUsados.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.nome}),(0,s.jsxs)(h.pj,{children:[e.quantidade," ",e.unidade]}),(0,s.jsxs)(h.pj,{children:[e.ocorrencias," ",1===e.ocorrencias?"receita":"receitas"]})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum ingrediente utilizado"})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(n.Z,{title:"Distribui\xe7\xe3o de Categorias de Produtos",children:f.distribuicaoCategoriasProdutos.length>0?(0,s.jsx)(h.ZP,{headers:["Categoria","Quantidade","Percentual"],children:f.distribuicaoCategoriasProdutos.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.categoria}),(0,s.jsx)(h.pj,{children:e.quantidade}),(0,s.jsxs)(h.pj,{children:[(e.quantidade/f.totalProdutos*100).toFixed(1),"%"]})]},e.categoria))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum produto cadastrado"})}),(0,s.jsx)(n.Z,{title:"Distribui\xe7\xe3o de Categorias de Receitas",children:f.distribuicaoCategoriasReceitas.length>0?(0,s.jsx)(h.ZP,{headers:["Categoria","Quantidade","Percentual"],children:f.distribuicaoCategoriasReceitas.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.categoria}),(0,s.jsx)(h.pj,{children:e.quantidade}),(0,s.jsxs)(h.pj,{children:[(e.quantidade/f.totalFichasTecnicas*100).toFixed(1),"%"]})]},e.categoria))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})})]})]}),E=()=>(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Custo Total Estimado"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:v(f.custoTotalEstoque)})]})}),(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Custo M\xe9dio por Ficha"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:v(f.custoMedioPorFicha)})]})})]}),(0,s.jsx)(n.Z,{title:"Fichas T\xe9cnicas por Custo",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"Mais Caras"}),f.fichasMaisCustos.length>0?(0,s.jsx)(h.ZP,{headers:["Nome","Custo"],children:f.fichasMaisCustos.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:(0,s.jsx)(x.default,{href:"/fichas-tecnicas/".concat(e.id),className:"text-blue-600 hover:underline",children:e.nome})}),(0,s.jsx)(h.pj,{children:v(e.custo)})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-4",children:"Mais Econ\xf4micas"}),f.fichasMenosCustos.length>0?(0,s.jsx)(h.ZP,{headers:["Nome","Custo"],children:f.fichasMenosCustos.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:(0,s.jsx)(x.default,{href:"/fichas-tecnicas/".concat(e.id),className:"text-blue-600 hover:underline",children:e.nome})}),(0,s.jsx)(h.pj,{children:v(e.custo)})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})]})]})})]}),q=()=>(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(n.Z,{title:"Ingredientes Mais Utilizados",children:f.ingredientesMaisUsados.length>0?(0,s.jsx)(h.ZP,{headers:["Ingrediente","Quantidade Total","Presente em"],children:f.ingredientesMaisUsados.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.nome}),(0,s.jsxs)(h.pj,{children:[e.quantidade," ",e.unidade]}),(0,s.jsxs)(h.pj,{children:[e.ocorrencias," ",1===e.ocorrencias?"receita":"receitas"]})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum ingrediente utilizado"})}),(0,s.jsx)(n.Z,{title:"Distribui\xe7\xe3o de Categorias de Produtos",children:f.distribuicaoCategoriasProdutos.length>0?(0,s.jsx)(h.ZP,{headers:["Categoria","Quantidade","Percentual"],children:f.distribuicaoCategoriasProdutos.map(e=>{let t=f.distribuicaoCategoriasProdutos.reduce((e,t)=>e+t.quantidade,0);return(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.categoria}),(0,s.jsx)(h.pj,{children:e.quantidade}),(0,s.jsxs)(h.pj,{children:[(e.quantidade/t*100).toFixed(1),"%"]})]},e.categoria)})}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum produto cadastrado"})})]}),M=()=>(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsxs)(n.Z,{title:"Estoque Atual",children:[f.itens.length>0?(0,s.jsx)(h.ZP,{headers:["Produto","Quantidade","Pre\xe7o","Valor Total"],children:f.itens.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.nome}),(0,s.jsx)(h.pj,{children:e.quantidade}),(0,s.jsx)(h.pj,{children:v(e.preco)}),(0,s.jsx)(h.pj,{children:v(e.valorTotal)})]},e.id))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhum produto cadastrado"}),(0,s.jsxs)("p",{className:"text-right font-medium mt-4",children:["Total em estoque: ",v(f.valorTotalEstoque)]})]})}),Z=()=>(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-500",children:"Total de Fichas T\xe9cnicas"}),(0,s.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:f.totalFichasTecnicas})]})}),(0,s.jsx)(n.Z,{title:"Distribui\xe7\xe3o de Categorias de Receitas",children:f.distribuicaoCategoriasReceitas.length>0?(0,s.jsx)(h.ZP,{headers:["Categoria","Quantidade","Percentual"],children:f.distribuicaoCategoriasReceitas.map(e=>(0,s.jsxs)(h.SC,{children:[(0,s.jsx)(h.pj,{children:e.categoria}),(0,s.jsx)(h.pj,{children:e.quantidade}),(0,s.jsxs)(h.pj,{children:[(e.quantidade/f.totalFichasTecnicas*100).toFixed(1),"%"]})]},e.categoria))}):(0,s.jsx)("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})})]});return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Relat\xf3rios"}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)(d.default,{variant:"outline",onClick:w,children:[(0,s.jsx)("span",{className:"material-icons mr-1 text-sm",children:"picture_as_pdf"}),"Exportar PDF"]}),(0,s.jsxs)(d.default,{variant:"outline",onClick:P,children:[(0,s.jsx)("span",{className:"material-icons mr-1 text-sm",children:"table_chart"}),"Exportar Excel"]})]})]}),(0,s.jsx)(n.Z,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("label",{className:"font-medium text-gray-700",children:"Tipo de Relat\xf3rio:"}),(0,s.jsx)("div",{className:"w-64",children:(0,s.jsx)(l.Z,{value:j,onChange:e=>p(e.target.value),options:[{value:"completo",label:"Relat\xf3rio Completo"},{value:"custos",label:"Relat\xf3rio de Custos"},{value:"ingredientes",label:"Relat\xf3rio de Ingredientes"},{value:"receitas",label:"Relat\xf3rio de Receitas"},{value:"estoque",label:"Relat\xf3rio de Estoque"}]})})]})}),(()=>{if(b)return(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"text-gray-500",children:"Carregando relat\xf3rio..."})});if(!f)return(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"text-gray-500",children:"Erro ao carregar dados do relat\xf3rio"})});switch(j){case"completo":return T();case"custos":return E();case"ingredientes":return q();case"estoque":return M();case"receitas":return Z();default:return(0,s.jsx)("div",{children:"Tipo de relat\xf3rio n\xe3o encontrado"})}})()]})}},66651:function(e,t,a){"use strict";a.d(t,{z:function(){return d}});var s=a(3827),r=a(64090),i=a(76371),o=a(49769),c=a(22169);let n=(0,o.j)("inline-flex items-center justify-center rounded-2xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-sm",{variants:{variant:{default:"bg-primary text-white hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:o,asChild:d=!1,...l}=e,u=d?i.g7:"button";return(0,s.jsx)(u,{className:(0,c.cn)(n({variant:r,size:o,className:a})),ref:t,...l})});d.displayName="Button"},79173:function(e,t,a){"use strict";var s=a(3827);let r=(0,a(64090).forwardRef)((e,t)=>{let{label:a,error:r,helperText:i,options:o,className:c="",...n}=e;return(0,s.jsxs)("div",{className:"mb-4",children:[a&&(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a}),(0,s.jsxs)("select",{ref:t,className:"w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 \n            ".concat(r?"border-red-500":"border-gray-300"," \n            ").concat(c),...n,children:[(0,s.jsx)("option",{value:"",children:"Selecione..."}),o.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))]}),r&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:r}),i&&!r&&(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:i})]})});r.displayName="Select",t.Z=r},20200:function(e,t,a){"use strict";a.d(t,{SC:function(){return i},pj:function(){return o}});var s=a(3827),r=a(64090);let i=e=>{let{children:t,className:a="",...r}=e;return(0,s.jsx)("tr",{className:"odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ".concat(a),...r,children:t})},o=e=>{let{children:t,className:a="",compact:r=!1}=e;return(0,s.jsx)("td",{className:"".concat(r?"px-2 py-2":"px-6 py-4"," text-sm ").concat(a),style:{color:"var(--cor-texto-secundario)"},children:t})};t.ZP=e=>{let{headers:t,children:a,className:i="",emptyMessage:o="Nenhum dado encontrado",isLoading:c=!1}=e;return(0,s.jsx)("div",{className:"w-full overflow-x-hidden rounded-lg border ".concat(i),style:{borderColor:"var(--cor-borda)"},children:(0,s.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[(0,s.jsx)("thead",{className:"bg-gray-100",children:(0,s.jsx)("tr",{children:t.map((e,t)=>(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},t))})}),(0,s.jsx)("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:c?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,s.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{className:"ml-2",children:"Carregando..."})]})})}):r.Children.count(a)>0?a:(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:o})})})]})})}},53018:function(e,t,a){"use strict";a.d(t,{D:function(){return c},u:function(){return n}});var s=a(64090),r=a(32355);let i=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de produtos...");let e=await fetch("/api/categorias",{headers:(0,r.g)()});if(console.log("\uD83D\uDCE1 Response status: ".concat(e.status)),!e.ok){let t=await e.text();throw console.error("❌ Erro na API categorias: ".concat(e.status," - ").concat(t)),Error("Erro ao buscar categorias: ".concat(e.status))}let t=await e.json();return console.log("✅ Categorias carregadas: ".concat(t.length)),t}catch(e){return console.error("❌ Erro ao buscar categorias da API:",e),[]}},o=[{id:"hortifruti",nome:"Hortifruti"},{id:"carnes",nome:"Carnes"},{id:"laticinios",nome:"Latic\xednios"},{id:"graos",nome:"Gr\xe3os e Cereais"},{id:"bebidas",nome:"Bebidas"},{id:"temperos",nome:"Temperos"},{id:"outros",nome:"Outros"}],c=()=>{let[e,t]=(0,s.useState)([]),[a,c]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{try{c(!0);let e=await i();if(0===e.length){for(let t of o)try{if(!e.find(e=>e.nome===t.nome)){let a=await fetch("/api/categorias",{method:"POST",headers:(0,r.g)(),body:JSON.stringify({nome:t.nome})});if(a.ok){let t=await a.json();e.push(t)}else 409===a.status&&console.log("Categoria '".concat(t.nome,"' j\xe1 existe, pulando..."))}}catch(e){console.error("Erro ao criar categoria padr\xe3o:",e)}e=await i()}console.log("Categorias loaded:",(null==e?void 0:e.length)||0),t(e)}catch(e){console.error("Erro ao carregar categorias:",e),t([])}finally{c(!1)}})()},[]);let n=async a=>{try{let s=await fetch("/api/categorias",{method:"POST",headers:(0,r.g)(),body:JSON.stringify({nome:a})});if(!s.ok)throw Error("Erro ao criar categoria");let i=await s.json(),o=[...e,i];return t(o),i}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},d=async(a,s)=>{try{let i=await fetch("/api/categorias/".concat(a),{method:"PUT",headers:(0,r.g)(),body:JSON.stringify({nome:s})});if(!i.ok)throw Error("Erro ao atualizar categoria");let o=await i.json(),c=e.map(e=>e.id===a?o:e);return t(c),o}catch(e){return console.error("Erro ao atualizar categoria:",e),null}},l=async a=>{try{if(!(await fetch("/api/categorias/".concat(a),{method:"DELETE",headers:(0,r.g)()})).ok)throw Error("Erro ao deletar categoria");let s=e.filter(e=>e.id!==a);return t(s),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}};return{categorias:e,isLoading:a,adicionarCategoria:n,atualizarCategoria:d,removerCategoria:l,obterCategoriaPorId:t=>e.find(e=>e.id===t)}},n=async e=>{if(!e)return"N\xe3o informado";let t=(await i()).find(t=>t.id===e);return t?t.nome:e}},53500:function(e,t,a){"use strict";a.d(t,{j:function(){return n}});var s=a(64090),r=a(27742),i=a(53018),o=a(29130),c=a(16297);let n=()=>{let{produtos:e}=(0,r.U)(),{fichasTecnicas:t}=(0,c.vG)(),{calcularEstoqueAtual:a}=(0,o.H)(),n=(0,s.useCallback)(async()=>{let a=e.length,s=t.length,r=e.reduce((e,t)=>e+t.preco,0),o=t.length>0?t.reduce((e,t)=>e+t.custoTotal,0)/t.length:0,n=[...t].sort((e,t)=>t.custoTotal-e.custoTotal),d=n.slice(0,5).map(e=>({id:e.id,nome:e.nome,custo:e.custoTotal})),l=[...n].reverse().slice(0,5).map(e=>({id:e.id,nome:e.nome,custo:e.custoTotal})),u={};t.forEach(e=>{e.ingredientes.forEach(e=>{u[e.produtoId]||(u[e.produtoId]={quantidade:0,ocorrencias:0}),u[e.produtoId].quantidade+=e.quantidade,u[e.produtoId].ocorrencias+=1})});let h=Object.entries(u).map(t=>{let[a,s]=t,r=e.find(e=>e.id===a);return{id:a,nome:r?r.nome:"Produto n\xe3o encontrado",quantidade:s.quantidade,unidade:r?r.unidadeMedida:"",ocorrencias:s.ocorrencias}}).sort((e,t)=>t.ocorrencias-e.ocorrencias).slice(0,10),x={};e.forEach(e=>{let t=e.categoria||"N\xe3o informado";x[t]||(x[t]=0),x[t]+=1});let m=await Promise.all(Object.entries(x).map(async e=>{let[t,a]=e;return{categoria:await (0,i.u)(t),quantidade:a}})).then(e=>e.sort((e,t)=>t.quantidade-e.quantidade)),g={};return t.forEach(e=>{let t=e.categoria;g[t]||(g[t]=0),g[t]+=1}),{totalProdutos:a,totalFichasTecnicas:s,custoTotalEstoque:r,custoMedioPorFicha:o,fichasMaisCustos:d,fichasMenosCustos:l,ingredientesMaisUsados:h,distribuicaoCategoriasProdutos:m,distribuicaoCategoriasReceitas:(await Promise.all(Object.entries(g).map(async e=>{let[t,a]=e;return{categoria:await (0,c.Q_)(t),quantidade:a}}))).sort((e,t)=>t.quantidade-e.quantidade)}},[e,t,a]),d=async()=>{let e=await n();return{custoTotalEstoque:e.custoTotalEstoque,custoMedioPorFicha:e.custoMedioPorFicha,fichasMaisCustos:e.fichasMaisCustos,fichasMenosCustos:e.fichasMenosCustos}},l=async()=>{let e=await n();return{ingredientesMaisUsados:e.ingredientesMaisUsados,distribuicaoCategoriasProdutos:e.distribuicaoCategoriasProdutos}},u=async()=>{let e=await n();return{totalFichasTecnicas:e.totalFichasTecnicas,distribuicaoCategoriasReceitas:e.distribuicaoCategoriasReceitas}};return{gerarRelatorioCompleto:n,gerarRelatorioCustos:d,gerarRelatorioIngredientes:l,gerarRelatorioReceitas:u,gerarRelatorioEstoque:()=>{let t=e.map(e=>{let t=a(e.id);return{id:e.id,nome:e.nome,quantidade:t,preco:e.preco,valorTotal:t*e.preco}}),s=t.reduce((e,t)=>e+t.valorTotal,0);return{itens:t,valorTotalEstoque:s}}}}},22169:function(e,t,a){"use strict";a.d(t,{cn:function(){return i}});var s=a(75504),r=a(51367);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.m6)((0,s.W)(t))}}},function(e){e.O(0,[1425,2505,7176,869,3837,8792,1421,30,2971,8069,1744],function(){return e(e.s=56603)}),_N_E=e.O()}]);