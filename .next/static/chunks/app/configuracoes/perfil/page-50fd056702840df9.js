(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[522],{24694:function(e,r,a){Promise.resolve().then(a.bind(a,91381))},91381:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return c}});var t=a(3827),s=a(64090),o=a(32278),i=a(66651),n=a(93242),l=a(99873);function c(){let{usuarioAtual:e,alterarSenha:r,editarUsuario:a}=(0,l.G)(),[c,u]=(0,s.useState)({nome:"",email:"",role:"viewer"}),[m,d]=(0,s.useState)({senha:"",confirmar:""}),[f,h]=(0,s.useState)(""),[x,p]=(0,s.useState)("");return((0,s.useEffect)(()=>{e&&u({nome:e.nome,email:e.email,role:e.role})},[e]),(0,s.useEffect)(()=>{if(!x)return;let e=setTimeout(()=>p(""),3e3);return()=>clearTimeout(e)},[x]),e)?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(n.Z,{message:x,onClose:()=>p("")}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Perfil"}),(0,t.jsxs)("form",{onSubmit:r=>{r.preventDefault(),a(e.id,c)?(p("Perfil atualizado"),h("")):h("Email j\xe1 cadastrado")},className:"space-y-4 max-w-sm",children:[(0,t.jsx)(o.Z,{label:"Nome",value:c.nome,onChange:e=>u({...c,nome:e.target.value}),required:!0,className:"h-[38px]"}),(0,t.jsx)(o.Z,{label:"Email",type:"email",value:c.email,onChange:e=>u({...c,email:e.target.value}),required:!0,className:"h-[38px]"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Perfil"}),(0,t.jsxs)("select",{value:c.role,onChange:e=>u({...c,role:e.target.value}),className:"border border-[var(--cor-borda)] rounded-md p-2 w-full h-[38px] text-sm",children:[(0,t.jsx)("option",{value:"viewer",children:"Visualizador"}),(0,t.jsx)("option",{value:"editor",children:"Editor"}),(0,t.jsx)("option",{value:"manager",children:"Gerente"}),(0,t.jsx)("option",{value:"admin",children:"Administrador"})]})]}),f&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:f}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(i.Z,{type:"submit",variant:"primary",children:"Salvar Perfil"})})]}),(0,t.jsxs)("form",{onSubmit:a=>{if(a.preventDefault(),m.senha!==m.confirmar){h("Senhas n\xe3o conferem");return}r(e.id,m.senha),d({senha:"",confirmar:""}),h(""),p("Senha alterada")},className:"space-y-4 max-w-sm",children:[(0,t.jsx)(o.Z,{label:"Nova Senha",type:"password",value:m.senha,onChange:e=>d({...m,senha:e.target.value}),required:!0,className:"h-[38px]"}),(0,t.jsx)(o.Z,{label:"Confirmar Senha",type:"password",value:m.confirmar,onChange:e=>d({...m,confirmar:e.target.value}),required:!0,className:"h-[38px]"}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(i.Z,{type:"submit",variant:"primary",children:"Alterar Senha"})})]})]}):(0,t.jsx)("p",{className:"p-4",children:"Nenhum usu\xe1rio logado."})}},66651:function(e,r,a){"use strict";var t=a(3827);a(64090),r.Z=e=>{let{children:r,variant:a="primary",size:s="md",isLoading:o=!1,fullWidth:i=!1,className:n="",disabled:l,...c}=e,u=l||o?"opacity-50 cursor-not-allowed":"";return(0,t.jsxs)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-[var(--cor-acao)] text-white hover:brightness-90 focus:ring-[var(--cor-acao)]",secondary:"bg-[var(--cor-secundaria)] text-white hover:brightness-90 focus:ring-[var(--cor-secundaria)]",success:"bg-[var(--cor-sucesso)] text-white hover:brightness-90 focus:ring-[var(--cor-sucesso)]",danger:"bg-[var(--cor-erro)] text-white hover:brightness-90 focus:ring-[var(--cor-erro)]",outline:"bg-white text-[var(--cor-texto-principal)] border border-[var(--cor-borda)] hover:bg-gray-50 focus:ring-[var(--cor-acao)]"}[a]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[s]," ").concat(i?"w-full":""," ").concat(u," ").concat(n),disabled:l||o,...c,children:[o&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})}},32278:function(e,r,a){"use strict";var t=a(3827);let s=(0,a(64090).forwardRef)((e,r)=>{let{label:a,error:s,helperText:o,className:i="",...n}=e;return(0,t.jsxs)("div",{className:"mb-4",children:[a&&(0,t.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--cor-texto-principal)"},children:a}),(0,t.jsx)("input",{ref:r,className:"w-full input ".concat(s?"border-[var(--cor-erro)]":""," ").concat(i),...n}),s&&(0,t.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--cor-erro)"},children:s}),o&&!s&&(0,t.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--cor-texto-secundario)"},children:o})]})});s.displayName="Input",r.Z=s},93242:function(e,r,a){"use strict";var t=a(3827),s=a(64090);r.Z=e=>{let{message:r,onClose:a}=e;return((0,s.useEffect)(()=>{if(!r)return;let e=setTimeout(a,3e3);return()=>clearTimeout(e)},[r,a]),r)?(0,t.jsx)("div",{className:"fixed top-4 right-4 bg-[var(--cor-sucesso)] text-white px-4 py-2 rounded shadow",children:r}):null}},1877:function(e,r,a){"use strict";a.d(r,{O:function(){return t}});let t=(0,a(28896).createBrowserClient)("https://sutmfzcmrlqnocsusiav.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1dG1memNtcmxxbm9jc3VzaWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1MzgwODMsImV4cCI6MjA2NjExNDA4M30.BQRo64qRNzqB_XGNeSe4jkZ8Mzzji8eUYVbS_nWw8tI")},99873:function(e,r,a){"use strict";a.d(r,{G:function(){return n}});var t=a(64090),s=a(1877);a(3827),a(47907);let o=(0,t.createContext)(void 0),i=()=>{let e=(0,t.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},n=()=>{let{user:e,signOut:r}=i(),[a,o]=(0,t.useState)(null),[n,l]=(0,t.useState)([]),[c,u]=(0,t.useState)(!0),m=async()=>{if(!e)return;let{data:r,error:a}=await s.O.from("perfis_usuarios").select("*").eq("user_id",e.id).single();if(a){console.error("Erro ao buscar perfil do usu\xe1rio:",a);return}o(r)},d=async()=>{let{data:e,error:r}=await s.O.from("perfis_usuarios").select("*").order("nome");if(r){console.error("Erro ao buscar lista de usu\xe1rios:",r);return}l(e||[])};return(0,t.useEffect)(()=>{(async()=>{e&&(await m(),await d()),u(!1)})()},[e]),{usuarioAtual:a,usuarios:n,isLoading:c,logout:async()=>{await r(),o(null)},registrarUsuario:async e=>{var r;let{nome:a,email:t,senha:o,role:i}=e,{data:n,error:l}=await s.O.auth.admin.createUser({email:t,password:o,email_confirm:!0});if(l||!(null==n?void 0:null===(r=n.user)||void 0===r?void 0:r.id))return console.error("Erro ao criar usu\xe1rio:",l),!1;let{error:c}=await s.O.from("perfis_usuarios").insert({user_id:n.user.id,nome:a,role:i,ativo:!0});return c?(console.error("Erro ao inserir perfil:",c),!1):(await d(),!0)},editarUsuario:async(e,r)=>{let{nome:a,role:t}=r,{error:o}=await s.O.from("perfis_usuarios").update({nome:a,role:t}).eq("id",e);return o?(console.error("Erro ao editar usu\xe1rio:",o),!1):(await d(),!0)},alterarSenha:async(e,r)=>{let{error:a}=await s.O.auth.admin.updateUserById(e,{password:r});return!a||(console.error("Erro ao alterar senha:",a),!1)},removerUsuario:async e=>{let{error:r}=await s.O.from("perfis_usuarios").delete().eq("id",e);return r?(console.error("Erro ao remover usu\xe1rio:",r),!1):(await d(),!0)}}}}},function(e){e.O(0,[958,971,655,744],function(){return e(e.s=24694)}),_N_E=e.O()}]);