(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{69014:function(e,r,t){Promise.resolve().then(t.bind(t,8858))},8858:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var a=t(3827),o=t(64090),s=t(20200),n=t(66651),c=t(70492),i=t(32278),l=t(53018);function d(){let{categorias:e,adicionarCategoria:r,atualizarCategoria:t,removerCategoria:d}=(0,l.D)(),{isOpen:u,openModal:m,closeModal:x}=(0,c.d)(),{isOpen:h,openModal:p,closeModal:f}=(0,c.d)(),[g,y]=(0,o.useState)(""),[v,j]=(0,o.useState)({id:"",nome:""}),[b,w]=(0,o.useState)(""),N=(0,o.useRef)(null),C=(e,r)=>{j({id:e,nome:r}),p()},k=e.filter(e=>e.nome.toLowerCase().includes(b.toLowerCase()));return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Categorias de Produtos"}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 grow",children:[(0,a.jsx)(n.Z,{onClick:m,variant:"primary",children:"➕ Nova Categoria"}),(0,a.jsx)(n.Z,{onClick:()=>{let r=JSON.stringify(e,null,2),t=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(t),o=document.createElement("a");o.href=a,o.download="categorias.json",o.click(),URL.revokeObjectURL(a)},variant:"secondary",children:"⬇️ Exportar"}),(0,a.jsx)(n.Z,{onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},variant:"secondary",children:"⬆️ Importar"})]}),(0,a.jsx)("div",{className:"w-full sm:w-[220px]",children:(0,a.jsx)(i.Z,{label:"",placeholder:"Buscar...",value:b,onChange:e=>w(e.target.value),className:"h-[38px]"})})]}),(0,a.jsx)("input",{type:"file",ref:N,className:"hidden",accept:"application/json",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;let o=new FileReader;o.onload=()=>{try{JSON.parse(o.result).forEach(e=>e.nome&&r(e.nome))}catch(e){console.error("Erro ao importar categorias",e)}},o.readAsText(a)}}),(0,a.jsx)("div",{className:"pt-2",children:(0,a.jsx)(s.ZP,{headers:["Nome","A\xe7\xf5es"],children:k.map(e=>(0,a.jsxs)(s.SC,{children:[(0,a.jsx)(s.pj,{children:e.nome}),(0,a.jsxs)(s.pj,{className:"flex items-center space-x-2",children:[(0,a.jsx)(n.Z,{size:"sm",variant:"secondary",onClick:()=>C(e.id,e.nome),children:"✏️ Editar"}),(0,a.jsx)(n.Z,{size:"sm",variant:"danger",onClick:()=>d(e.id),children:"\uD83D\uDDD1️ Excluir"})]})]},e.id))})}),(0,a.jsx)(c.Z,{isOpen:u,onClose:x,title:"Nova Categoria",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(g.trim()),y(""),x()},className:"space-y-4",children:[(0,a.jsx)(i.Z,{label:"Nome",value:g,onChange:e=>y(e.target.value),required:!0}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.Z,{type:"button",variant:"secondary",onClick:x,children:"Cancelar"}),(0,a.jsx)(n.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})}),(0,a.jsx)(c.Z,{isOpen:h,onClose:f,title:"Editar Categoria",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),t(v.id,v.nome.trim()),f()},className:"space-y-4",children:[(0,a.jsx)(i.Z,{label:"Nome",value:v.nome,onChange:e=>j({...v,nome:e.target.value}),required:!0}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.Z,{type:"button",variant:"secondary",onClick:f,children:"Cancelar"}),(0,a.jsx)(n.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})})]})}},66651:function(e,r,t){"use strict";var a=t(3827);t(64090),r.Z=e=>{let{children:r,variant:t="primary",size:o="md",isLoading:s=!1,fullWidth:n=!1,className:c="",disabled:i,...l}=e,d=i||s?"opacity-50 cursor-not-allowed":"";return(0,a.jsxs)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-[var(--cor-acao)] text-white hover:brightness-90 focus:ring-[var(--cor-acao)]",secondary:"bg-[var(--cor-secundaria)] text-white hover:brightness-90 focus:ring-[var(--cor-secundaria)]",success:"bg-[var(--cor-sucesso)] text-white hover:brightness-90 focus:ring-[var(--cor-sucesso)]",danger:"bg-[var(--cor-erro)] text-white hover:brightness-90 focus:ring-[var(--cor-erro)]",outline:"bg-white text-[var(--cor-texto-principal)] border border-[var(--cor-borda)] hover:bg-gray-50 focus:ring-[var(--cor-acao)]"}[t]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[o]," ").concat(n?"w-full":""," ").concat(d," ").concat(c),disabled:i||s,...l,children:[s&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})}},32278:function(e,r,t){"use strict";var a=t(3827);let o=(0,t(64090).forwardRef)((e,r)=>{let{label:t,error:o,helperText:s,className:n="",...c}=e;return(0,a.jsxs)("div",{className:"mb-4",children:[t&&(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--cor-texto-principal)"},children:t}),(0,a.jsx)("input",{ref:r,className:"w-full input ".concat(o?"border-[var(--cor-erro)]":""," ").concat(n),...c}),o&&(0,a.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--cor-erro)"},children:o}),s&&!o&&(0,a.jsx)("p",{className:"mt-1 text-sm",style:{color:"var(--cor-texto-secundario)"},children:s})]})});o.displayName="Input",r.Z=o},70492:function(e,r,t){"use strict";t.d(r,{d:function(){return s}});var a=t(3827),o=t(64090);let s=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],[r,t]=(0,o.useState)(e);return{isOpen:r,openModal:()=>t(!0),closeModal:()=>t(!1),toggleModal:()=>t(!r)}};r.Z=e=>{let{isOpen:r,onClose:t,title:s,children:n,footer:c,size:i="md"}=e,[l,d]=(0,o.useState)(!1);return((0,o.useEffect)(()=>(r?(d(!0),document.body.style.overflow="hidden"):(setTimeout(()=>{d(!1)},200),document.body.style.overflow="auto"),()=>{document.body.style.overflow="auto"}),[r]),l||r)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 ".concat(r?"opacity-100":"opacity-0"," transition-opacity duration-200"),children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:t}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full ".concat({sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[i]," z-10 ").concat(r?"translate-y-0":"translate-y-4"," transition-transform duration-200"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:[(0,a.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:s}),(0,a.jsxs)("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:t,children:[(0,a.jsx)("span",{className:"sr-only",children:"Fechar"}),(0,a.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})]}),(0,a.jsx)("div",{className:"px-6 py-4",children:n}),c&&(0,a.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-end space-x-3",style:{borderColor:"var(--cor-borda)"},children:c})]})]}):null}},20200:function(e,r,t){"use strict";t.d(r,{SC:function(){return s},pj:function(){return n}});var a=t(3827),o=t(64090);let s=e=>{let{children:r,className:t="",...o}=e;return(0,a.jsx)("tr",{className:"odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ".concat(t),...o,children:r})},n=e=>{let{children:r,className:t="",compact:o=!1}=e;return(0,a.jsx)("td",{className:"".concat(o?"px-2 py-2":"px-6 py-4"," text-sm ").concat(t),style:{color:"var(--cor-texto-secundario)"},children:r})};r.ZP=e=>{let{headers:r,children:t,className:s="",emptyMessage:n="Nenhum dado encontrado",isLoading:c=!1}=e;return(0,a.jsx)("div",{className:"w-full overflow-x-hidden rounded-lg border ".concat(s),style:{borderColor:"var(--cor-borda)"},children:(0,a.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsx)("tr",{children:r.map((e,r)=>(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},r))})}),(0,a.jsx)("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:c?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:r.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,a.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,a.jsx)("span",{className:"ml-2",children:"Carregando..."})]})})}):o.Children.count(t)>0?t:(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:r.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:n})})})]})})}},32355:function(e,r,t){"use strict";t.d(r,{g:function(){return o}});let a=()=>localStorage.getItem("auth_token"),o=()=>{let e=a();return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}},53018:function(e,r,t){"use strict";t.d(r,{D:function(){return c},u:function(){return i}});var a=t(64090),o=t(32355);let s=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de produtos...");let e=await fetch("/api/categorias",{headers:(0,o.g)()});if(console.log("\uD83D\uDCE1 Response status: ".concat(e.status)),!e.ok){let r=await e.text();throw console.error("❌ Erro na API categorias: ".concat(e.status," - ").concat(r)),Error("Erro ao buscar categorias: ".concat(e.status))}let r=await e.json();return console.log("✅ Categorias carregadas: ".concat(r.length)),r}catch(e){return console.error("❌ Erro ao buscar categorias da API:",e),[]}},n=[{id:"hortifruti",nome:"Hortifruti"},{id:"carnes",nome:"Carnes"},{id:"laticinios",nome:"Latic\xednios"},{id:"graos",nome:"Gr\xe3os e Cereais"},{id:"bebidas",nome:"Bebidas"},{id:"temperos",nome:"Temperos"},{id:"outros",nome:"Outros"}],c=()=>{let[e,r]=(0,a.useState)([]),[t,c]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{try{c(!0);let e=await s();if(0===e.length){for(let r of n)try{if(!e.find(e=>e.nome===r.nome)){let t=await fetch("/api/categorias",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:r.nome})});if(t.ok){let r=await t.json();e.push(r)}else 409===t.status&&console.log("Categoria '".concat(r.nome,"' j\xe1 existe, pulando..."))}}catch(e){console.error("Erro ao criar categoria padr\xe3o:",e)}e=await s()}console.log("Categorias loaded:",(null==e?void 0:e.length)||0),r(e)}catch(e){console.error("Erro ao carregar categorias:",e),r([])}finally{c(!1)}})()},[]);let i=async t=>{try{let a=await fetch("/api/categorias",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:t})});if(!a.ok)throw Error("Erro ao criar categoria");let s=await a.json(),n=[...e,s];return r(n),s}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},l=async(t,a)=>{try{let s=await fetch("/api/categorias/".concat(t),{method:"PUT",headers:(0,o.g)(),body:JSON.stringify({nome:a})});if(!s.ok)throw Error("Erro ao atualizar categoria");let n=await s.json(),c=e.map(e=>e.id===t?n:e);return r(c),n}catch(e){return console.error("Erro ao atualizar categoria:",e),null}},d=async t=>{try{if(!(await fetch("/api/categorias/".concat(t),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar categoria");let a=e.filter(e=>e.id!==t);return r(a),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}};return{categorias:e,isLoading:t,adicionarCategoria:i,atualizarCategoria:l,removerCategoria:d,obterCategoriaPorId:r=>e.find(e=>e.id===r)}},i=async e=>{if(!e)return"N\xe3o informado";let r=(await s()).find(r=>r.id===e);return r?r.nome:e}}},function(e){e.O(0,[971,69,744],function(){return e(e.s=69014)}),_N_E=e.O()}]);