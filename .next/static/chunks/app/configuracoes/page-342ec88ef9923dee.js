(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[693],{72306:function(e,r,a){Promise.resolve().then(a.bind(a,72902))},47907:function(e,r,a){"use strict";var t=a(15313);a.o(t,"redirect")&&a.d(r,{redirect:function(){return t.redirect}}),a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})},13472:function(e,r,a){"use strict";Object.defineProperty(r,"$",{enumerable:!0,get:function(){return o}});let t=a(15355);function o(e){let{createServerReference:r}=a(97355);return r(e,t.callServer)}},13779:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return d}});var t=a(3827),o=a(64090),s=a(20200),i=a(66651),n=a(70492),c=a(32278),l=a(36806);function d(){let{categorias:e,adicionar:r,atualizar:a,remover:d}=(0,l.O)(),{isOpen:u,openModal:m,closeModal:h}=(0,n.d)(),{isOpen:f,openModal:x,closeModal:g}=(0,n.d)(),[p,j]=(0,o.useState)(""),[v,y]=(0,o.useState)({id:"",nome:""}),[b,N]=(0,o.useState)(""),C=(0,o.useRef)(null),E=(e,r)=>{y({id:e,nome:r}),x()},w=e.filter(e=>e.nome.toLowerCase().includes(b.toLowerCase()));return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Categorias de Receitas"}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 grow",children:[(0,t.jsx)(i.Z,{onClick:m,variant:"primary",children:"➕ Nova Categoria"}),(0,t.jsx)(i.Z,{onClick:()=>{let r=JSON.stringify(e,null,2),a=new Blob([r],{type:"application/json"}),t=URL.createObjectURL(a),o=document.createElement("a");o.href=t,o.download="categorias-receitas.json",o.click(),URL.revokeObjectURL(t)},variant:"secondary",children:"⬇️ Exportar"}),(0,t.jsx)(i.Z,{onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},variant:"secondary",children:"⬆️ Importar"})]}),(0,t.jsx)("div",{className:"w-full sm:w-[220px]",children:(0,t.jsx)(c.Z,{label:"",placeholder:"Buscar...",value:b,onChange:e=>N(e.target.value),className:"h-[38px]"})})]}),(0,t.jsx)("input",{type:"file",ref:C,className:"hidden",accept:"application/json",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!t)return;let o=new FileReader;o.onload=()=>{try{JSON.parse(o.result).forEach(e=>e.nome&&r(e.nome))}catch(e){console.error("Erro ao importar categorias de receitas",e)}},o.readAsText(t)}}),(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)(s.ZP,{headers:["Nome","A\xe7\xf5es"],children:w.map(e=>(0,t.jsxs)(s.SC,{children:[(0,t.jsx)(s.pj,{children:e.nome}),(0,t.jsxs)(s.pj,{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Z,{size:"sm",variant:"secondary",onClick:()=>E(e.id,e.nome),children:"✏️ Editar"}),(0,t.jsx)(i.Z,{size:"sm",variant:"danger",onClick:()=>d(e.id),children:"\uD83D\uDDD1️ Excluir"})]})]},e.id))})}),(0,t.jsx)(n.Z,{isOpen:u,onClose:h,title:"Nova Categoria",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(p.trim()),j(""),h()},className:"space-y-4",children:[(0,t.jsx)(c.Z,{label:"Nome",value:p,onChange:e=>j(e.target.value),required:!0}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(i.Z,{type:"button",variant:"secondary",onClick:h,children:"Cancelar"}),(0,t.jsx)(i.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})}),(0,t.jsx)(n.Z,{isOpen:f,onClose:g,title:"Editar Categoria",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(v.id,v.nome.trim()),g()},className:"space-y-4",children:[(0,t.jsx)(c.Z,{label:"Nome",value:v.nome,onChange:e=>y({...v,nome:e.target.value}),required:!0}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(i.Z,{type:"button",variant:"secondary",onClick:g,children:"Cancelar"}),(0,t.jsx)(i.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})})]})}},8858:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return d}});var t=a(3827),o=a(64090),s=a(20200),i=a(66651),n=a(70492),c=a(32278),l=a(53018);function d(){let{categorias:e,adicionarCategoria:r,atualizarCategoria:a,removerCategoria:d}=(0,l.D)(),{isOpen:u,openModal:m,closeModal:h}=(0,n.d)(),{isOpen:f,openModal:x,closeModal:g}=(0,n.d)(),[p,j]=(0,o.useState)(""),[v,y]=(0,o.useState)({id:"",nome:""}),[b,N]=(0,o.useState)(""),C=(0,o.useRef)(null),E=(e,r)=>{y({id:e,nome:r}),x()},w=e.filter(e=>e.nome.toLowerCase().includes(b.toLowerCase()));return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Categorias de Produtos"}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2 grow",children:[(0,t.jsx)(i.Z,{onClick:m,variant:"primary",children:"➕ Nova Categoria"}),(0,t.jsx)(i.Z,{onClick:()=>{let r=JSON.stringify(e,null,2),a=new Blob([r],{type:"application/json"}),t=URL.createObjectURL(a),o=document.createElement("a");o.href=t,o.download="categorias.json",o.click(),URL.revokeObjectURL(t)},variant:"secondary",children:"⬇️ Exportar"}),(0,t.jsx)(i.Z,{onClick:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.click()},variant:"secondary",children:"⬆️ Importar"})]}),(0,t.jsx)("div",{className:"w-full sm:w-[220px]",children:(0,t.jsx)(c.Z,{label:"",placeholder:"Buscar...",value:b,onChange:e=>N(e.target.value),className:"h-[38px]"})})]}),(0,t.jsx)("input",{type:"file",ref:C,className:"hidden",accept:"application/json",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!t)return;let o=new FileReader;o.onload=()=>{try{JSON.parse(o.result).forEach(e=>e.nome&&r(e.nome))}catch(e){console.error("Erro ao importar categorias",e)}},o.readAsText(t)}}),(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)(s.ZP,{headers:["Nome","A\xe7\xf5es"],children:w.map(e=>(0,t.jsxs)(s.SC,{children:[(0,t.jsx)(s.pj,{children:e.nome}),(0,t.jsxs)(s.pj,{className:"flex items-center space-x-2",children:[(0,t.jsx)(i.Z,{size:"sm",variant:"secondary",onClick:()=>E(e.id,e.nome),children:"✏️ Editar"}),(0,t.jsx)(i.Z,{size:"sm",variant:"danger",onClick:()=>d(e.id),children:"\uD83D\uDDD1️ Excluir"})]})]},e.id))})}),(0,t.jsx)(n.Z,{isOpen:u,onClose:h,title:"Nova Categoria",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r(p.trim()),j(""),h()},className:"space-y-4",children:[(0,t.jsx)(c.Z,{label:"Nome",value:p,onChange:e=>j(e.target.value),required:!0}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(i.Z,{type:"button",variant:"secondary",onClick:h,children:"Cancelar"}),(0,t.jsx)(i.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})}),(0,t.jsx)(n.Z,{isOpen:f,onClose:g,title:"Editar Categoria",children:(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(v.id,v.nome.trim()),g()},className:"space-y-4",children:[(0,t.jsx)(c.Z,{label:"Nome",value:v.nome,onChange:e=>y({...v,nome:e.target.value}),required:!0}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,t.jsx)(i.Z,{type:"button",variant:"secondary",onClick:g,children:"Cancelar"}),(0,t.jsx)(i.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})})]})}},72902:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return m}});var t=a(3827),o=a(64090),s=e=>{var r;let{tabs:a,className:s=""}=e,[i,n]=(0,o.useState)(null===(r=a[0])||void 0===r?void 0:r.id),c=a.find(e=>e.id===i)||a[0];return(0,t.jsxs)("div",{className:s,children:[(0,t.jsx)("div",{className:"border-b flex space-x-2",children:a.map(e=>{let r=i===e.id;return(0,t.jsx)("button",{onClick:()=>n(e.id),className:"px-3 py-2 text-sm font-medium border-b-2 ".concat(r?"border-[var(--cor-acao)] text-[var(--cor-acao)]":"border-transparent text-gray-600 hover:text-gray-800"),children:e.label},e.id)})}),(0,t.jsx)("div",{className:"mt-4",children:c.content})]})};a(15355);var i=(0,a(13472).$)("dec0483cd08cf3537030786c4e79ee1cc5577f62"),n=a(47907);async function c(){let e=i(),{data:{user:r}}=await e.auth.getUser();if(!r)return(0,n.redirect)("/login");let{data:a,error:o}=await e.from("perfis_usuarios").select("*").order("nome",{ascending:!0});return o?(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h1",{className:"text-xl font-bold text-red-600",children:"Erro ao carregar usu\xe1rios"}),(0,t.jsx)("p",{children:o.message})]}):(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold mb-4",children:"Lista de Usu\xe1rios"}),(0,t.jsxs)("table",{className:"w-full table-auto border border-gray-200",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-100 text-left",children:[(0,t.jsx)("th",{className:"p-2 border",children:"Nome"}),(0,t.jsx)("th",{className:"p-2 border",children:"Email"}),(0,t.jsx)("th",{className:"p-2 border",children:"Fun\xe7\xe3o (Role)"})]})}),(0,t.jsx)("tbody",{children:null==a?void 0:a.map(e=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"p-2 border",children:e.nome}),(0,t.jsx)("td",{className:"p-2 border",children:e.email}),(0,t.jsx)("td",{className:"p-2 border",children:e.role})]},e.id))})]})]})}var l=a(8858),d=a(13779),u=a(15238);function m(){let e=[{id:"usuarios",label:"Usu\xe1rios",content:(0,t.jsx)(c,{})},{id:"categorias",label:"Categorias de Produtos",content:(0,t.jsx)(l.default,{})},{id:"categorias-receitas",label:"Categorias de Receitas",content:(0,t.jsx)(d.default,{})},{id:"unidades",label:"Unidades de Medida",content:(0,t.jsx)(u.default,{})}];return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Configura\xe7\xf5es"}),(0,t.jsx)(s,{tabs:e})]})}},36806:function(e,r,a){"use strict";a.d(r,{O:function(){return n},Q:function(){return c}});var t=a(64090),o=a(32355);let s=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de receitas...");let e=await fetch("/api/categorias-receitas",{headers:(0,o.g)()});if(console.log("\uD83D\uDCE1 Response status: ".concat(e.status)),!e.ok){let r=await e.text();throw console.error("❌ Erro na API categorias-receitas: ".concat(e.status," - ").concat(r)),Error("Erro ao buscar categorias de receitas: ".concat(e.status))}let r=await e.json();return console.log("✅ Categorias de receitas carregadas: ".concat(r.length)),r}catch(e){return console.error("❌ Erro ao buscar categorias de receitas:",e),[]}},i=[{id:"",nome:"Entrada"},{id:"",nome:"Prato Principal"},{id:"",nome:"Acompanhamento"},{id:"",nome:"Sobremesa"},{id:"",nome:"Bebida"},{id:"",nome:"Molho/Condimento"},{id:"",nome:"Outro"}],n=()=>{let[e,r]=(0,t.useState)([]),[a,n]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=!0;return(async()=>{try{if(!e)return;n(!0);let a=await s();if(!e)return;if(0===a.length){for(let r of i){if(!e)return;try{let e=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:r.nome})});if(e.ok){let r=await e.json();a.push(r)}else 409===e.status&&console.log("Categoria de receita '".concat(r.nome,"' j\xe1 existe, pulando..."))}catch(e){console.error("Erro ao criar categoria de receita padr\xe3o:",e)}}e&&(a=await s())}e&&r(a)}catch(a){console.error("Erro ao carregar categorias de receitas:",a),e&&r([])}finally{e&&n(!1)}})(),()=>{e=!1}},[]),{categorias:e,isLoading:a,adicionar:async e=>{try{let a=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:e})});if(!a.ok)throw Error("Erro ao adicionar categoria");let t=await a.json();return r(e=>[...e,t]),t}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},atualizar:async(e,a)=>{try{let t=await fetch("/api/categorias-receitas/".concat(e),{method:"PUT",headers:(0,o.g)(),body:JSON.stringify({nome:a})});if(!t.ok)throw Error("Erro ao atualizar categoria");let s=await t.json();return r(r=>r.map(r=>r.id===e?s:r)),!0}catch(e){return console.error("Erro ao atualizar categoria:",e),!1}},remover:async e=>{try{if(!(await fetch("/api/categorias-receitas/".concat(e),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao remover categoria");return r(r=>r.filter(r=>r.id!==e)),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}},obterPorId:r=>e.find(e=>e.id===r)}},c=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e)return"N\xe3o informado";let a=r.find(r=>r.id===e);return a?a.nome:e.length>20?"Categoria n\xe3o encontrada":e}},53018:function(e,r,a){"use strict";a.d(r,{D:function(){return n},u:function(){return c}});var t=a(64090),o=a(32355);let s=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de produtos...");let e=await fetch("/api/categorias",{headers:(0,o.g)()});if(console.log("\uD83D\uDCE1 Response status: ".concat(e.status)),!e.ok){let r=await e.text();throw console.error("❌ Erro na API categorias: ".concat(e.status," - ").concat(r)),Error("Erro ao buscar categorias: ".concat(e.status))}let r=await e.json();return console.log("✅ Categorias carregadas: ".concat(r.length)),r}catch(e){return console.error("❌ Erro ao buscar categorias da API:",e),[]}},i=[{id:"hortifruti",nome:"Hortifruti"},{id:"carnes",nome:"Carnes"},{id:"laticinios",nome:"Latic\xednios"},{id:"graos",nome:"Gr\xe3os e Cereais"},{id:"bebidas",nome:"Bebidas"},{id:"temperos",nome:"Temperos"},{id:"outros",nome:"Outros"}],n=()=>{let[e,r]=(0,t.useState)([]),[a,n]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(async()=>{try{n(!0);let e=await s();if(0===e.length){for(let r of i)try{if(!e.find(e=>e.nome===r.nome)){let a=await fetch("/api/categorias",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:r.nome})});if(a.ok){let r=await a.json();e.push(r)}else 409===a.status&&console.log("Categoria '".concat(r.nome,"' j\xe1 existe, pulando..."))}}catch(e){console.error("Erro ao criar categoria padr\xe3o:",e)}e=await s()}console.log("Categorias loaded:",(null==e?void 0:e.length)||0),r(e)}catch(e){console.error("Erro ao carregar categorias:",e),r([])}finally{n(!1)}})()},[]);let c=async a=>{try{let t=await fetch("/api/categorias",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:a})});if(!t.ok)throw Error("Erro ao criar categoria");let s=await t.json(),i=[...e,s];return r(i),s}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},l=async(a,t)=>{try{let s=await fetch("/api/categorias/".concat(a),{method:"PUT",headers:(0,o.g)(),body:JSON.stringify({nome:t})});if(!s.ok)throw Error("Erro ao atualizar categoria");let i=await s.json(),n=e.map(e=>e.id===a?i:e);return r(n),i}catch(e){return console.error("Erro ao atualizar categoria:",e),null}},d=async a=>{try{if(!(await fetch("/api/categorias/".concat(a),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar categoria");let t=e.filter(e=>e.id!==a);return r(t),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}};return{categorias:e,isLoading:a,adicionarCategoria:c,atualizarCategoria:l,removerCategoria:d,obterCategoriaPorId:r=>e.find(e=>e.id===r)}},c=async e=>{if(!e)return"N\xe3o informado";let r=(await s()).find(r=>r.id===e);return r?r.nome:e}}},function(e){e.O(0,[238,971,655,744],function(){return e(e.s=72306)}),_N_E=e.O()}]);