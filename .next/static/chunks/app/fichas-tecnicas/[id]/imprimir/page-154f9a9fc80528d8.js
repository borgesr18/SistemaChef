(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8193],{62635:function(e,t,r){Promise.resolve().then(r.bind(r,21538))},47907:function(e,t,r){"use strict";var a=r(15313);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}})},21538:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(3827),o=r(64090),i=r(47907),s=r(57418),n=r(16297),c=r(27742),d=r(20200);function l(){var e,t,r,l,u,m,h,x;let p=(0,i.useParams)(),{obterFichaTecnicaPorId:g}=(0,n.vG)(),{produtos:f}=(0,c.U)(),N=(0,i.useRouter)(),y=g(p.id);if((0,o.useEffect)(()=>{{let e=setTimeout(()=>{window.print()},300),t=()=>N.back();return window.addEventListener("afterprint",t),()=>{clearTimeout(e),window.removeEventListener("afterprint",t)}}},[N]),!y)return(0,a.jsx)("div",{className:"p-8 text-center",children:"Ficha t\xe9cnica n\xe3o encontrada"});let v=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),j=e=>{let t=new Date(e);return new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)},b=e=>{let t=f.find(t=>t.id===e);return t?t.nome:"Produto n\xe3o encontrado"},w=(e,t)=>"".concat(t," ").concat(e),E=(e,t)=>"".concat(e.toFixed(2)," ").concat(t);return(0,a.jsxs)("div",{className:"p-8 space-y-6",children:[(0,a.jsx)("div",{className:"flex justify-end print:hidden mb-4",children:(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-200 rounded-md",onClick:()=>N.back(),children:"Voltar"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-center mb-4",children:"Ficha T\xe9cnica"}),(0,a.jsxs)(s.Z,{title:"Informa\xe7\xf5es B\xe1sicas",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-6 mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Nome da Receita"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:y.nome})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Categoria"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:(0,n.Q_)(y.categoria)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Tempo de Preparo"}),(0,a.jsxs)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:[y.tempoPreparo," minutos"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Rendimento"}),(0,a.jsxs)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:[y.rendimentoTotal," ",(0,n.vT)(y.unidadeRendimento)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Data de Cria\xe7\xe3o"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:j(y.dataCriacao)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Data de Modifica\xe7\xe3o"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:j(y.dataModificacao)})]})]}),y.descricao&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Descri\xe7\xe3o"}),(0,a.jsx)("p",{className:"mt-1 text-gray-700",children:y.descricao})]})]}),(0,a.jsx)(s.Z,{title:"Custos",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Custo Total"}),(0,a.jsx)("p",{className:"mt-1 text-xl font-medium text-gray-900",children:v(y.custoTotal)})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Custo por Kg"}),(0,a.jsx)("p",{className:"mt-1 text-xl font-medium text-gray-900",children:v(y.custoPorKg)})]})]})}),(0,a.jsx)(s.Z,{title:"Ingredientes",children:(0,a.jsx)(d.ZP,{headers:["Produto","Quantidade","Custo"],children:y.ingredientes.map((e,t)=>(0,a.jsxs)(d.SC,{children:[(0,a.jsx)(d.pj,{children:b(e.produtoId)}),(0,a.jsx)(d.pj,{children:w(e.unidade,e.quantidade)}),(0,a.jsx)(d.pj,{children:v(e.custo)})]},t))})}),(0,a.jsx)(s.Z,{title:"Modo de Preparo",children:(0,a.jsx)("div",{className:"whitespace-pre-line text-gray-700",children:y.modoPreparo})}),y.infoNutricional&&(0,a.jsx)(s.Z,{title:"Informa\xe7\xf5es Nutricionais",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Por Receita Completa"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Calorias"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(y.infoNutricional.calorias,"kcal")})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Carboidratos"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(y.infoNutricional.carboidratos,"g")})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Prote\xednas"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(y.infoNutricional.proteinas,"g")})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Gorduras Totais"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(y.infoNutricional.gordurasTotais,"g")})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Por Por\xe7\xe3o"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Calorias"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(null!==(u=null===(e=y.infoNutricionalPorcao)||void 0===e?void 0:e.calorias)&&void 0!==u?u:0,"kcal")})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Carboidratos"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(null!==(m=null===(t=y.infoNutricionalPorcao)||void 0===t?void 0:t.carboidratos)&&void 0!==m?m:0,"g")})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Prote\xednas"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(null!==(h=null===(r=y.infoNutricionalPorcao)||void 0===r?void 0:r.proteinas)&&void 0!==h?h:0,"g")})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500",children:"Gorduras Totais"}),(0,a.jsx)("p",{className:"mt-1 text-lg font-medium text-gray-900",children:E(null!==(x=null===(l=y.infoNutricionalPorcao)||void 0===l?void 0:l.gordurasTotais)&&void 0!==x?x:0,"g")})]})]})]})]})}),y.observacoes&&(0,a.jsx)(s.Z,{title:"Observa\xe7\xf5es",children:(0,a.jsx)("div",{className:"whitespace-pre-line text-gray-700",children:y.observacoes})})]})}},57418:function(e,t,r){"use strict";var a=r(3827);r(64090),t.Z=e=>{let{children:t,title:r,className:o="",footer:i}=e;return(0,a.jsxs)("div",{className:"card overflow-hidden ".concat(o),children:[r&&(0,a.jsx)("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:(0,a.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:r})}),(0,a.jsx)("div",{className:"p-6",children:t}),i&&(0,a.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:i})]})}},20200:function(e,t,r){"use strict";r.d(t,{SC:function(){return i},pj:function(){return s}});var a=r(3827),o=r(64090);let i=e=>{let{children:t,className:r="",...o}=e;return(0,a.jsx)("tr",{className:"odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ".concat(r),...o,children:t})},s=e=>{let{children:t,className:r="",compact:o=!1}=e;return(0,a.jsx)("td",{className:"".concat(o?"px-2 py-2":"px-6 py-4"," text-sm ").concat(r),style:{color:"var(--cor-texto-secundario)"},children:t})};t.ZP=e=>{let{headers:t,children:r,className:i="",emptyMessage:s="Nenhum dado encontrado",isLoading:n=!1}=e;return(0,a.jsx)("div",{className:"w-full overflow-x-hidden rounded-lg border ".concat(i),style:{borderColor:"var(--cor-borda)"},children:(0,a.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[(0,a.jsx)("thead",{className:"bg-gray-100",children:(0,a.jsx)("tr",{children:t.map((e,t)=>(0,a.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},t))})}),(0,a.jsx)("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:n?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,a.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,a.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,a.jsx)("span",{className:"ml-2",children:"Carregando..."})]})})}):o.Children.count(r)>0?r:(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:s})})})]})})}},32355:function(e,t,r){"use strict";r.d(t,{g:function(){return a},x:function(){return o}});let a=()=>{var e,t;let r=null===(t=document.cookie)||void 0===t?void 0:null===(e=t.split("; ").find(e=>e.startsWith("sb-access-token=")))||void 0===e?void 0:e.split("=")[1];return{Authorization:r?"Bearer ".concat(r):""}},o={get:async e=>await fetch(e,{method:"GET",headers:{...a(),"Content-Type":"application/json"}}),post:async(e,t)=>await fetch(e,{method:"POST",headers:{...a(),"Content-Type":"application/json"},body:JSON.stringify(t)}),put:async(e,t)=>await fetch(e,{method:"PUT",headers:{...a(),"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:async e=>await fetch(e,{method:"DELETE",headers:{...a(),"Content-Type":"application/json"}})}},36806:function(e,t,r){"use strict";r(1877)},16297:function(e,t,r){"use strict";r.d(t,{Gm:function(){return l},IO:function(){return m},N2:function(){return p},Q_:function(){return i.obterLabelCategoriaReceita},eW:function(){return h},gZ:function(){return g},lB:function(){return c},vG:function(){return u},vT:function(){return f},zP:function(){return n}});var a=r(64090),o=r(32355),i=r(36806);let s={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},n=(e,t,r)=>{let a=s[t],o=s[r];return a&&o&&a.tipo===o.tipo?e*a.fator/o.fator:e},c=async()=>{try{let e=await fetch("/api/fichas-tecnicas",{headers:(0,o.g)()});if(!e.ok)throw Error("Erro ao buscar fichas t\xe9cnicas: ".concat(e.status));return await e.json()}catch(e){return console.error("Error loading fichas t\xe9cnicas:",e),[]}},d=(e,t)=>e.reduce((e,r)=>{var a,o;let i=t.find(e=>e.id===r.produtoId);if(!i)return e;let c=r.unidade||i.unidadeMedida,d=null===(a=s[c])||void 0===a?void 0:a.tipo;if("peso"===d)return e+n(r.quantidade,c,"g");if("volume"===d)return e+n(r.quantidade,c,"ml");{let t=i.pesoEmbalagem||(null===(o=s[i.unidadeMedida])||void 0===o?void 0:o.fator)||1;return e+n(r.quantidade,c,i.unidadeMedida)*t}},0),l=(e,t,r)=>{var a;let o=null===(a=s[t])||void 0===a?void 0:a.tipo;return"peso"===o||"volume"===o?n(d(e,r),"peso"===o?"g":"ml",t):e.reduce((e,a)=>{let o=r.find(e=>e.id===a.produtoId),i=a.unidade||(null==o?void 0:o.unidadeMedida)||"un";return e+n(a.quantidade,i,t)},0)},u=()=>{let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)(!1);return{fichasTecnicas:e,isLoading:r,setFichasTecnicas:t,setIsLoading:o,obterFichaTecnicaPorId:t=>e.find(e=>e.id===t),calcularRendimentoTotal:l,atualizarFichaTecnica:x,removerFichaTecnica:p}},m=async e=>{try{let t=await fetch("/api/fichas-tecnicas/".concat(e),{headers:(0,o.g)()});if(!t.ok){if(404===t.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let r=await t.json();return{...r,dataCriacao:r.createdAt?new Date(r.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:r.updatedAt?new Date(r.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(r.tempoPreparo)||0,custoTotal:Number(r.custoTotal)||0,custoPorcao:Number(r.custoPorcao)||0,custoPorKg:r.custoTotal&&r.rendimentoTotal?r.custoTotal/r.rendimentoTotal*1e3:0}}catch(e){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",e),null}},h=async e=>{try{let t=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw console.error("Erro na resposta da API:",t.status,e),Error("Erro ao criar ficha t\xe9cnica: ".concat(t.status))}return await t.json()}catch(e){return console.error("Erro ao adicionar ficha t\xe9cnica:",e),null}},x=async(e,t)=>{try{let r=await fetch("/api/fichas-tecnicas/".concat(e),{method:"PUT",headers:(0,o.g)(),body:JSON.stringify(t)});if(!r.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await r.json()}catch(e){return console.error("Erro ao atualizar ficha t\xe9cnica:",e),null}},p=async e=>{try{if(!(await fetch("/api/fichas-tecnicas/".concat(e),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(e){return console.error("Erro ao remover ficha t\xe9cnica:",e),!1}},g=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],f=e=>{let t=g.find(t=>t.value===e);return t?t.label:e}},27742:function(e,t,r){"use strict";r.d(t,{U:function(){return s},k:function(){return i}});var a=r(64090),o=r(32355);let i=async()=>{try{let e=await fetch("/api/produtos",{headers:(0,o.g)()});if(!e.ok)throw Error("Erro ao buscar produtos");return(await e.json()).map(e=>{var t,r;return{id:e.id,nome:e.nome,categoriaId:e.categoria,categoriaNome:null===(t=e.categoriaRef)||void 0===t?void 0:t.nome,marca:e.marca,unidadeId:e.unidadeMedida,unidadeNome:null===(r=e.unidadeRef)||void 0===r?void 0:r.nome,preco:Number(e.preco)||0,precoUnitario:e.precoUnitario?Number(e.precoUnitario):void 0,fornecedor:e.fornecedor,pesoEmbalagem:e.pesoEmbalagem?Number(e.pesoEmbalagem):void 0,imagem:e.imagem,ultimaMovimentacao:e.ultimaMovimentacao,infoNutricional:e.infoNutricional?{calorias:Number(e.infoNutricional.calorias),carboidratos:Number(e.infoNutricional.carboidratos),proteinas:Number(e.infoNutricional.proteinas),gordurasTotais:Number(e.infoNutricional.gordurasTotais),gordurasSaturadas:Number(e.infoNutricional.gordurasSaturadas),gordurasTrans:Number(e.infoNutricional.gordurasTrans),fibras:Number(e.infoNutricional.fibras),sodio:Number(e.infoNutricional.sodio)}:void 0}})}catch(e){return console.error("Erro ao buscar produtos da API:",e),[]}},s=()=>{let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{(async()=>{s(!0),t(await i()),s(!1)})()},[]),{produtos:e,isLoading:r,adicionarProduto:async e=>{try{let r={...e,precoUnitario:e.pesoEmbalagem?e.preco/e.pesoEmbalagem:void 0},a=await fetch("/api/produtos",{method:"POST",headers:{...(0,o.g)(),"Content-Type":"application/json"},body:JSON.stringify(r)});if(!a.ok)throw Error("Erro ao adicionar produto");let i=await a.json();return t(e=>[...e,i]),i}catch(e){return console.error("Erro ao adicionar produto:",e),null}},atualizarProduto:async(e,r)=>{try{let a={...r,precoUnitario:r.pesoEmbalagem?r.preco/r.pesoEmbalagem:void 0},i=await fetch("/api/produtos/".concat(e),{method:"PUT",headers:{...(0,o.g)(),"Content-Type":"application/json"},body:JSON.stringify(a)});if(!i.ok)throw Error("Erro ao atualizar produto");let s=await i.json();return t(t=>t.map(t=>t.id===e?s:t)),s}catch(e){return console.error("Erro ao atualizar produto:",e),null}},removerProduto:async e=>{try{if(!(await fetch("/api/produtos/".concat(e),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao remover produto");return t(t=>t.filter(t=>t.id!==e)),!0}catch(e){return console.error("Erro ao remover produto:",e),!1}},obterProdutoPorId:t=>e.find(e=>e.id===t)}}},1877:function(e,t,r){"use strict";(0,r(33837).createBrowserClient)("https://sutmfzcmrlqnocsusiav.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1dG1memNtcmxxbm9jc3VzaWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1MzgwODMsImV4cCI6MjA2NjExNDA4M30.BQRo64qRNzqB_XGNeSe4jkZ8Mzzji8eUYVbS_nWw8tI")}},function(e){e.O(0,[7176,3837,2971,8069,1744],function(){return e(e.s=62635)}),_N_E=e.O()}]);