(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7120],{92881:function(e,t,a){Promise.resolve().then(a.bind(a,1285))},1285:function(e,t,a){"use strict";a.r(t);var r=a(3827),n=a(64090),o=a(57418),i=a(20200),c=a(66651),s=a(15358),l=a(16297),d=a(36806),u=a(8792);t.default=n.memo(function(){let[e,t]=(0,n.useState)([]),[a,h]=(0,n.useState)(!0),[f,m]=(0,n.useState)(null),{categorias:p}=(0,d.useCategoriasReceita)();(0,n.useEffect)(()=>{(async()=>{try{h(!0);let e=await (0,l.lB)();console.log("Fichas t\xe9cnicas loaded:",(null==e?void 0:e.length)||0),t(e||[])}catch(e){console.error("Erro ao carregar fichas t\xe9cnicas:",e),t([])}finally{h(!1)}})()},[]);let x=async e=>{confirm("Tem certeza que deseja remover esta ficha t\xe9cnica?")&&await (0,l.N2)(e)&&(t(t=>t.filter(t=>t.id!==e)),m(null))},v=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),y=e=>{if(!e)return"Data n\xe3o dispon\xedvel";let t=new Date(e);return isNaN(t.getTime())?"Data inv\xe1lida":new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(t)};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Fichas T\xe9cnicas"}),(0,r.jsx)(u.default,{href:"/fichas-tecnicas/nova",children:(0,r.jsxs)(c.default,{variant:"primary",children:[(0,r.jsx)("span",{className:"material-icons mr-1 text-sm",children:"add"}),"Nova Ficha T\xe9cnica"]})})]}),(0,r.jsx)(o.Z,{children:(0,r.jsx)(i.ZP,{headers:["Nome","Categoria","Rendimento","Custo Total","Data de Modifica\xe7\xe3o"],isLoading:a,emptyMessage:"Nenhuma ficha t\xe9cnica cadastrada. Clique em 'Nova Ficha T\xe9cnica' para adicionar.",children:e.map(e=>(0,r.jsxs)(i.SC,{className:"relative cursor-pointer",onClick:()=>m(e),children:[(0,r.jsx)(i.pj,{className:"font-medium text-gray-700",children:e.nome}),(0,r.jsx)(i.pj,{children:(0,l.Q_)(e.categoria,p)}),(0,r.jsxs)(i.pj,{children:[e.rendimentoTotal," ",e.unidadeRendimento]}),(0,r.jsx)(i.pj,{children:v(e.custoTotal)}),(0,r.jsx)(i.pj,{children:y(e.dataModificacao)})]},e.id))})}),(0,r.jsx)(s.Z,{isOpen:!!f,onClose:()=>m(null),title:null==f?void 0:f.nome,children:f&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Rendimento: ",f.rendimentoTotal," ",f.unidadeRendimento]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Custo Total: ",v(f.custoTotal)]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Data: ",y(f.dataModificacao)]}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,r.jsx)(u.default,{href:"/fichas-tecnicas/".concat(f.id),children:(0,r.jsx)(c.default,{variant:"secondary",fullWidth:!0,children:"Ver"})}),(0,r.jsx)(u.default,{href:"/fichas-tecnicas/".concat(f.id,"/editar"),children:(0,r.jsx)(c.default,{variant:"primary",fullWidth:!0,children:"Editar"})}),(0,r.jsx)(c.default,{variant:"danger",fullWidth:!0,onClick:()=>x(f.id),children:"Excluir"}),(0,r.jsx)(u.default,{href:"/producao?ficha=".concat(f.id),children:(0,r.jsx)(c.default,{fullWidth:!0,children:"Produzir"})}),(0,r.jsx)(u.default,{href:"/precos?ficha=".concat(f.id),children:(0,r.jsx)(c.default,{fullWidth:!0,children:"Calcular Pre\xe7o"})})]})]})})]})})},66651:function(e,t,a){"use strict";a.d(t,{z:function(){return l}});var r=a(3827),n=a(64090),o=a(76371),i=a(49769),c=a(22169);let s=(0,i.j)("inline-flex items-center justify-center rounded-2xl text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 shadow-sm",{variants:{variant:{default:"bg-primary text-white hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:a,variant:n,size:i,asChild:l=!1,...d}=e,u=l?o.g7:"button";return(0,r.jsx)(u,{className:(0,c.cn)(s({variant:n,size:i,className:a})),ref:t,...d})});l.displayName="Button"},57418:function(e,t,a){"use strict";var r=a(3827);a(64090),t.Z=e=>{let{children:t,title:a,className:n="",footer:o}=e;return(0,r.jsxs)("div",{className:"card overflow-hidden ".concat(n),children:[a&&(0,r.jsx)("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:(0,r.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:a})}),(0,r.jsx)("div",{className:"p-6",children:t}),o&&(0,r.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:o})]})}},15358:function(e,t,a){"use strict";var r=a(3827),n=a(64090);t.Z=e=>{let{isOpen:t,onClose:a,title:o,children:i,width:c="md"}=e;return(0,n.useEffect)(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[t]),(0,r.jsxs)("div",{className:"fixed inset-0 z-50 ".concat(t?"":"pointer-events-none"),children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black transition-opacity ".concat(t?"opacity-50":"opacity-0"),onClick:a}),(0,r.jsxs)("div",{className:"absolute right-0 top-0 h-full bg-white shadow-xl transform transition-transform ".concat({sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"}[c]," ").concat(t?"translate-x-0":"translate-x-full"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 border-b",style:{borderColor:"var(--cor-borda)"},children:[(0,r.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:o}),(0,r.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:(0,r.jsx)("span",{className:"material-icons",children:"close"})})]}),(0,r.jsx)("div",{className:"p-4 overflow-y-auto h-full",children:i})]})]})}},20200:function(e,t,a){"use strict";a.d(t,{SC:function(){return o},pj:function(){return i}});var r=a(3827),n=a(64090);let o=e=>{let{children:t,className:a="",...n}=e;return(0,r.jsx)("tr",{className:"odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ".concat(a),...n,children:t})},i=e=>{let{children:t,className:a="",compact:n=!1}=e;return(0,r.jsx)("td",{className:"".concat(n?"px-2 py-2":"px-6 py-4"," text-sm ").concat(a),style:{color:"var(--cor-texto-secundario)"},children:t})};t.ZP=e=>{let{headers:t,children:a,className:o="",emptyMessage:i="Nenhum dado encontrado",isLoading:c=!1}=e;return(0,r.jsx)("div",{className:"w-full overflow-x-hidden rounded-lg border ".concat(o),style:{borderColor:"var(--cor-borda)"},children:(0,r.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[(0,r.jsx)("thead",{className:"bg-gray-100",children:(0,r.jsx)("tr",{children:t.map((e,t)=>(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},t))})}),(0,r.jsx)("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:c?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,r.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("span",{className:"ml-2",children:"Carregando..."})]})})}):n.Children.count(a)>0?a:(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:t.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:i})})})]})})}},32355:function(e,t,a){"use strict";a.d(t,{g:function(){return r},x:function(){return n}});let r=()=>{var e,t;let a=null===(t=document.cookie)||void 0===t?void 0:null===(e=t.split("; ").find(e=>e.startsWith("sb-access-token=")))||void 0===e?void 0:e.split("=")[1];return{Authorization:a?"Bearer ".concat(a):""}},n={get:async e=>await fetch(e,{method:"GET",headers:{...r(),"Content-Type":"application/json"}}),post:async(e,t)=>await fetch(e,{method:"POST",headers:{...r(),"Content-Type":"application/json"},body:JSON.stringify(t)}),put:async(e,t)=>await fetch(e,{method:"PUT",headers:{...r(),"Content-Type":"application/json"},body:JSON.stringify(t)}),delete:async e=>await fetch(e,{method:"DELETE",headers:{...r(),"Content-Type":"application/json"}})}},36806:function(e,t,a){"use strict";a(1877)},16297:function(e,t,a){"use strict";a.d(t,{Gm:function(){return d},IO:function(){return h},N2:function(){return p},Q_:function(){return o.obterLabelCategoriaReceita},eW:function(){return f},gZ:function(){return x},lB:function(){return s},vG:function(){return u},vT:function(){return v},zP:function(){return c}});var r=a(64090),n=a(32355),o=a(36806);let i={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},c=(e,t,a)=>{let r=i[t],n=i[a];return r&&n&&r.tipo===n.tipo?e*r.fator/n.fator:e},s=async()=>{try{let e=await fetch("/api/fichas-tecnicas",{headers:(0,n.g)()});if(!e.ok)throw Error("Erro ao buscar fichas t\xe9cnicas: ".concat(e.status));return await e.json()}catch(e){return console.error("Error loading fichas t\xe9cnicas:",e),[]}},l=(e,t)=>e.reduce((e,a)=>{var r,n;let o=t.find(e=>e.id===a.produtoId);if(!o)return e;let s=a.unidade||o.unidadeMedida,l=null===(r=i[s])||void 0===r?void 0:r.tipo;if("peso"===l)return e+c(a.quantidade,s,"g");if("volume"===l)return e+c(a.quantidade,s,"ml");{let t=o.pesoEmbalagem||(null===(n=i[o.unidadeMedida])||void 0===n?void 0:n.fator)||1;return e+c(a.quantidade,s,o.unidadeMedida)*t}},0),d=(e,t,a)=>{var r;let n=null===(r=i[t])||void 0===r?void 0:r.tipo;return"peso"===n||"volume"===n?c(l(e,a),"peso"===n?"g":"ml",t):e.reduce((e,r)=>{let n=a.find(e=>e.id===r.produtoId),o=r.unidade||(null==n?void 0:n.unidadeMedida)||"un";return e+c(r.quantidade,o,t)},0)},u=()=>{let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(!1);return{fichasTecnicas:e,isLoading:a,setFichasTecnicas:t,setIsLoading:n,obterFichaTecnicaPorId:t=>e.find(e=>e.id===t),calcularRendimentoTotal:d,atualizarFichaTecnica:m,removerFichaTecnica:p}},h=async e=>{try{let t=await fetch("/api/fichas-tecnicas/".concat(e),{headers:(0,n.g)()});if(!t.ok){if(404===t.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let a=await t.json();return{...a,dataCriacao:a.createdAt?new Date(a.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:a.updatedAt?new Date(a.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(a.tempoPreparo)||0,custoTotal:Number(a.custoTotal)||0,custoPorcao:Number(a.custoPorcao)||0,custoPorKg:a.custoTotal&&a.rendimentoTotal?a.custoTotal/a.rendimentoTotal*1e3:0}}catch(e){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",e),null}},f=async e=>{try{let t=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,n.g)(),body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw console.error("Erro na resposta da API:",t.status,e),Error("Erro ao criar ficha t\xe9cnica: ".concat(t.status))}return await t.json()}catch(e){return console.error("Erro ao adicionar ficha t\xe9cnica:",e),null}},m=async(e,t)=>{try{let a=await fetch("/api/fichas-tecnicas/".concat(e),{method:"PUT",headers:(0,n.g)(),body:JSON.stringify(t)});if(!a.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await a.json()}catch(e){return console.error("Erro ao atualizar ficha t\xe9cnica:",e),null}},p=async e=>{try{if(!(await fetch("/api/fichas-tecnicas/".concat(e),{method:"DELETE",headers:(0,n.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(e){return console.error("Erro ao remover ficha t\xe9cnica:",e),!1}},x=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],v=e=>{let t=x.find(t=>t.value===e);return t?t.label:e}},1877:function(e,t,a){"use strict";(0,a(33837).createBrowserClient)("https://sutmfzcmrlqnocsusiav.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1dG1memNtcmxxbm9jc3VzaWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1MzgwODMsImV4cCI6MjA2NjExNDA4M30.BQRo64qRNzqB_XGNeSe4jkZ8Mzzji8eUYVbS_nWw8tI")},22169:function(e,t,a){"use strict";a.d(t,{cn:function(){return o}});var r=a(75504),n=a(51367);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,r.W)(t))}}},function(e){e.O(0,[7176,869,3837,8792,2971,8069,1744],function(){return e(e.s=92881)}),_N_E=e.O()}]);