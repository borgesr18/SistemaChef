(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[120],{92881:function(e,r,a){Promise.resolve().then(a.bind(a,1285))},1285:function(e,r,a){"use strict";a.r(r);var t=a(3827),o=a(64090),c=a(57418),i=a(20200),n=a(66651),s=a(15358),l=a(16297),d=a(36806),u=a(8792);r.default=o.memo(function(){let[e,r]=(0,o.useState)([]),[a,h]=(0,o.useState)(!0),[f,m]=(0,o.useState)(null),{categorias:x}=(0,d.O)();(0,o.useEffect)(()=>{(async()=>{try{h(!0);let e=await (0,l.lB)();console.log("Fichas t\xe9cnicas loaded:",(null==e?void 0:e.length)||0),r(e||[])}catch(e){console.error("Erro ao carregar fichas t\xe9cnicas:",e),r([])}finally{h(!1)}})()},[]);let p=async e=>{confirm("Tem certeza que deseja remover esta ficha t\xe9cnica?")&&await (0,l.N2)(e)&&(r(r=>r.filter(r=>r.id!==e)),m(null))},g=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),y=e=>{if(!e)return"Data n\xe3o dispon\xedvel";let r=new Date(e);return isNaN(r.getTime())?"Data inv\xe1lida":new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}).format(r)};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Fichas T\xe9cnicas"}),(0,t.jsx)(u.default,{href:"/fichas-tecnicas/nova",children:(0,t.jsxs)(n.Z,{variant:"primary",children:[(0,t.jsx)("span",{className:"material-icons mr-1 text-sm",children:"add"}),"Nova Ficha T\xe9cnica"]})})]}),(0,t.jsx)(c.Z,{children:(0,t.jsx)(i.ZP,{headers:["Nome","Categoria","Rendimento","Custo Total","Data de Modifica\xe7\xe3o"],isLoading:a,emptyMessage:"Nenhuma ficha t\xe9cnica cadastrada. Clique em 'Nova Ficha T\xe9cnica' para adicionar.",children:e.map(e=>(0,t.jsxs)(i.SC,{className:"relative cursor-pointer",onClick:()=>m(e),children:[(0,t.jsx)(i.pj,{className:"font-medium text-gray-700",children:e.nome}),(0,t.jsx)(i.pj,{children:(0,l.Q_)(e.categoria,x)}),(0,t.jsxs)(i.pj,{children:[e.rendimentoTotal," ",e.unidadeRendimento]}),(0,t.jsx)(i.pj,{children:g(e.custoTotal)}),(0,t.jsx)(i.pj,{children:y(e.dataModificacao)})]},e.id))})}),(0,t.jsx)(s.Z,{isOpen:!!f,onClose:()=>m(null),title:null==f?void 0:f.nome,children:f&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Rendimento: ",f.rendimentoTotal," ",f.unidadeRendimento]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Custo Total: ",g(f.custoTotal)]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Data: ",y(f.dataModificacao)]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)(u.default,{href:"/fichas-tecnicas/".concat(f.id),children:(0,t.jsx)(n.Z,{variant:"secondary",fullWidth:!0,children:"Ver"})}),(0,t.jsx)(u.default,{href:"/fichas-tecnicas/".concat(f.id,"/editar"),children:(0,t.jsx)(n.Z,{variant:"primary",fullWidth:!0,children:"Editar"})}),(0,t.jsx)(n.Z,{variant:"danger",fullWidth:!0,onClick:()=>p(f.id),children:"Excluir"}),(0,t.jsx)(u.default,{href:"/producao?ficha=".concat(f.id),children:(0,t.jsx)(n.Z,{fullWidth:!0,children:"Produzir"})}),(0,t.jsx)(u.default,{href:"/precos?ficha=".concat(f.id),children:(0,t.jsx)(n.Z,{fullWidth:!0,children:"Calcular Pre\xe7o"})})]})]})})]})})},66651:function(e,r,a){"use strict";var t=a(3827);a(64090),r.Z=e=>{let{children:r,variant:a="primary",size:o="md",isLoading:c=!1,fullWidth:i=!1,className:n="",disabled:s,...l}=e,d=s||c?"opacity-50 cursor-not-allowed":"";return(0,t.jsxs)("button",{className:"".concat("inline-flex items-center justify-center rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2"," ").concat({primary:"bg-[var(--cor-acao)] text-white hover:brightness-90 focus:ring-[var(--cor-acao)]",secondary:"bg-[var(--cor-secundaria)] text-white hover:brightness-90 focus:ring-[var(--cor-secundaria)]",success:"bg-[var(--cor-sucesso)] text-white hover:brightness-90 focus:ring-[var(--cor-sucesso)]",danger:"bg-[var(--cor-erro)] text-white hover:brightness-90 focus:ring-[var(--cor-erro)]",outline:"bg-white text-[var(--cor-texto-principal)] border border-[var(--cor-borda)] hover:bg-gray-50 focus:ring-[var(--cor-acao)]"}[a]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[o]," ").concat(i?"w-full":""," ").concat(d," ").concat(n),disabled:s||c,...l,children:[c&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})}},57418:function(e,r,a){"use strict";var t=a(3827);a(64090),r.Z=e=>{let{children:r,title:a,className:o="",footer:c}=e;return(0,t.jsxs)("div",{className:"card overflow-hidden ".concat(o),children:[a&&(0,t.jsx)("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:(0,t.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:a})}),(0,t.jsx)("div",{className:"p-6",children:r}),c&&(0,t.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:c})]})}},15358:function(e,r,a){"use strict";var t=a(3827),o=a(64090);r.Z=e=>{let{isOpen:r,onClose:a,title:c,children:i,width:n="md"}=e;return(0,o.useEffect)(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="auto",()=>{document.body.style.overflow="auto"}),[r]),(0,t.jsxs)("div",{className:"fixed inset-0 z-50 ".concat(r?"":"pointer-events-none"),children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-black transition-opacity ".concat(r?"opacity-50":"opacity-0"),onClick:a}),(0,t.jsxs)("div",{className:"absolute right-0 top-0 h-full bg-white shadow-xl transform transition-transform ".concat({sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg"}[n]," ").concat(r?"translate-x-0":"translate-x-full"),children:[(0,t.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 border-b",style:{borderColor:"var(--cor-borda)"},children:[(0,t.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:c}),(0,t.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-500",children:(0,t.jsx)("span",{className:"material-icons",children:"close"})})]}),(0,t.jsx)("div",{className:"p-4 overflow-y-auto h-full",children:i})]})]})}},20200:function(e,r,a){"use strict";a.d(r,{SC:function(){return c},pj:function(){return i}});var t=a(3827),o=a(64090);let c=e=>{let{children:r,className:a="",...o}=e;return(0,t.jsx)("tr",{className:"odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ".concat(a),...o,children:r})},i=e=>{let{children:r,className:a="",compact:o=!1}=e;return(0,t.jsx)("td",{className:"".concat(o?"px-2 py-2":"px-6 py-4"," text-sm ").concat(a),style:{color:"var(--cor-texto-secundario)"},children:r})};r.ZP=e=>{let{headers:r,children:a,className:c="",emptyMessage:i="Nenhum dado encontrado",isLoading:n=!1}=e;return(0,t.jsx)("div",{className:"w-full overflow-x-hidden rounded-lg border ".concat(c),style:{borderColor:"var(--cor-borda)"},children:(0,t.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[(0,t.jsx)("thead",{className:"bg-gray-100",children:(0,t.jsx)("tr",{children:r.map((e,r)=>(0,t.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},r))})}),(0,t.jsx)("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:n?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:r.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,t.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{className:"ml-2",children:"Carregando..."})]})})}):o.Children.count(a)>0?a:(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:r.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:i})})})]})})}},32355:function(e,r,a){"use strict";a.d(r,{g:function(){return o}});let t=()=>localStorage.getItem("auth_token"),o=()=>{let e=t();return{"Content-Type":"application/json",...e&&{Authorization:"Bearer ".concat(e)}}}},36806:function(e,r,a){"use strict";a.d(r,{O:function(){return n},Q:function(){return s}});var t=a(64090),o=a(32355);let c=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de receitas...");let e=await fetch("/api/categorias-receitas",{headers:(0,o.g)()});if(console.log("\uD83D\uDCE1 Response status: ".concat(e.status)),!e.ok){let r=await e.text();throw console.error("❌ Erro na API categorias-receitas: ".concat(e.status," - ").concat(r)),Error("Erro ao buscar categorias de receitas: ".concat(e.status))}let r=await e.json();return console.log("✅ Categorias de receitas carregadas: ".concat(r.length)),r}catch(e){return console.error("❌ Erro ao buscar categorias de receitas:",e),[]}},i=[{id:"",nome:"Entrada"},{id:"",nome:"Prato Principal"},{id:"",nome:"Acompanhamento"},{id:"",nome:"Sobremesa"},{id:"",nome:"Bebida"},{id:"",nome:"Molho/Condimento"},{id:"",nome:"Outro"}],n=()=>{let[e,r]=(0,t.useState)([]),[a,n]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{let e=!0;return(async()=>{try{if(!e)return;n(!0);let a=await c();if(!e)return;if(0===a.length){for(let r of i){if(!e)return;try{let e=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:r.nome})});if(e.ok){let r=await e.json();a.push(r)}else 409===e.status&&console.log("Categoria de receita '".concat(r.nome,"' j\xe1 existe, pulando..."))}catch(e){console.error("Erro ao criar categoria de receita padr\xe3o:",e)}}e&&(a=await c())}e&&r(a)}catch(a){console.error("Erro ao carregar categorias de receitas:",a),e&&r([])}finally{e&&n(!1)}})(),()=>{e=!1}},[]),{categorias:e,isLoading:a,adicionar:async e=>{try{let a=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({nome:e})});if(!a.ok)throw Error("Erro ao adicionar categoria");let t=await a.json();return r(e=>[...e,t]),t}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},atualizar:async(e,a)=>{try{let t=await fetch("/api/categorias-receitas/".concat(e),{method:"PUT",headers:(0,o.g)(),body:JSON.stringify({nome:a})});if(!t.ok)throw Error("Erro ao atualizar categoria");let c=await t.json();return r(r=>r.map(r=>r.id===e?c:r)),!0}catch(e){return console.error("Erro ao atualizar categoria:",e),!1}},remover:async e=>{try{if(!(await fetch("/api/categorias-receitas/".concat(e),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao remover categoria");return r(r=>r.filter(r=>r.id!==e)),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}},obterPorId:r=>e.find(e=>e.id===r)}},s=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e)return"N\xe3o informado";let a=r.find(r=>r.id===e);return a?a.nome:e.length>20?"Categoria n\xe3o encontrada":e}},16297:function(e,r,a){"use strict";a.d(r,{Gm:function(){return d},IO:function(){return h},N2:function(){return x},Q_:function(){return c.Q},eW:function(){return f},gZ:function(){return p},lB:function(){return s},vG:function(){return u},vT:function(){return g},zP:function(){return n}});var t=a(64090),o=a(32355),c=a(36806);let i={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},n=(e,r,a)=>{let t=i[r],o=i[a];return t&&o&&t.tipo===o.tipo?e*t.fator/o.fator:e},s=async()=>{try{let e=await fetch("/api/fichas-tecnicas",{headers:(0,o.g)()});if(!e.ok)throw Error("Erro ao buscar fichas t\xe9cnicas: ".concat(e.status));return await e.json()}catch(e){return console.error("Error loading fichas t\xe9cnicas:",e),[]}},l=(e,r)=>e.reduce((e,a)=>{var t,o;let c=r.find(e=>e.id===a.produtoId);if(!c)return e;let s=a.unidade||c.unidadeMedida,l=null===(t=i[s])||void 0===t?void 0:t.tipo;if("peso"===l)return e+n(a.quantidade,s,"g");if("volume"===l)return e+n(a.quantidade,s,"ml");{let r=c.pesoEmbalagem||(null===(o=i[c.unidadeMedida])||void 0===o?void 0:o.fator)||1;return e+n(a.quantidade,s,c.unidadeMedida)*r}},0),d=(e,r,a)=>{var t;let o=null===(t=i[r])||void 0===t?void 0:t.tipo;return"peso"===o||"volume"===o?n(l(e,a),"peso"===o?"g":"ml",r):e.reduce((e,t)=>{let o=a.find(e=>e.id===t.produtoId),c=t.unidade||(null==o?void 0:o.unidadeMedida)||"un";return e+n(t.quantidade,c,r)},0)},u=()=>{let[e,r]=(0,t.useState)([]),[a,o]=(0,t.useState)(!1);return{fichasTecnicas:e,isLoading:a,setFichasTecnicas:r,setIsLoading:o,obterFichaTecnicaPorId:r=>e.find(e=>e.id===r),calcularRendimentoTotal:d,atualizarFichaTecnica:m,removerFichaTecnica:x}},h=async e=>{try{let r=await fetch("/api/fichas-tecnicas/".concat(e),{headers:(0,o.g)()});if(!r.ok){if(404===r.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let a=await r.json();return{...a,dataCriacao:a.createdAt?new Date(a.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:a.updatedAt?new Date(a.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(a.tempoPreparo)||0,custoTotal:Number(a.custoTotal)||0,custoPorcao:Number(a.custoPorcao)||0,custoPorKg:a.custoTotal&&a.rendimentoTotal?a.custoTotal/a.rendimentoTotal*1e3:0}}catch(e){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",e),null}},f=async e=>{try{let r=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify(e)});if(!r.ok){let e=await r.text();throw console.error("Erro na resposta da API:",r.status,e),Error("Erro ao criar ficha t\xe9cnica: ".concat(r.status))}return await r.json()}catch(e){return console.error("Erro ao adicionar ficha t\xe9cnica:",e),null}},m=async(e,r)=>{try{let a=await fetch("/api/fichas-tecnicas/".concat(e),{method:"PUT",headers:(0,o.g)(),body:JSON.stringify(r)});if(!a.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await a.json()}catch(e){return console.error("Erro ao atualizar ficha t\xe9cnica:",e),null}},x=async e=>{try{if(!(await fetch("/api/fichas-tecnicas/".concat(e),{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(e){return console.error("Erro ao remover ficha t\xe9cnica:",e),!1}},p=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],g=e=>{let r=p.find(r=>r.value===e);return r?r.label:e}}},function(e){e.O(0,[792,971,69,744],function(){return e(e.s=92881)}),_N_E=e.O()}]);