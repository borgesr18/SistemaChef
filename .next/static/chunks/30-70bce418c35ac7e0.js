"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[30],{57418:function(r,a,o){var t=o(3827);o(64090),a.Z=r=>{let{children:a,title:o,className:e="",footer:i}=r;return(0,t.jsxs)("div",{className:"card overflow-hidden ".concat(e),children:[o&&(0,t.jsx)("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:(0,t.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:o})}),(0,t.jsx)("div",{className:"p-6",children:a}),i&&(0,t.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:i})]})}},32355:function(r,a,o){o.d(a,{g:function(){return t},x:function(){return e}});let t=()=>{var r,a;let o=null===(a=document.cookie)||void 0===a?void 0:null===(r=a.split("; ").find(r=>r.startsWith("sb-access-token=")))||void 0===r?void 0:r.split("=")[1];return{Authorization:o?"Bearer ".concat(o):""}},e={get:async r=>await fetch(r,{method:"GET",headers:{...t(),"Content-Type":"application/json"}}),post:async(r,a)=>await fetch(r,{method:"POST",headers:{...t(),"Content-Type":"application/json"},body:JSON.stringify(a)}),put:async(r,a)=>await fetch(r,{method:"PUT",headers:{...t(),"Content-Type":"application/json"},body:JSON.stringify(a)}),delete:async r=>await fetch(r,{method:"DELETE",headers:{...t(),"Content-Type":"application/json"}})}},36806:function(r,a,o){o(1877)},29130:function(r,a,o){o.d(a,{H:function(){return c}});var t=o(64090),e=o(27742),i=o(32355);let n=async()=>{try{let r=await fetch("/api/estoque",{headers:(0,i.g)()});if(!r.ok)throw Error("Erro ao buscar movimenta\xe7\xf5es");return await r.json()}catch(r){return console.error("Erro ao buscar movimenta\xe7\xf5es da API:",r),[]}},c=()=>{let[r,a]=(0,t.useState)([]),[o,c]=(0,t.useState)(!0),d=async r=>{if(r.preco)try{let a=(await (0,e.k)()).find(a=>a.id===r.produtoId);if(a){let o=a.pesoEmbalagem||1,t=o>0?(r.preco||a.preco)/o:0,e={...a,preco:r.preco||a.preco,precoUnitario:t,fornecedor:r.fornecedor||a.fornecedor,marca:r.marca||a.marca};await fetch("/api/produtos/".concat(a.id),{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(e)})}}catch(r){console.error("Erro ao atualizar produto:",r)}};(0,t.useEffect)(()=>{(async()=>{c(!0),a((await n()).filter(r=>"Producao"!==r.fornecedor)),c(!1)})()},[]);let u=async o=>{try{let t=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({...o,data:new Date().toISOString(),tipo:"entrada"})});if(!t.ok)throw Error("Erro ao registrar entrada");let e=await t.json(),n=[...r,e];return a(n),await d(e),e}catch(r){return console.error("Erro ao registrar entrada:",r),null}},s=async o=>{try{let t=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({produtoId:o.produtoId,quantidade:-Math.abs(o.quantidade),data:new Date().toISOString(),tipo:"saida"})});if(!t.ok)throw Error("Erro ao registrar sa\xedda");let e=await t.json(),n=[...r,e];return a(n),e}catch(r){return console.error("Erro ao registrar sa\xedda:",r),null}},l=async(o,t)=>{try{let e=await fetch("/api/estoque/".concat(o),{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(t)});if(!e.ok)throw Error("Erro ao atualizar movimenta\xe7\xe3o");let n=await e.json(),c=r.map(r=>r.id===o?n:r);return a(c),"entrada"===n.tipo&&await d(n),n}catch(r){return console.error("Erro ao atualizar movimenta\xe7\xe3o:",r),null}},f=async o=>{try{if(!(await fetch("/api/estoque/".concat(o),{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar movimenta\xe7\xe3o");let t=r.filter(r=>r.id!==o);return a(t),!0}catch(r){return console.error("Erro ao remover movimenta\xe7\xe3o:",r),!1}},p=(0,t.useCallback)(a=>r.filter(r=>r.produtoId===a).reduce((r,a)=>r+a.quantidade,0),[r]);return{movimentacoes:r,isLoading:o,registrarEntrada:u,registrarSaida:s,atualizarMovimentacao:l,removerMovimentacao:f,obterHistoricoPorProduto:a=>r.filter(r=>r.produtoId===a),calcularEstoqueAtual:p}}},16297:function(r,a,o){o.d(a,{Gm:function(){return s},IO:function(){return f},N2:function(){return h},Q_:function(){return i.obterLabelCategoriaReceita},eW:function(){return p},gZ:function(){return b},lB:function(){return d},vG:function(){return l},vT:function(){return g},zP:function(){return c}});var t=o(64090),e=o(32355),i=o(36806);let n={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},c=(r,a,o)=>{let t=n[a],e=n[o];return t&&e&&t.tipo===e.tipo?r*t.fator/e.fator:r},d=async()=>{try{let r=await fetch("/api/fichas-tecnicas",{headers:(0,e.g)()});if(!r.ok)throw Error("Erro ao buscar fichas t\xe9cnicas: ".concat(r.status));return await r.json()}catch(r){return console.error("Error loading fichas t\xe9cnicas:",r),[]}},u=(r,a)=>r.reduce((r,o)=>{var t,e;let i=a.find(r=>r.id===o.produtoId);if(!i)return r;let d=o.unidade||i.unidadeMedida,u=null===(t=n[d])||void 0===t?void 0:t.tipo;if("peso"===u)return r+c(o.quantidade,d,"g");if("volume"===u)return r+c(o.quantidade,d,"ml");{let a=i.pesoEmbalagem||(null===(e=n[i.unidadeMedida])||void 0===e?void 0:e.fator)||1;return r+c(o.quantidade,d,i.unidadeMedida)*a}},0),s=(r,a,o)=>{var t;let e=null===(t=n[a])||void 0===t?void 0:t.tipo;return"peso"===e||"volume"===e?c(u(r,o),"peso"===e?"g":"ml",a):r.reduce((r,t)=>{let e=o.find(r=>r.id===t.produtoId),i=t.unidade||(null==e?void 0:e.unidadeMedida)||"un";return r+c(t.quantidade,i,a)},0)},l=()=>{let[r,a]=(0,t.useState)([]),[o,e]=(0,t.useState)(!1);return{fichasTecnicas:r,isLoading:o,setFichasTecnicas:a,setIsLoading:e,obterFichaTecnicaPorId:a=>r.find(r=>r.id===a),calcularRendimentoTotal:s,atualizarFichaTecnica:m,removerFichaTecnica:h}},f=async r=>{try{let a=await fetch("/api/fichas-tecnicas/".concat(r),{headers:(0,e.g)()});if(!a.ok){if(404===a.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let o=await a.json();return{...o,dataCriacao:o.createdAt?new Date(o.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:o.updatedAt?new Date(o.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(o.tempoPreparo)||0,custoTotal:Number(o.custoTotal)||0,custoPorcao:Number(o.custoPorcao)||0,custoPorKg:o.custoTotal&&o.rendimentoTotal?o.custoTotal/o.rendimentoTotal*1e3:0}}catch(r){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",r),null}},p=async r=>{try{let a=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,e.g)(),body:JSON.stringify(r)});if(!a.ok){let r=await a.text();throw console.error("Erro na resposta da API:",a.status,r),Error("Erro ao criar ficha t\xe9cnica: ".concat(a.status))}return await a.json()}catch(r){return console.error("Erro ao adicionar ficha t\xe9cnica:",r),null}},m=async(r,a)=>{try{let o=await fetch("/api/fichas-tecnicas/".concat(r),{method:"PUT",headers:(0,e.g)(),body:JSON.stringify(a)});if(!o.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await o.json()}catch(r){return console.error("Erro ao atualizar ficha t\xe9cnica:",r),null}},h=async r=>{try{if(!(await fetch("/api/fichas-tecnicas/".concat(r),{method:"DELETE",headers:(0,e.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(r){return console.error("Erro ao remover ficha t\xe9cnica:",r),!1}},b=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],g=r=>{let a=b.find(a=>a.value===r);return a?a.label:r}},27742:function(r,a,o){o.d(a,{U:function(){return n},k:function(){return i}});var t=o(64090),e=o(32355);let i=async()=>{try{let r=await fetch("/api/produtos",{headers:(0,e.g)()});if(!r.ok)throw Error("Erro ao buscar produtos");return(await r.json()).map(r=>{var a,o;return{id:r.id,nome:r.nome,categoriaId:r.categoria,categoriaNome:null===(a=r.categoriaRef)||void 0===a?void 0:a.nome,marca:r.marca,unidadeId:r.unidadeMedida,unidadeNome:null===(o=r.unidadeRef)||void 0===o?void 0:o.nome,preco:Number(r.preco)||0,precoUnitario:r.precoUnitario?Number(r.precoUnitario):void 0,fornecedor:r.fornecedor,pesoEmbalagem:r.pesoEmbalagem?Number(r.pesoEmbalagem):void 0,imagem:r.imagem,ultimaMovimentacao:r.ultimaMovimentacao,infoNutricional:r.infoNutricional?{calorias:Number(r.infoNutricional.calorias),carboidratos:Number(r.infoNutricional.carboidratos),proteinas:Number(r.infoNutricional.proteinas),gordurasTotais:Number(r.infoNutricional.gordurasTotais),gordurasSaturadas:Number(r.infoNutricional.gordurasSaturadas),gordurasTrans:Number(r.infoNutricional.gordurasTrans),fibras:Number(r.infoNutricional.fibras),sodio:Number(r.infoNutricional.sodio)}:void 0}})}catch(r){return console.error("Erro ao buscar produtos da API:",r),[]}},n=()=>{let[r,a]=(0,t.useState)([]),[o,n]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{(async()=>{n(!0),a(await i()),n(!1)})()},[]),{produtos:r,isLoading:o,adicionarProduto:async r=>{try{let o={...r,precoUnitario:r.pesoEmbalagem?r.preco/r.pesoEmbalagem:void 0},t=await fetch("/api/produtos",{method:"POST",headers:{...(0,e.g)(),"Content-Type":"application/json"},body:JSON.stringify(o)});if(!t.ok)throw Error("Erro ao adicionar produto");let i=await t.json();return a(r=>[...r,i]),i}catch(r){return console.error("Erro ao adicionar produto:",r),null}},atualizarProduto:async(r,o)=>{try{let t={...o,precoUnitario:o.pesoEmbalagem?o.preco/o.pesoEmbalagem:void 0},i=await fetch("/api/produtos/".concat(r),{method:"PUT",headers:{...(0,e.g)(),"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw Error("Erro ao atualizar produto");let n=await i.json();return a(a=>a.map(a=>a.id===r?n:a)),n}catch(r){return console.error("Erro ao atualizar produto:",r),null}},removerProduto:async r=>{try{if(!(await fetch("/api/produtos/".concat(r),{method:"DELETE",headers:(0,e.g)()})).ok)throw Error("Erro ao remover produto");return a(a=>a.filter(a=>a.id!==r)),!0}catch(r){return console.error("Erro ao remover produto:",r),!1}},obterProdutoPorId:a=>r.find(r=>r.id===a)}}},1877:function(r,a,o){(0,o(33837).createBrowserClient)("https://sutmfzcmrlqnocsusiav.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1dG1memNtcmxxbm9jc3VzaWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1MzgwODMsImV4cCI6MjA2NjExNDA4M30.BQRo64qRNzqB_XGNeSe4jkZ8Mzzji8eUYVbS_nWw8tI")}}]);