"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{57418:function(r,a,e){var o=e(3827);e(64090),a.Z=r=>{let{children:a,title:e,className:t="",footer:i}=r;return(0,o.jsxs)("div",{className:"card overflow-hidden ".concat(t),children:[e&&(0,o.jsx)("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:(0,o.jsx)("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:e})}),(0,o.jsx)("div",{className:"p-6",children:a}),i&&(0,o.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:i})]})}},32355:function(r,a,e){e.d(a,{g:function(){return t}});let o=()=>localStorage.getItem("auth_token"),t=()=>{let r=o();return{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)}}}},36806:function(r,a,e){e.d(a,{O:function(){return c},Q:function(){return u}});var o=e(64090),t=e(32355);let i=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de receitas...");let r=await fetch("/api/categorias-receitas",{headers:(0,t.g)()});if(console.log("\uD83D\uDCE1 Response status: ".concat(r.status)),!r.ok){let a=await r.text();throw console.error("❌ Erro na API categorias-receitas: ".concat(r.status," - ").concat(a)),Error("Erro ao buscar categorias de receitas: ".concat(r.status))}let a=await r.json();return console.log("✅ Categorias de receitas carregadas: ".concat(a.length)),a}catch(r){return console.error("❌ Erro ao buscar categorias de receitas:",r),[]}},n=[{id:"",nome:"Entrada"},{id:"",nome:"Prato Principal"},{id:"",nome:"Acompanhamento"},{id:"",nome:"Sobremesa"},{id:"",nome:"Bebida"},{id:"",nome:"Molho/Condimento"},{id:"",nome:"Outro"}],c=()=>{let[r,a]=(0,o.useState)([]),[e,c]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{let r=!0;return(async()=>{try{if(!r)return;c(!0);let e=await i();if(!r)return;if(0===e.length){for(let a of n){if(!r)return;try{let r=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({nome:a.nome})});if(r.ok){let a=await r.json();e.push(a)}else 409===r.status&&console.log("Categoria de receita '".concat(a.nome,"' j\xe1 existe, pulando..."))}catch(r){console.error("Erro ao criar categoria de receita padr\xe3o:",r)}}r&&(e=await i())}r&&a(e)}catch(e){console.error("Erro ao carregar categorias de receitas:",e),r&&a([])}finally{r&&c(!1)}})(),()=>{r=!1}},[]),{categorias:r,isLoading:e,adicionar:async r=>{try{let e=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({nome:r})});if(!e.ok)throw Error("Erro ao adicionar categoria");let o=await e.json();return a(r=>[...r,o]),o}catch(r){return console.error("Erro ao adicionar categoria:",r),null}},atualizar:async(r,e)=>{try{let o=await fetch("/api/categorias-receitas/".concat(r),{method:"PUT",headers:(0,t.g)(),body:JSON.stringify({nome:e})});if(!o.ok)throw Error("Erro ao atualizar categoria");let i=await o.json();return a(a=>a.map(a=>a.id===r?i:a)),!0}catch(r){return console.error("Erro ao atualizar categoria:",r),!1}},remover:async r=>{try{if(!(await fetch("/api/categorias-receitas/".concat(r),{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao remover categoria");return a(a=>a.filter(a=>a.id!==r)),!0}catch(r){return console.error("Erro ao remover categoria:",r),!1}},obterPorId:a=>r.find(r=>r.id===a)}},u=function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!r)return"N\xe3o informado";let e=a.find(a=>a.id===r);return e?e.nome:r.length>20?"Categoria n\xe3o encontrada":r}},16297:function(r,a,e){e.d(a,{Gm:function(){return s},IO:function(){return f},N2:function(){return p},Q_:function(){return i.Q},eW:function(){return g},gZ:function(){return m},lB:function(){return u},vG:function(){return d},vT:function(){return b},zP:function(){return c}});var o=e(64090),t=e(32355),i=e(36806);let n={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},c=(r,a,e)=>{let o=n[a],t=n[e];return o&&t&&o.tipo===t.tipo?r*o.fator/t.fator:r},u=async()=>{try{let r=await fetch("/api/fichas-tecnicas",{headers:(0,t.g)()});if(!r.ok)throw Error("Erro ao buscar fichas t\xe9cnicas: ".concat(r.status));return await r.json()}catch(r){return console.error("Error loading fichas t\xe9cnicas:",r),[]}},l=(r,a)=>r.reduce((r,e)=>{var o,t;let i=a.find(r=>r.id===e.produtoId);if(!i)return r;let u=e.unidade||i.unidadeMedida,l=null===(o=n[u])||void 0===o?void 0:o.tipo;if("peso"===l)return r+c(e.quantidade,u,"g");if("volume"===l)return r+c(e.quantidade,u,"ml");{let a=i.pesoEmbalagem||(null===(t=n[i.unidadeMedida])||void 0===t?void 0:t.fator)||1;return r+c(e.quantidade,u,i.unidadeMedida)*a}},0),s=(r,a,e)=>{var o;let t=null===(o=n[a])||void 0===o?void 0:o.tipo;return"peso"===t||"volume"===t?c(l(r,e),"peso"===t?"g":"ml",a):r.reduce((r,o)=>{let t=e.find(r=>r.id===o.produtoId),i=o.unidade||(null==t?void 0:t.unidadeMedida)||"un";return r+c(o.quantidade,i,a)},0)},d=()=>{let[r,a]=(0,o.useState)([]),[e,t]=(0,o.useState)(!1);return{fichasTecnicas:r,isLoading:e,setFichasTecnicas:a,setIsLoading:t,obterFichaTecnicaPorId:a=>r.find(r=>r.id===a),calcularRendimentoTotal:s,atualizarFichaTecnica:h,removerFichaTecnica:p}},f=async r=>{try{let a=await fetch("/api/fichas-tecnicas/".concat(r),{headers:(0,t.g)()});if(!a.ok){if(404===a.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let e=await a.json();return{...e,dataCriacao:e.createdAt?new Date(e.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:e.updatedAt?new Date(e.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(e.tempoPreparo)||0,custoTotal:Number(e.custoTotal)||0,custoPorcao:Number(e.custoPorcao)||0,custoPorKg:e.custoTotal&&e.rendimentoTotal?e.custoTotal/e.rendimentoTotal*1e3:0}}catch(r){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",r),null}},g=async r=>{try{let a=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify(r)});if(!a.ok){let r=await a.text();throw console.error("Erro na resposta da API:",a.status,r),Error("Erro ao criar ficha t\xe9cnica: ".concat(a.status))}return await a.json()}catch(r){return console.error("Erro ao adicionar ficha t\xe9cnica:",r),null}},h=async(r,a)=>{try{let e=await fetch("/api/fichas-tecnicas/".concat(r),{method:"PUT",headers:(0,t.g)(),body:JSON.stringify(a)});if(!e.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await e.json()}catch(r){return console.error("Erro ao atualizar ficha t\xe9cnica:",r),null}},p=async r=>{try{if(!(await fetch("/api/fichas-tecnicas/".concat(r),{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(r){return console.error("Erro ao remover ficha t\xe9cnica:",r),!1}},m=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],b=r=>{let a=m.find(a=>a.value===r);return a?a.label:r}},27742:function(r,a,e){e.d(a,{Ug:function(){return c},k0:function(){return n},u5:function(){return s},ub:function(){return l}});var o=e(64090),t=e(16297),i=e(32355);let n=async()=>{try{let r=await fetch("/api/produtos",{headers:(0,i.g)()});if(!r.ok)throw Error("Erro ao buscar produtos");return(await r.json()).map(r=>{var a,e;return{...r,categoria:(null===(a=r.categoriaRef)||void 0===a?void 0:a.nome)||r.categoria||"",categoriaId:r.categoria,preco:Number(r.preco)||0,precoUnitario:r.precoUnitario?Number(r.precoUnitario):void 0,pesoEmbalagem:r.pesoEmbalagem?Number(r.pesoEmbalagem):void 0,categoriaRef:r.categoriaRef,unidadeRef:r.unidadeRef,unidadeMedida:(null===(e=r.unidadeRef)||void 0===e?void 0:e.nome)||r.unidadeMedida,infoNutricional:r.infoNutricional?{calorias:Number(r.infoNutricional.calorias)||0,carboidratos:Number(r.infoNutricional.carboidratos)||0,proteinas:Number(r.infoNutricional.proteinas)||0,gordurasTotais:Number(r.infoNutricional.gordurasTotais)||0,gordurasSaturadas:Number(r.infoNutricional.gordurasSaturadas)||0,gordurasTrans:Number(r.infoNutricional.gordurasTrans)||0,fibras:Number(r.infoNutricional.fibras)||0,sodio:Number(r.infoNutricional.sodio)||0}:void 0}})}catch(r){return console.error("Erro ao buscar produtos da API:",r),[]}},c=()=>{let[r,a]=(0,o.useState)([]),[e,c]=(0,o.useState)(!0),{fichasTecnicas:u}=(0,t.vG)();(0,o.useEffect)(()=>{(async()=>{try{c(!0);let r=await n();console.log("Produtos loaded:",(null==r?void 0:r.length)||0),a(r)}catch(r){console.error("Erro ao carregar produtos:",r),a([])}finally{c(!1)}})()},[]);let l=async e=>{try{let o={...e,precoUnitario:e.pesoEmbalagem&&e.pesoEmbalagem>0?e.preco/e.pesoEmbalagem:void 0},t=await fetch("/api/produtos",{method:"POST",headers:(0,i.g)(),body:JSON.stringify(o)});if(!t.ok)throw Error("Erro ao criar produto");let n=await t.json(),c=[...r,n];return a(c),n}catch(r){return console.error("Erro ao adicionar produto:",r),null}},s=async(e,o)=>{try{let t={...o,precoUnitario:o.pesoEmbalagem&&o.pesoEmbalagem>0?o.preco/o.pesoEmbalagem:void 0},n=await fetch("/api/produtos/".concat(e),{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(t)});if(!n.ok)throw Error("Erro ao atualizar produto");let c=await n.json(),u=r.map(r=>r.id===e?c:r);return a(u),c}catch(r){return console.error("Erro ao atualizar produto:",r),null}},d=async e=>{try{if(!(await fetch("/api/produtos/".concat(e),{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar produto");let o=r.filter(r=>r.id!==e);return a(o),!0}catch(r){return console.error("Erro ao remover produto:",r),!1}};return{produtos:(0,o.useMemo)(()=>r,[r]),isLoading:e,adicionarProduto:l,atualizarProduto:s,removerProduto:d,obterProdutoPorId:a=>r.find(r=>r.id===a)}},u=[{value:"hortifruti",label:"Hortifruti"},{value:"carnes",label:"Carnes"},{value:"laticinios",label:"Latic\xednios"},{value:"graos",label:"Gr\xe3os e Cereais"},{value:"bebidas",label:"Bebidas"},{value:"temperos",label:"Temperos"},{value:"outros",label:"Outros"}],l=function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!r)return"N\xe3o informado";let e=a.find(a=>a.id===r);if(e)return e.nome;let o=a.find(a=>a.nome===r);if(o)return o.nome;let t=u.find(a=>a.value===r);return t?t.label:r.length>10&&(r.includes("-")||r.includes("c"))?"Categoria n\xe3o encontrada":r},s=r=>{var a;if(null===(a=r.categoriaRef)||void 0===a?void 0:a.nome)return r.categoriaRef.nome;if(r.categoria&&"null"!==r.categoria&&""!==r.categoria.trim()){if(r.categoria.length<20&&!r.categoria.includes("-")&&!r.categoria.startsWith("c"))return r.categoria;let a=u.find(a=>a.value===r.categoria);if(a)return a.label}return"N\xe3o informado"}}}]);