exports.id=1163,exports.ids=[1163],exports.modules={52213:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=52213,e.exports=r},58359:()=>{},93739:()=>{},47834:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,2583,23)),Promise.resolve().then(t.t.bind(t,26840,23)),Promise.resolve().then(t.t.bind(t,38771,23)),Promise.resolve().then(t.t.bind(t,13225,23)),Promise.resolve().then(t.t.bind(t,9295,23)),Promise.resolve().then(t.t.bind(t,43982,23))},65571:(e,r,t)=>{Promise.resolve().then(t.bind(t,73826)),Promise.resolve().then(t.bind(t,85814))},73826:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>d});var s=t(95344),a=t(3729),o=t(56506),l=t(67101),i=t(43174);let n=()=>{let[e,r]=(0,a.useState)(!1),t=(0,a.useRef)(null),{usuarioAtual:n,logout:c}=(0,l.G)(),u=()=>r(!1);return s.jsx("header",{className:"border-b shadow-sm",style:{backgroundColor:"var(--cor-primaria)",color:"white",borderColor:"var(--cor-borda)"},children:(0,s.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[s.jsx(i.Z,{className:"text-xl"}),s.jsx("span",{className:"text-xs sm:text-sm whitespace-nowrap",children:"- Sistema de Fichas T\xe9cnicas"})]}),s.jsx("div",{className:"flex items-center space-x-4",children:(0,s.jsxs)("div",{className:"relative",onMouseEnter:()=>{t.current&&clearTimeout(t.current),r(!0)},onMouseLeave:()=>{t.current=setTimeout(()=>r(!1),200)},children:[(0,s.jsxs)("button",{onClick:()=>{r(!e)},className:"flex items-center space-x-2 focus:outline-none",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-white text-gray-800 flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-medium",children:n?.nome?.[0]?.toUpperCase()||"U"})}),s.jsx("span",{className:"hidden md:block text-sm font-medium text-white",children:n?.nome||"Usu\xe1rio"})]}),e&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-10",children:[s.jsx(o.default,{href:"/configuracoes/perfil",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Perfil"}),s.jsx(o.default,{href:"/configuracoes",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Configura\xe7\xf5es"}),s.jsx("div",{className:"border-t",style:{borderColor:"var(--cor-borda)"}}),s.jsx("button",{onClick:()=>{c(),u()},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Sair"})]})]})})]})})},c=()=>{let[e,r]=(0,a.useState)(!1);return(0,s.jsxs)("aside",{className:`text-white transition-all duration-300 ${e?"w-16":"w-64"} min-h-screen flex flex-col`,style:{backgroundColor:"var(--cor-primaria)"},children:[(0,s.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[!e&&s.jsx(i.Z,{className:"text-xl",showTagline:!1}),s.jsx("button",{onClick:()=>r(e=>!e),className:"p-2 rounded-full hover:bg-[var(--cor-secundaria)] focus:outline-none","aria-label":"Alternar menu lateral","aria-expanded":!e,children:s.jsx("span",{className:"material-icons",children:e?"chevron_right":"chevron_left"})})]}),s.jsx("nav",{className:"mt-4 flex-1",children:s.jsx("ul",{children:[{href:"/",icon:"dashboard",label:"Dashboard"},{href:"/fichas-tecnicas",icon:"receipt",label:"Fichas T\xe9cnicas"},{href:"/produtos",icon:"inventory",label:"Insumos"},{href:"/estoque",icon:"store",label:"Estoque de Insumos"},{href:"/producao",icon:"factory",label:"Produ\xe7\xe3o"},{href:"/estoque-producao",icon:"warehouse",label:"Estoque de Produ\xe7\xe3o"},{href:"/precos",icon:"attach_money",label:"Pre\xe7os de Venda"},{href:"/relatorios",icon:"bar_chart",label:"Relat\xf3rios"},{href:"/configuracoes",icon:"settings",label:"Configura\xe7\xf5es"}].map(({href:r,icon:t,label:a})=>s.jsx("li",{children:(0,s.jsxs)(o.default,{href:r,className:"flex items-center px-4 py-3 hover:bg-[var(--cor-secundaria)] transition-colors",children:[s.jsx("span",{className:"material-icons mr-3",children:t}),!e&&s.jsx("span",{className:"text-sm",children:a})]})},r))})})]})};var u=t(8428);let d=({children:e})=>{let{usuarioAtual:r}=(0,l.G)(),t=(0,u.useRouter)(),o=(0,u.usePathname)();(0,a.useEffect)(()=>{r||"/login"===o||"/usuarios/novo"===o||t.push("/login"),r&&("/login"===o||"/usuarios/novo"===o)&&t.push("/")},[r,o,t]);let i="/login"===o||"/usuarios/novo"===o||o.includes("/imprimir");return(0,s.jsxs)("div",{className:"flex h-screen",style:{backgroundColor:"var(--cor-fundo)"},children:[!i&&s.jsx(c,{}),(0,s.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden",children:[!i&&s.jsx(n,{}),s.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:e}),!i&&(0,s.jsxs)("footer",{className:"p-4 text-center text-sm border-t",style:{backgroundColor:"white",color:"var(--cor-texto-secundario)",borderColor:"var(--cor-borda)"},children:["CustoChef \xa9 ",new Date().getFullYear()]})]})]})}},43174:(e,r,t)=>{"use strict";t.d(r,{Z:()=>o});var s=t(95344),a=t(89410);t(3729);let o=({className:e="",showTagline:r=!1})=>(0,s.jsxs)("span",{className:`inline-flex items-center space-x-2 ${e}`,children:[s.jsx(a.default,{src:"/logo.svg",alt:"GastroChef",width:24,height:24}),s.jsx("span",{className:"font-bold",children:"GastroChef"}),r&&s.jsx("span",{className:"text-xs whitespace-nowrap",children:"Sistema de Fichas T\xe9cnicas"})]})},85814:(e,r,t)=>{"use strict";t.r(r),t.d(r,{AuthProvider:()=>n,useAuth:()=>c});var s=t(95344),a=t(3729),o=t(61730),l=t(8428);let i=(0,a.createContext)(void 0),n=({children:e})=>{let r=(0,l.useRouter)(),[t,n]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[d,h]=(0,a.useState)(!0),m=(0,o.createBrowserClient)("https://sutmfzcmrlqnocsusiav.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN1dG1memNtcmxxbm9jc3VzaWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1MzgwODMsImV4cCI6MjA2NjExNDA4M30.BQRo64qRNzqB_XGNeSe4jkZ8Mzzji8eUYVbS_nWw8tI");(0,a.useEffect)(()=>{(async()=>{let{data:e,error:r}=await m.auth.getSession();e.session?(u(e.session),n(e.session.user)):(u(null),n(null)),h(!1)})();let{data:e}=m.auth.onAuthStateChange((e,r)=>{u(r),n(r?.user||null)});return()=>{e.subscription.unsubscribe()}},[]);let x=async()=>{await m.auth.signOut(),n(null),u(null),r.push("/login")};return s.jsx(i.Provider,{value:{user:t,session:c,loading:d,signOut:x},children:e})},c=()=>{let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},94287:(e,r,t)=>{"use strict";t.d(r,{g:()=>a});let s=()=>null,a=()=>{let e=s();return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}}},67101:(e,r,t)=>{"use strict";t.d(r,{G:()=>i});var s=t(3729),a=t(94287);let o=async()=>{try{console.log("\uD83D\uDCE1 Fazendo chamada para /api/auth/users...");let e=await fetch("/api/auth/users",{headers:(0,a.g)()});if(console.log(`ðŸ“¡ Response status: ${e.status}`),!e.ok){let r=await e.text();throw console.error(`âŒ Erro na API users: ${e.status} - ${r}`),Error(`Erro ao buscar usu\xe1rios: ${e.status}`)}let r=await e.json();return console.log(`âœ… Usu\xe1rios da API: ${r.length}`),r.map(e=>({role:"viewer",...e}))}catch(e){return console.error("âŒ Erro ao buscar usu\xe1rios da API:",e),[]}},l=e=>e.filter(e=>!e.oculto),i=()=>{let[e,r]=(0,s.useState)([]),[t,i]=(0,s.useState)(null),[n,c]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{try{c(!0),console.log("\uD83D\uDD0D Carregando usu\xe1rios...");let e=localStorage.getItem("auth_token"),t=localStorage.getItem("user_data");if(console.log("\uD83D\uDD10 Auth state:",{tokenExists:!!e,userDataExists:!!t}),e&&t&&"undefined"!==t){let e=JSON.parse(t);if(console.log("âœ… Usu\xe1rio atual carregado:",e.email),i(e),"admin"===e.role){let e=await o();console.log("âœ… Usu\xe1rios carregados:",e?.length||0),r(e)}else console.log("\uD83D\uDC64 User is not admin, skipping users list"),r([])}else console.log("âš ï¸ No valid auth token or user data found"),i(null),r([])}catch(e){console.error("âŒ Erro ao carregar usu\xe1rios:",e),r([]),i(null)}finally{c(!1)}})()},[]);let u=e=>/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9]).{6,}$/.test(e),d=async t=>{if(e.some(e=>e.email===t.email)||!u(t.senha))return null;try{let s=await fetch("/api/auth/register",{method:"POST",headers:(0,a.g)(),body:JSON.stringify(t)}),o=await s.json();if(!s.ok)return console.error("Erro no registro:",o),null;let l=[...e,o];return r(l),o}catch(e){return console.error("Erro ao registrar usu\xe1rio:",e),null}},h=()=>{i(null),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data")},m=async e=>{try{if(!(await fetch(`/api/auth/users/${e}`,{method:"DELETE",headers:(0,a.g)()})).ok)throw Error("Erro ao deletar usu\xe1rio");let s=await o();return r(l(s)),t?.id===e&&h(),!0}catch(e){return console.error("Erro ao remover usu\xe1rio:",e),!1}},x=async(e,s)=>{try{if(!(await fetch(`/api/auth/users/${e}/password`,{method:"PUT",headers:(0,a.g)(),body:JSON.stringify({novaSenha:s})})).ok)throw Error("Erro ao alterar senha");let n=await o();if(r(l(n)),t?.id===e){let r=n.find(r=>r.id===e)||null;i(r)}return!0}catch(e){return console.error("Erro ao alterar senha:",e),!1}},f=async(e,s)=>{try{if((await o()).some(r=>r.email===s.email&&r.id!==e))return!1;if(!(await fetch(`/api/auth/users/${e}`,{method:"PUT",headers:(0,a.g)(),body:JSON.stringify(s)})).ok)throw Error("Erro ao editar usu\xe1rio");let n=await o();if(r(l(n)),t?.id===e){let r=n.find(r=>r.id===e)||null;i(r),localStorage.setItem("user_data",JSON.stringify(r))}return!0}catch(e){return console.error("Erro ao editar usu\xe1rio:",e),!1}};return{usuarios:e,usuarioAtual:t,isLoading:n,registrarUsuario:d,login:async(e,t)=>{try{let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,senha:t})});if(!s.ok)return null;let{user:a,token:n}=await s.json();i(a),localStorage.setItem("auth_token",n),localStorage.setItem("user_data",JSON.stringify(a));let c=await o();if(!c.find(e=>e.id===a.id)){let e=[...c,a];r(l(e))}return a}catch{return null}},logout:h,removerUsuario:m,alterarSenha:x,editarUsuario:f}}},57793:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g,metadata:()=>f});var s=t(25036),a=t(42195),o=t.n(a);t(5023);var l=t(86843);let i=(0,l.createProxy)(String.raw`/workspaces/SistemaChef/src/components/layout/MainLayout.tsx`),{__esModule:n,$$typeof:c}=i,u=i.default,d=(0,l.createProxy)(String.raw`/workspaces/SistemaChef/src/contexts/AuthContext.tsx`),{__esModule:h,$$typeof:m}=d;d.default;let x=(0,l.createProxy)(String.raw`/workspaces/SistemaChef/src/contexts/AuthContext.tsx#AuthProvider`);(0,l.createProxy)(String.raw`/workspaces/SistemaChef/src/contexts/AuthContext.tsx#useAuth`);let f={title:"GastroChef",description:"Sistema de fichas t\xe9cnicas e controle de produ\xe7\xe3o"};function g({children:e}){return s.jsx("html",{lang:"pt-BR",children:s.jsx("body",{className:o().className,children:(0,s.jsxs)(x,{children:[" ",s.jsx(u,{children:e})]})})})}},5023:()=>{}};