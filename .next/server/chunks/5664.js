"use strict";exports.id=5664,exports.ids=[5664],exports.modules={79956:(r,a,e)=>{e.d(a,{Z:()=>t});var o=e(95344);e(3729);let t=({children:r,title:a,className:e="",footer:t})=>(0,o.jsxs)("div",{className:`card overflow-hidden ${e}`,children:[a&&o.jsx("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:o.jsx("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:a})}),o.jsx("div",{className:"p-6",children:r}),t&&o.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:t})]})},76617:(r,a,e)=>{e.d(a,{O:()=>n,Q:()=>s});var o=e(3729),t=e(94287);let i=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de receitas...");let r=await fetch("/api/categorias-receitas",{headers:(0,t.g)()});if(console.log(`ðŸ“¡ Response status: ${r.status}`),!r.ok){let a=await r.text();throw console.error(`âŒ Erro na API categorias-receitas: ${r.status} - ${a}`),Error(`Erro ao buscar categorias de receitas: ${r.status}`)}let a=await r.json();return console.log(`âœ… Categorias de receitas carregadas: ${a.length}`),a}catch(r){return console.error("âŒ Erro ao buscar categorias de receitas:",r),[]}},c=[{id:"",nome:"Entrada"},{id:"",nome:"Prato Principal"},{id:"",nome:"Acompanhamento"},{id:"",nome:"Sobremesa"},{id:"",nome:"Bebida"},{id:"",nome:"Molho/Condimento"},{id:"",nome:"Outro"}],n=()=>{let[r,a]=(0,o.useState)([]),[e,n]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{let r=!0;return(async()=>{try{if(!r)return;n(!0);let e=await i();if(!r)return;if(0===e.length){for(let a of c){if(!r)return;try{let r=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({nome:a.nome})});if(r.ok){let a=await r.json();e.push(a)}else 409===r.status&&console.log(`Categoria de receita '${a.nome}' j\xe1 existe, pulando...`)}catch(r){console.error("Erro ao criar categoria de receita padr\xe3o:",r)}}r&&(e=await i())}r&&a(e)}catch(e){console.error("Erro ao carregar categorias de receitas:",e),r&&a([])}finally{r&&n(!1)}})(),()=>{r=!1}},[]),{categorias:r,isLoading:e,adicionar:async r=>{try{let e=await fetch("/api/categorias-receitas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({nome:r})});if(!e.ok)throw Error("Erro ao adicionar categoria");let o=await e.json();return a(r=>[...r,o]),o}catch(r){return console.error("Erro ao adicionar categoria:",r),null}},atualizar:async(r,e)=>{try{let o=await fetch(`/api/categorias-receitas/${r}`,{method:"PUT",headers:(0,t.g)(),body:JSON.stringify({nome:e})});if(!o.ok)throw Error("Erro ao atualizar categoria");let i=await o.json();return a(a=>a.map(a=>a.id===r?i:a)),!0}catch(r){return console.error("Erro ao atualizar categoria:",r),!1}},remover:async r=>{try{if(!(await fetch(`/api/categorias-receitas/${r}`,{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao remover categoria");return a(a=>a.filter(a=>a.id!==r)),!0}catch(r){return console.error("Erro ao remover categoria:",r),!1}},obterPorId:a=>r.find(r=>r.id===a)}},s=(r,a=[])=>{if(!r)return"N\xe3o informado";let e=a.find(a=>a.id===r);return e?e.nome:r.length>20?"Categoria n\xe3o encontrada":r}},34962:(r,a,e)=>{e.d(a,{Gm:()=>d,IO:()=>f,N2:()=>p,Q_:()=>i.Q,eW:()=>g,gZ:()=>h,lB:()=>s,vG:()=>u,vT:()=>b,zP:()=>n});var o=e(3729),t=e(94287),i=e(76617);let c={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},n=(r,a,e)=>{let o=c[a],t=c[e];return o&&t&&o.tipo===t.tipo?r*o.fator/t.fator:r},s=async()=>{try{let r=await fetch("/api/fichas-tecnicas",{headers:(0,t.g)()});if(!r.ok)throw Error(`Erro ao buscar fichas t\xe9cnicas: ${r.status}`);return await r.json()}catch(r){return console.error("Error loading fichas t\xe9cnicas:",r),[]}},l=(r,a)=>r.reduce((r,e)=>{let o=a.find(r=>r.id===e.produtoId);if(!o)return r;let t=e.unidade||o.unidadeMedida,i=c[t]?.tipo;if("peso"===i)return r+n(e.quantidade,t,"g");if("volume"===i)return r+n(e.quantidade,t,"ml");{let a=o.pesoEmbalagem||c[o.unidadeMedida]?.fator||1;return r+n(e.quantidade,t,o.unidadeMedida)*a}},0),d=(r,a,e)=>{let o=c[a]?.tipo;return"peso"===o||"volume"===o?n(l(r,e),"peso"===o?"g":"ml",a):r.reduce((r,o)=>{let t=e.find(r=>r.id===o.produtoId),i=o.unidade||t?.unidadeMedida||"un";return r+n(o.quantidade,i,a)},0)},u=()=>{let[r,a]=(0,o.useState)([]),[e,t]=(0,o.useState)(!1);return{fichasTecnicas:r,isLoading:e,setFichasTecnicas:a,setIsLoading:t,obterFichaTecnicaPorId:a=>r.find(r=>r.id===a),calcularRendimentoTotal:d,atualizarFichaTecnica:m,removerFichaTecnica:p}},f=async r=>{try{let a=await fetch(`/api/fichas-tecnicas/${r}`,{headers:(0,t.g)()});if(!a.ok){if(404===a.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let e=await a.json();return{...e,dataCriacao:e.createdAt?new Date(e.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:e.updatedAt?new Date(e.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(e.tempoPreparo)||0,custoTotal:Number(e.custoTotal)||0,custoPorcao:Number(e.custoPorcao)||0,custoPorKg:e.custoTotal&&e.rendimentoTotal?e.custoTotal/e.rendimentoTotal*1e3:0}}catch(r){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",r),null}},g=async r=>{try{let a=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify(r)});if(!a.ok){let r=await a.text();throw console.error("Erro na resposta da API:",a.status,r),Error(`Erro ao criar ficha t\xe9cnica: ${a.status}`)}return await a.json()}catch(r){return console.error("Erro ao adicionar ficha t\xe9cnica:",r),null}},m=async(r,a)=>{try{let e=await fetch(`/api/fichas-tecnicas/${r}`,{method:"PUT",headers:(0,t.g)(),body:JSON.stringify(a)});if(!e.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await e.json()}catch(r){return console.error("Erro ao atualizar ficha t\xe9cnica:",r),null}},p=async r=>{try{if(!(await fetch(`/api/fichas-tecnicas/${r}`,{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(r){return console.error("Erro ao remover ficha t\xe9cnica:",r),!1}},h=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],b=r=>{let a=h.find(a=>a.value===r);return a?a.label:r}},48806:(r,a,e)=>{e.d(a,{Ug:()=>n,k0:()=>c,u5:()=>d,ub:()=>l});var o=e(3729),t=e(34962),i=e(94287);let c=async()=>{try{let r=await fetch("/api/produtos",{headers:(0,i.g)()});if(!r.ok)throw Error("Erro ao buscar produtos");return(await r.json()).map(r=>({...r,categoria:r.categoriaRef?.nome||r.categoria||"",categoriaId:r.categoria,preco:Number(r.preco)||0,precoUnitario:r.precoUnitario?Number(r.precoUnitario):void 0,pesoEmbalagem:r.pesoEmbalagem?Number(r.pesoEmbalagem):void 0,categoriaRef:r.categoriaRef,unidadeRef:r.unidadeRef,unidadeMedida:r.unidadeRef?.nome||r.unidadeMedida,infoNutricional:r.infoNutricional?{calorias:Number(r.infoNutricional.calorias)||0,carboidratos:Number(r.infoNutricional.carboidratos)||0,proteinas:Number(r.infoNutricional.proteinas)||0,gordurasTotais:Number(r.infoNutricional.gordurasTotais)||0,gordurasSaturadas:Number(r.infoNutricional.gordurasSaturadas)||0,gordurasTrans:Number(r.infoNutricional.gordurasTrans)||0,fibras:Number(r.infoNutricional.fibras)||0,sodio:Number(r.infoNutricional.sodio)||0}:void 0}))}catch(r){return console.error("Erro ao buscar produtos da API:",r),[]}},n=()=>{let[r,a]=(0,o.useState)([]),[e,n]=(0,o.useState)(!0),{fichasTecnicas:s}=(0,t.vG)();(0,o.useEffect)(()=>{(async()=>{try{n(!0);let r=await c();console.log("Produtos loaded:",r?.length||0),a(r)}catch(r){console.error("Erro ao carregar produtos:",r),a([])}finally{n(!1)}})()},[]);let l=async e=>{try{let o={...e,precoUnitario:e.pesoEmbalagem&&e.pesoEmbalagem>0?e.preco/e.pesoEmbalagem:void 0},t=await fetch("/api/produtos",{method:"POST",headers:(0,i.g)(),body:JSON.stringify(o)});if(!t.ok)throw Error("Erro ao criar produto");let c=await t.json(),n=[...r,c];return a(n),c}catch(r){return console.error("Erro ao adicionar produto:",r),null}},d=async(e,o)=>{try{let t={...o,precoUnitario:o.pesoEmbalagem&&o.pesoEmbalagem>0?o.preco/o.pesoEmbalagem:void 0},c=await fetch(`/api/produtos/${e}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(t)});if(!c.ok)throw Error("Erro ao atualizar produto");let n=await c.json(),s=r.map(r=>r.id===e?n:r);return a(s),n}catch(r){return console.error("Erro ao atualizar produto:",r),null}},u=async e=>{try{if(!(await fetch(`/api/produtos/${e}`,{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar produto");let o=r.filter(r=>r.id!==e);return a(o),!0}catch(r){return console.error("Erro ao remover produto:",r),!1}};return{produtos:(0,o.useMemo)(()=>r,[r]),isLoading:e,adicionarProduto:l,atualizarProduto:d,removerProduto:u,obterProdutoPorId:a=>r.find(r=>r.id===a)}},s=[{value:"hortifruti",label:"Hortifruti"},{value:"carnes",label:"Carnes"},{value:"laticinios",label:"Latic\xednios"},{value:"graos",label:"Gr\xe3os e Cereais"},{value:"bebidas",label:"Bebidas"},{value:"temperos",label:"Temperos"},{value:"outros",label:"Outros"}],l=(r,a=[])=>{if(!r)return"N\xe3o informado";let e=a.find(a=>a.id===r);if(e)return e.nome;let o=a.find(a=>a.nome===r);if(o)return o.nome;let t=s.find(a=>a.value===r);return t?t.label:r.length>10&&(r.includes("-")||r.includes("c"))?"Categoria n\xe3o encontrada":r},d=r=>{if(r.categoriaRef?.nome)return r.categoriaRef.nome;if(r.categoria&&"null"!==r.categoria&&""!==r.categoria.trim()){if(r.categoria.length<20&&!r.categoria.includes("-")&&!r.categoria.startsWith("c"))return r.categoria;let a=s.find(a=>a.value===r.categoria);if(a)return a.label}return"N\xe3o informado"}},73881:(r,a,e)=>{e.r(a),e.d(a,{default:()=>t});var o=e(70337);let t=r=>[{type:"image/x-icon",sizes:"16x16",url:(0,o.fillMetadataSegment)(".",r.params,"favicon.ico")+""}]}};