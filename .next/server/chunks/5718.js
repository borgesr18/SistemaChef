"use strict";exports.id=5718,exports.ids=[5718],exports.modules={79956:(r,a,o)=>{o.d(a,{Z:()=>t});var e=o(95344);o(3729);let t=({children:r,title:a,className:o="",footer:t})=>(0,e.jsxs)("div",{className:`card overflow-hidden ${o}`,children:[a&&e.jsx("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:e.jsx("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:a})}),e.jsx("div",{className:"p-6",children:r}),t&&e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:t})]})},94287:(r,a,o)=>{o.d(a,{g:()=>e,x:()=>t});let e=()=>{let r=document.cookie?.split("; ").find(r=>r.startsWith("sb-access-token="))?.split("=")[1];return{Authorization:r?`Bearer ${r}`:""}},t={get:async r=>await fetch(r,{method:"GET",headers:{...e(),"Content-Type":"application/json"}}),post:async(r,a)=>await fetch(r,{method:"POST",headers:{...e(),"Content-Type":"application/json"},body:JSON.stringify(a)}),put:async(r,a)=>await fetch(r,{method:"PUT",headers:{...e(),"Content-Type":"application/json"},body:JSON.stringify(a)}),delete:async r=>await fetch(r,{method:"DELETE",headers:{...e(),"Content-Type":"application/json"}})}},76617:(r,a,o)=>{o(46179)},34382:(r,a,o)=>{o.d(a,{H:()=>c});var e=o(3729),t=o(48806),i=o(94287);let n=async()=>{try{let r=await fetch("/api/estoque",{headers:(0,i.g)()});if(!r.ok)throw Error("Erro ao buscar movimenta\xe7\xf5es");return await r.json()}catch(r){return console.error("Erro ao buscar movimenta\xe7\xf5es da API:",r),[]}},c=()=>{let[r,a]=(0,e.useState)([]),[o,c]=(0,e.useState)(!0),d=async r=>{if(r.preco)try{let a=(await (0,t.k)()).find(a=>a.id===r.produtoId);if(a){let o=a.pesoEmbalagem||1,e=o>0?(r.preco||a.preco)/o:0,t={...a,preco:r.preco||a.preco,precoUnitario:e,fornecedor:r.fornecedor||a.fornecedor,marca:r.marca||a.marca};await fetch(`/api/produtos/${a.id}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(t)})}}catch(r){console.error("Erro ao atualizar produto:",r)}};(0,e.useEffect)(()=>{(async()=>{c(!0),a((await n()).filter(r=>"Producao"!==r.fornecedor)),c(!1)})()},[]);let s=async o=>{try{let e=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({...o,data:new Date().toISOString(),tipo:"entrada"})});if(!e.ok)throw Error("Erro ao registrar entrada");let t=await e.json(),n=[...r,t];return a(n),await d(t),t}catch(r){return console.error("Erro ao registrar entrada:",r),null}},u=async o=>{try{let e=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({produtoId:o.produtoId,quantidade:-Math.abs(o.quantidade),data:new Date().toISOString(),tipo:"saida"})});if(!e.ok)throw Error("Erro ao registrar sa\xedda");let t=await e.json(),n=[...r,t];return a(n),t}catch(r){return console.error("Erro ao registrar sa\xedda:",r),null}},l=async(o,e)=>{try{let t=await fetch(`/api/estoque/${o}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(e)});if(!t.ok)throw Error("Erro ao atualizar movimenta\xe7\xe3o");let n=await t.json(),c=r.map(r=>r.id===o?n:r);return a(c),"entrada"===n.tipo&&await d(n),n}catch(r){return console.error("Erro ao atualizar movimenta\xe7\xe3o:",r),null}},p=async o=>{try{if(!(await fetch(`/api/estoque/${o}`,{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar movimenta\xe7\xe3o");let e=r.filter(r=>r.id!==o);return a(e),!0}catch(r){return console.error("Erro ao remover movimenta\xe7\xe3o:",r),!1}},f=(0,e.useCallback)(a=>r.filter(r=>r.produtoId===a).reduce((r,a)=>r+a.quantidade,0),[r]);return{movimentacoes:r,isLoading:o,registrarEntrada:s,registrarSaida:u,atualizarMovimentacao:l,removerMovimentacao:p,obterHistoricoPorProduto:a=>r.filter(r=>r.produtoId===a),calcularEstoqueAtual:f}}},34962:(r,a,o)=>{o.d(a,{Gm:()=>u,IO:()=>p,N2:()=>h,Q_:()=>i.obterLabelCategoriaReceita,eW:()=>f,gZ:()=>g,lB:()=>d,vG:()=>l,vT:()=>y,zP:()=>c});var e=o(3729),t=o(94287),i=o(76617);let n={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},c=(r,a,o)=>{let e=n[a],t=n[o];return e&&t&&e.tipo===t.tipo?r*e.fator/t.fator:r},d=async()=>{try{let r=await fetch("/api/fichas-tecnicas",{headers:(0,t.g)()});if(!r.ok)throw Error(`Erro ao buscar fichas t\xe9cnicas: ${r.status}`);return await r.json()}catch(r){return console.error("Error loading fichas t\xe9cnicas:",r),[]}},s=(r,a)=>r.reduce((r,o)=>{let e=a.find(r=>r.id===o.produtoId);if(!e)return r;let t=o.unidade||e.unidadeMedida,i=n[t]?.tipo;if("peso"===i)return r+c(o.quantidade,t,"g");if("volume"===i)return r+c(o.quantidade,t,"ml");{let a=e.pesoEmbalagem||n[e.unidadeMedida]?.fator||1;return r+c(o.quantidade,t,e.unidadeMedida)*a}},0),u=(r,a,o)=>{let e=n[a]?.tipo;return"peso"===e||"volume"===e?c(s(r,o),"peso"===e?"g":"ml",a):r.reduce((r,e)=>{let t=o.find(r=>r.id===e.produtoId),i=e.unidade||t?.unidadeMedida||"un";return r+c(e.quantidade,i,a)},0)},l=()=>{let[r,a]=(0,e.useState)([]),[o,t]=(0,e.useState)(!1);return{fichasTecnicas:r,isLoading:o,setFichasTecnicas:a,setIsLoading:t,obterFichaTecnicaPorId:a=>r.find(r=>r.id===a),calcularRendimentoTotal:u,atualizarFichaTecnica:m,removerFichaTecnica:h}},p=async r=>{try{let a=await fetch(`/api/fichas-tecnicas/${r}`,{headers:(0,t.g)()});if(!a.ok){if(404===a.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let o=await a.json();return{...o,dataCriacao:o.createdAt?new Date(o.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:o.updatedAt?new Date(o.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(o.tempoPreparo)||0,custoTotal:Number(o.custoTotal)||0,custoPorcao:Number(o.custoPorcao)||0,custoPorKg:o.custoTotal&&o.rendimentoTotal?o.custoTotal/o.rendimentoTotal*1e3:0}}catch(r){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",r),null}},f=async r=>{try{let a=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,t.g)(),body:JSON.stringify(r)});if(!a.ok){let r=await a.text();throw console.error("Erro na resposta da API:",a.status,r),Error(`Erro ao criar ficha t\xe9cnica: ${a.status}`)}return await a.json()}catch(r){return console.error("Erro ao adicionar ficha t\xe9cnica:",r),null}},m=async(r,a)=>{try{let o=await fetch(`/api/fichas-tecnicas/${r}`,{method:"PUT",headers:(0,t.g)(),body:JSON.stringify(a)});if(!o.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await o.json()}catch(r){return console.error("Erro ao atualizar ficha t\xe9cnica:",r),null}},h=async r=>{try{if(!(await fetch(`/api/fichas-tecnicas/${r}`,{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(r){return console.error("Erro ao remover ficha t\xe9cnica:",r),!1}},g=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],y=r=>{let a=g.find(a=>a.value===r);return a?a.label:r}},48806:(r,a,o)=>{o.d(a,{U:()=>n,k:()=>i});var e=o(3729),t=o(94287);let i=async()=>{try{let r=await fetch("/api/produtos",{headers:(0,t.g)()});if(!r.ok)throw Error("Erro ao buscar produtos");return(await r.json()).map(r=>({id:r.id,nome:r.nome,categoriaId:r.categoria,categoriaNome:r.categoriaRef?.nome,marca:r.marca,unidadeId:r.unidadeMedida,unidadeNome:r.unidadeRef?.nome,preco:Number(r.preco)||0,precoUnitario:r.precoUnitario?Number(r.precoUnitario):void 0,fornecedor:r.fornecedor,pesoEmbalagem:r.pesoEmbalagem?Number(r.pesoEmbalagem):void 0,imagem:r.imagem,ultimaMovimentacao:r.ultimaMovimentacao,infoNutricional:r.infoNutricional?{calorias:Number(r.infoNutricional.calorias),carboidratos:Number(r.infoNutricional.carboidratos),proteinas:Number(r.infoNutricional.proteinas),gordurasTotais:Number(r.infoNutricional.gordurasTotais),gordurasSaturadas:Number(r.infoNutricional.gordurasSaturadas),gordurasTrans:Number(r.infoNutricional.gordurasTrans),fibras:Number(r.infoNutricional.fibras),sodio:Number(r.infoNutricional.sodio)}:void 0}))}catch(r){return console.error("Erro ao buscar produtos da API:",r),[]}},n=()=>{let[r,a]=(0,e.useState)([]),[o,n]=(0,e.useState)(!0);return(0,e.useEffect)(()=>{(async()=>{n(!0),a(await i()),n(!1)})()},[]),{produtos:r,isLoading:o,adicionarProduto:async r=>{try{let o={...r,precoUnitario:r.pesoEmbalagem?r.preco/r.pesoEmbalagem:void 0},e=await fetch("/api/produtos",{method:"POST",headers:{...(0,t.g)(),"Content-Type":"application/json"},body:JSON.stringify(o)});if(!e.ok)throw Error("Erro ao adicionar produto");let i=await e.json();return a(r=>[...r,i]),i}catch(r){return console.error("Erro ao adicionar produto:",r),null}},atualizarProduto:async(r,o)=>{try{let e={...o,precoUnitario:o.pesoEmbalagem?o.preco/o.pesoEmbalagem:void 0},i=await fetch(`/api/produtos/${r}`,{method:"PUT",headers:{...(0,t.g)(),"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok)throw Error("Erro ao atualizar produto");let n=await i.json();return a(a=>a.map(a=>a.id===r?n:a)),n}catch(r){return console.error("Erro ao atualizar produto:",r),null}},removerProduto:async r=>{try{if(!(await fetch(`/api/produtos/${r}`,{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao remover produto");return a(a=>a.filter(a=>a.id!==r)),!0}catch(r){return console.error("Erro ao remover produto:",r),!1}},obterProdutoPorId:a=>r.find(r=>r.id===a)}}}};