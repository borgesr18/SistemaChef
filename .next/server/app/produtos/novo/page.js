(()=>{var e={};e.id=1390,e.ids=[1390],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},96950:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>s.a,__next_app__:()=>m,originalPathname:()=>d,pages:()=>u,routeModule:()=>p,tree:()=>c});var o=a(50482),t=a(69108),i=a(62563),s=a.n(i),n=a(68300),l={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>n[e]);a.d(r,l);let c=["",{children:["produtos",{children:["novo",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,50768)),"/workspaces/SistemaChef/src/app/produtos/novo/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,75459)),"/workspaces/SistemaChef/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/workspaces/SistemaChef/src/app/produtos/novo/page.tsx"],d="/produtos/novo/page",m={require:a,loadChunk:()=>Promise.resolve()},p=new o.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/produtos/novo/page",pathname:"/produtos/novo",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},40128:(e,r,a)=>{Promise.resolve().then(a.bind(a,78990))},8428:(e,r,a)=>{"use strict";var o=a(14767);a.o(o,"redirect")&&a.d(r,{redirect:function(){return o.redirect}}),a.o(o,"useParams")&&a.d(r,{useParams:function(){return o.useParams}}),a.o(o,"useRouter")&&a.d(r,{useRouter:function(){return o.useRouter}})},78990:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>g});var o=a(95344),t=a(3729),i=a(8428),s=a(79956),n=a(10342),l=a(98649),c=a(34034),u=a(48806),d=a(5175),m=a(6158),p=a(42283);function g(){let e=(0,i.useRouter)(),{adicionarProduto:r}=(0,u.Ug)(),{categorias:a}=(0,m.D)(),{unidades:g}=(0,d.x)(),[f,h]=(0,t.useState)(!1),[b,x]=(0,t.useState)(!1),[N,v]=(0,t.useState)("");(0,t.useEffect)(()=>{if(!N)return;let e=setTimeout(()=>v(""),3e3);return()=>clearTimeout(e)},[N]);let[y,j]=(0,t.useState)({nome:"",categoria:"",marca:"",unidadeMedida:"",preco:"",fornecedor:"",pesoEmbalagem:"",infoNutricional:{calorias:"",carboidratos:"",proteinas:"",gordurasTotais:"",gordurasSaturadas:"",gordurasTrans:"",fibras:"",sodio:""}}),[w,E]=(0,t.useState)({}),C=e=>{let{name:r,value:a}=e.target;if(r.includes(".")){let[e,o]=r.split(".");j(r=>({...r,[e]:{...r[e],[o]:a}}))}else j(e=>({...e,[r]:a}))},S=()=>{let e={};if(y.nome||(e.nome="Nome \xe9 obrigat\xf3rio"),y.categoria||(e.categoria="Categoria \xe9 obrigat\xf3ria"),y.unidadeMedida||(e.unidadeMedida="Unidade de medida \xe9 obrigat\xf3ria"),y.preco?(isNaN(Number(y.preco))||0>=Number(y.preco))&&(e.preco="Pre\xe7o deve ser um n\xfamero positivo"):e.preco="Pre\xe7o \xe9 obrigat\xf3rio",y.fornecedor||(e.fornecedor="Fornecedor \xe9 obrigat\xf3rio"),(!y.pesoEmbalagem||isNaN(Number(y.pesoEmbalagem))||0>=Number(y.pesoEmbalagem))&&(e.pesoEmbalagem="Informe o peso por embalagem"),b){let r=y.infoNutricional;r.calorias&&isNaN(Number(r.calorias))&&(e["infoNutricional.calorias"]="Deve ser um n\xfamero"),r.carboidratos&&isNaN(Number(r.carboidratos))&&(e["infoNutricional.carboidratos"]="Deve ser um n\xfamero"),r.proteinas&&isNaN(Number(r.proteinas))&&(e["infoNutricional.proteinas"]="Deve ser um n\xfamero"),r.gordurasTotais&&isNaN(Number(r.gordurasTotais))&&(e["infoNutricional.gordurasTotais"]="Deve ser um n\xfamero"),r.gordurasSaturadas&&isNaN(Number(r.gordurasSaturadas))&&(e["infoNutricional.gordurasSaturadas"]="Deve ser um n\xfamero"),r.gordurasTrans&&isNaN(Number(r.gordurasTrans))&&(e["infoNutricional.gordurasTrans"]="Deve ser um n\xfamero"),r.fibras&&isNaN(Number(r.fibras))&&(e["infoNutricional.fibras"]="Deve ser um n\xfamero"),r.sodio&&isNaN(Number(r.sodio))&&(e["infoNutricional.sodio"]="Deve ser um n\xfamero")}return E(e),0===Object.keys(e).length};return(0,o.jsxs)("div",{className:"space-y-6",children:[o.jsx(p.Z,{message:N,onClose:()=>v("")}),o.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Novo Insumo"}),o.jsx("form",{onSubmit:a=>{if(a.preventDefault(),S()){h(!0);try{let a={...y,preco:Number(y.preco),pesoEmbalagem:Number(y.pesoEmbalagem),infoNutricional:b?{calorias:Number(y.infoNutricional.calorias)||0,carboidratos:Number(y.infoNutricional.carboidratos)||0,proteinas:Number(y.infoNutricional.proteinas)||0,gordurasTotais:Number(y.infoNutricional.gordurasTotais)||0,gordurasSaturadas:Number(y.infoNutricional.gordurasSaturadas)||0,gordurasTrans:Number(y.infoNutricional.gordurasTrans)||0,fibras:Number(y.infoNutricional.fibras)||0,sodio:Number(y.infoNutricional.sodio)||0}:void 0};r(a),e.push("/produtos")}catch(e){console.error("Erro ao salvar produto:",e),v("Erro ao salvar produto")}finally{h(!1)}}},children:(0,o.jsxs)(s.Z,{children:[(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx(n.Z,{label:"Nome do Insumo *",name:"nome",value:y.nome,onChange:C,error:w.nome,placeholder:"Ex: Farinha de Trigo"}),o.jsx(l.Z,{label:"Categoria *",name:"categoria",value:y.categoria,onChange:C,options:a.map(e=>({value:e.id,label:e.nome})).sort((e,r)=>e.label.localeCompare(r.label)),error:w.categoria}),o.jsx(n.Z,{label:"Marca",name:"marca",value:y.marca,onChange:C,placeholder:"Ex: Dona Benta"})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[o.jsx(l.Z,{label:"Unidade de Medida *",name:"unidadeMedida",value:y.unidadeMedida,onChange:C,options:g.map(e=>({value:e.id,label:e.nome})).sort((e,r)=>e.label.localeCompare(r.label)),error:w.unidadeMedida}),o.jsx(n.Z,{label:"Pre\xe7o (R$) *",name:"preco",type:"number",step:"0.01",min:"0",value:y.preco,onChange:C,error:w.preco,placeholder:"Ex: 5.99"}),o.jsx(n.Z,{label:"Fornecedor *",name:"fornecedor",value:y.fornecedor,onChange:C,error:w.fornecedor,placeholder:"Ex: Distribuidora Alimentos"}),o.jsx(n.Z,{label:"Peso/Volume por Embalagem (g ou ml) *",name:"pesoEmbalagem",type:"number",min:"0",value:y.pesoEmbalagem,onChange:C,error:w.pesoEmbalagem,placeholder:"Ex: 1000"})]}),(0,o.jsxs)("div",{className:"border-t pt-4",children:[(0,o.jsxs)("div",{className:"flex items-center mb-4",children:[o.jsx("input",{type:"checkbox",id:"mostrarInfoNutricional",checked:b,onChange:()=>x(!b),className:"h-4 w-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),o.jsx("label",{htmlFor:"mostrarInfoNutricional",className:"ml-2 text-sm font-medium text-gray-700",children:"Adicionar informa\xe7\xf5es nutricionais (por 100g/100ml)"})]}),b&&(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx(n.Z,{label:"Calorias (kcal)",name:"infoNutricional.calorias",type:"number",min:"0",value:y.infoNutricional.calorias,onChange:C,error:w["infoNutricional.calorias"]}),o.jsx(n.Z,{label:"Carboidratos (g)",name:"infoNutricional.carboidratos",type:"number",min:"0",step:"0.1",value:y.infoNutricional.carboidratos,onChange:C,error:w["infoNutricional.carboidratos"]}),o.jsx(n.Z,{label:"Prote\xednas (g)",name:"infoNutricional.proteinas",type:"number",min:"0",step:"0.1",value:y.infoNutricional.proteinas,onChange:C,error:w["infoNutricional.proteinas"]}),o.jsx(n.Z,{label:"Gorduras Totais (g)",name:"infoNutricional.gordurasTotais",type:"number",min:"0",step:"0.1",value:y.infoNutricional.gordurasTotais,onChange:C,error:w["infoNutricional.gordurasTotais"]}),o.jsx(n.Z,{label:"Gorduras Saturadas (g)",name:"infoNutricional.gordurasSaturadas",type:"number",min:"0",step:"0.1",value:y.infoNutricional.gordurasSaturadas,onChange:C,error:w["infoNutricional.gordurasSaturadas"]}),o.jsx(n.Z,{label:"Gorduras Trans (g)",name:"infoNutricional.gordurasTrans",type:"number",min:"0",step:"0.1",value:y.infoNutricional.gordurasTrans,onChange:C,error:w["infoNutricional.gordurasTrans"]}),o.jsx(n.Z,{label:"Fibras (g)",name:"infoNutricional.fibras",type:"number",min:"0",step:"0.1",value:y.infoNutricional.fibras,onChange:C,error:w["infoNutricional.fibras"]}),o.jsx(n.Z,{label:"S\xf3dio (mg)",name:"infoNutricional.sodio",type:"number",min:"0",step:"0.1",value:y.infoNutricional.sodio,onChange:C,error:w["infoNutricional.sodio"]})]})]})]}),(0,o.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[o.jsx(c.Z,{type:"button",variant:"outline",onClick:()=>e.push("/produtos"),children:"Cancelar"}),o.jsx(c.Z,{type:"submit",variant:"primary",isLoading:f,children:"Salvar Insumo"})]})]})})]})}},34034:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});var o=a(95344);a(3729);let t=({children:e,variant:r="primary",size:a="md",isLoading:t=!1,fullWidth:i=!1,className:s="",disabled:n,...l})=>{let c=n||t?"opacity-50 cursor-not-allowed":"";return(0,o.jsxs)("button",{className:`inline-flex items-center justify-center rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 ${{primary:"bg-[var(--cor-acao)] text-white hover:brightness-90 focus:ring-[var(--cor-acao)]",secondary:"bg-[var(--cor-secundaria)] text-white hover:brightness-90 focus:ring-[var(--cor-secundaria)]",success:"bg-[var(--cor-sucesso)] text-white hover:brightness-90 focus:ring-[var(--cor-sucesso)]",danger:"bg-[var(--cor-erro)] text-white hover:brightness-90 focus:ring-[var(--cor-erro)]",outline:"bg-white text-[var(--cor-texto-principal)] border border-[var(--cor-borda)] hover:bg-gray-50 focus:ring-[var(--cor-acao)]"}[r]} ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[a]} ${i?"w-full":""} ${c} ${s}`,disabled:n||t,...l,children:[t&&(0,o.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e]})}},10342:(e,r,a)=>{"use strict";a.d(r,{Z:()=>i});var o=a(95344);let t=(0,a(3729).forwardRef)(({label:e,error:r,helperText:a,className:t="",...i},s)=>(0,o.jsxs)("div",{className:"mb-4",children:[e&&o.jsx("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--cor-texto-principal)"},children:e}),o.jsx("input",{ref:s,className:`w-full input ${r?"border-[var(--cor-erro)]":""} ${t}`,...i}),r&&o.jsx("p",{className:"mt-1 text-sm",style:{color:"var(--cor-erro)"},children:r}),a&&!r&&o.jsx("p",{className:"mt-1 text-sm",style:{color:"var(--cor-texto-secundario)"},children:a})]}));t.displayName="Input";let i=t},98649:(e,r,a)=>{"use strict";a.d(r,{Z:()=>i});var o=a(95344);let t=(0,a(3729).forwardRef)(({label:e,error:r,helperText:a,options:t,className:i="",...s},n)=>(0,o.jsxs)("div",{className:"mb-4",children:[e&&o.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),(0,o.jsxs)("select",{ref:n,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 
            ${r?"border-red-500":"border-gray-300"} 
            ${i}`,...s,children:[o.jsx("option",{value:"",children:"Selecione..."}),t.map(e=>o.jsx("option",{value:e.value,children:e.label},e.value))]}),r&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:r}),a&&!r&&o.jsx("p",{className:"mt-1 text-sm text-gray-500",children:a})]}));t.displayName="Select";let i=t},42283:(e,r,a)=>{"use strict";a.d(r,{Z:()=>i});var o=a(95344),t=a(3729);let i=({message:e,onClose:r})=>((0,t.useEffect)(()=>{if(!e)return;let a=setTimeout(r,3e3);return()=>clearTimeout(a)},[e,r]),e)?o.jsx("div",{className:"fixed top-4 right-4 bg-[var(--cor-sucesso)] text-white px-4 py-2 rounded shadow",children:e}):null},6158:(e,r,a)=>{"use strict";a.d(r,{D:()=>n,u:()=>l});var o=a(3729),t=a(94287);let i=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de produtos...");let e=await fetch("/api/categorias",{headers:(0,t.g)()});if(console.log(`📡 Response status: ${e.status}`),!e.ok){let r=await e.text();throw console.error(`❌ Erro na API categorias: ${e.status} - ${r}`),Error(`Erro ao buscar categorias: ${e.status}`)}let r=await e.json();return console.log(`✅ Categorias carregadas: ${r.length}`),r}catch(e){return console.error("❌ Erro ao buscar categorias da API:",e),[]}},s=[{id:"hortifruti",nome:"Hortifruti"},{id:"carnes",nome:"Carnes"},{id:"laticinios",nome:"Latic\xednios"},{id:"graos",nome:"Gr\xe3os e Cereais"},{id:"bebidas",nome:"Bebidas"},{id:"temperos",nome:"Temperos"},{id:"outros",nome:"Outros"}],n=()=>{let[e,r]=(0,o.useState)([]),[a,n]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async()=>{try{n(!0);let e=await i();if(0===e.length){for(let r of s)try{if(!e.find(e=>e.nome===r.nome)){let a=await fetch("/api/categorias",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({nome:r.nome})});if(a.ok){let r=await a.json();e.push(r)}else 409===a.status&&console.log(`Categoria '${r.nome}' j\xe1 existe, pulando...`)}}catch(e){console.error("Erro ao criar categoria padr\xe3o:",e)}e=await i()}console.log("Categorias loaded:",e?.length||0),r(e)}catch(e){console.error("Erro ao carregar categorias:",e),r([])}finally{n(!1)}})()},[]);let l=async a=>{try{let o=await fetch("/api/categorias",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({nome:a})});if(!o.ok)throw Error("Erro ao criar categoria");let i=await o.json(),s=[...e,i];return r(s),i}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},c=async(a,o)=>{try{let i=await fetch(`/api/categorias/${a}`,{method:"PUT",headers:(0,t.g)(),body:JSON.stringify({nome:o})});if(!i.ok)throw Error("Erro ao atualizar categoria");let s=await i.json(),n=e.map(e=>e.id===a?s:e);return r(n),s}catch(e){return console.error("Erro ao atualizar categoria:",e),null}},u=async a=>{try{if(!(await fetch(`/api/categorias/${a}`,{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao deletar categoria");let o=e.filter(e=>e.id!==a);return r(o),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}};return{categorias:e,isLoading:a,adicionarCategoria:l,atualizarCategoria:c,removerCategoria:u,obterCategoriaPorId:r=>e.find(e=>e.id===r)}},l=async e=>{if(!e)return"N\xe3o informado";let r=(await i()).find(r=>r.id===e);return r?r.nome:e}},5175:(e,r,a)=>{"use strict";a.d(r,{x:()=>n});var o=a(3729),t=a(94287);let i=async()=>{try{let e=await fetch("/api/unidades",{headers:(0,t.g)()});if(!e.ok)return s;let r=await e.json(),a=[...s];return r.forEach(e=>{a.find(r=>r.id===e.id)||a.push(e)}),a}catch(e){return console.error("Erro ao buscar unidades da API:",e),s}},s=[{id:"g",nome:"Gramas (g)"},{id:"kg",nome:"Quilogramas (kg)"},{id:"ml",nome:"Mililitros (ml)"},{id:"l",nome:"Litros (l)"},{id:"un",nome:"Unidade"},{id:"cx",nome:"Caixa"},{id:"pct",nome:"Pacote"}],n=()=>{let[e,r]=(0,o.useState)([]),[a,n]=(0,o.useState)(!0);(0,o.useEffect)(()=>{(async()=>{try{n(!0);let e=await i();console.log("Unidades loaded:",e?.length||0),r(e)}catch(e){console.error("Erro ao carregar unidades de medida:",e),r([])}finally{n(!1)}})()},[]);let l=async(a,o)=>{try{if(s.find(e=>e.id===a))throw Error("J\xe1 existe uma unidade padr\xe3o com esta sigla");let i=await fetch("/api/unidades",{method:"POST",headers:(0,t.g)(),body:JSON.stringify({id:a,nome:o})});if(!i.ok)throw Error("Erro ao criar unidade");let n=await i.json(),l=[...e,n];return r(l),n}catch(e){return console.error("Erro ao adicionar unidade:",e),null}},c=async(a,o)=>{try{if(s.find(e=>e.id===a))throw Error("N\xe3o \xe9 poss\xedvel editar unidades padr\xe3o do sistema");let i=await fetch(`/api/unidades/${a}`,{method:"PUT",headers:(0,t.g)(),body:JSON.stringify({nome:o})});if(!i.ok)throw Error("Erro ao atualizar unidade");let n=await i.json(),l=e.map(e=>e.id===a?n:e);return r(l),n}catch(e){return console.error("Erro ao atualizar unidade:",e),null}},u=async a=>{try{if(s.find(e=>e.id===a))throw Error("N\xe3o \xe9 poss\xedvel deletar unidades padr\xe3o do sistema");if(!(await fetch(`/api/unidades/${a}`,{method:"DELETE",headers:(0,t.g)()})).ok)throw Error("Erro ao deletar unidade");let o=e.filter(e=>e.id!==a);return r(o),!0}catch(e){return console.error("Erro ao remover unidade:",e),!1}};return{unidades:e,isLoading:a,adicionarUnidade:l,atualizarUnidade:c,removerUnidade:u,obterUnidadePorId:r=>e.find(e=>e.id===r)}}},50768:(e,r,a)=>{"use strict";a.r(r),a.d(r,{$$typeof:()=>i,__esModule:()=>t,default:()=>s});let o=(0,a(86843).createProxy)(String.raw`/workspaces/SistemaChef/src/app/produtos/novo/page.tsx`),{__esModule:t,$$typeof:i}=o,s=o.default}};var r=require("../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),o=r.X(0,[1638,265,337,2273],()=>a(96950));module.exports=o})();