(()=>{var e={};e.id=2584,e.ids=[2584],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},87928:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l});var t=r(50482),i=r(69108),n=r(62563),o=r.n(n),s=r(68300),d={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>s[e]);r.d(a,d);let l=["",{children:["fichas-tecnicas",{children:["nova",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,90523)),"/workspaces/SistemaChef/src/app/fichas-tecnicas/nova/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,57793)),"/workspaces/SistemaChef/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/workspaces/SistemaChef/src/app/fichas-tecnicas/nova/page.tsx"],u="/fichas-tecnicas/nova/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/fichas-tecnicas/nova/page",pathname:"/fichas-tecnicas/nova",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},13137:(e,a,r)=>{Promise.resolve().then(r.bind(r,55663))},55663:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>f});var t=r(95344),i=r(3729),n=r(8428),o=r(79956),s=r(10342),d=r(98649),l=r(34388),c=r(34034),u=r(34962),p=r(76617),m=r(48806),x=r(5175),h=r(19865),g=r(72522),v=r(42283);function f(){let e=(0,n.useRouter)(),{produtos:a}=(0,m.Ug)(),{unidades:r}=(0,x.x)(),{categorias:f}=(0,p.O)(),[b,j]=(0,i.useState)(!1),[P,q]=(0,i.useState)(""),{isOpen:y,openModal:C,closeModal:N}=(0,g.d)(),[Z,I]=(0,i.useState)({produtoId:"",quantidade:"",unidade:""}),[S,_]=(0,i.useState)({nome:"",descricao:"",categoria:"",ingredientes:[],modoPreparo:"",tempoPreparo:"",rendimentoTotal:"",unidadeRendimento:"",observacoes:""}),k=(e,a,r)=>{if(!e.length||!a||!r.length)return 0;let t=e.reduce((e,a)=>{let t=r.find(e=>e.id===a.produtoId);if(!t)return e;let i=Number(a.quantidade)||0,n=0;return"kg"===a.unidade?n=1e3*i:"g"===a.unidade?n=i:"l"===a.unidade?n=1e3*i:"ml"===a.unidade?n=i:"unidade"===a.unidade&&(n=i*(t.pesoEmbalagem||0)),e+n},0);return"porcoes"===a?Math.floor(t/150):"kg"===a?t/1e3:"g"===a?t:"l"===a?t/1e3:"ml"===a?t:"unidades"===a?Math.floor(t/100):0};(0,i.useEffect)(()=>{if(!S.unidadeRendimento||0===a.length)return;let e=k(S.ingredientes,S.unidadeRendimento,a);_(a=>({...a,rendimentoTotal:e?e.toString():"0"}))},[S.ingredientes,S.unidadeRendimento,a]);let[T,w]=(0,i.useState)({});(0,i.useEffect)(()=>{if(!P)return;let e=setTimeout(()=>q(""),3e3);return()=>clearTimeout(e)},[P]);let R=e=>{let{name:a,value:r}=e.target;_(e=>({...e,[a]:r}))},E=e=>{let{name:r,value:t}=e.target;I(e=>{let i={...e,[r]:t};if("produtoId"===r){let e=a.find(e=>e.id===t);e&&(i.unidade=e.unidadeMedida)}return i})},M=e=>{_(a=>({...a,ingredientes:a.ingredientes.filter((a,r)=>r!==e)}))},A=()=>{let e={};return S.nome||(e.nome="Nome \xe9 obrigat\xf3rio"),S.categoria||(e.categoria="Categoria \xe9 obrigat\xf3ria"),S.modoPreparo||(e.modoPreparo="Modo de preparo \xe9 obrigat\xf3rio"),S.tempoPreparo?(isNaN(Number(S.tempoPreparo))||0>=Number(S.tempoPreparo))&&(e.tempoPreparo="Tempo de preparo deve ser um n\xfamero positivo"):e.tempoPreparo="Tempo de preparo \xe9 obrigat\xf3rio",S.unidadeRendimento||(e.unidadeRendimento="Unidade de rendimento \xe9 obrigat\xf3ria"),0===S.ingredientes.length&&(e.ingredientes="Adicione pelo menos um ingrediente"),w(e),0===Object.keys(e).length},O=async a=>{if(a.preventDefault(),A()){j(!0);try{let a={...S,tempoPreparo:String(S.tempoPreparo),rendimentoTotal:Number(S.rendimentoTotal)};await (0,u.eW)(a)?(q("Ficha t\xe9cnica criada com sucesso!"),setTimeout(()=>{e.push("/fichas-tecnicas")},1500)):q("Erro ao salvar ficha t\xe9cnica")}catch(e){console.error("Erro ao salvar ficha t\xe9cnica:",e),q("Erro ao salvar ficha t\xe9cnica")}finally{j(!1)}}},G=e=>{let r=a.find(a=>a.id===e);return r?r.nome:"Produto n\xe3o encontrado"},$=(e,a)=>{let t=r.find(a=>a.id===e)?.id||e;return`${a} ${t}`};return(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx(v.Z,{message:P,onClose:()=>q("")}),t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Nova Ficha T\xe9cnica"}),t.jsx("form",{onSubmit:O,children:(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx(o.Z,{title:"Informa\xe7\xf5es B\xe1sicas",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsx(s.Z,{label:"Nome da Receita *",name:"nome",value:S.nome,onChange:R,error:T.nome,placeholder:"Ex: Risoto de Cogumelos"}),t.jsx(d.Z,{label:"Categoria *",name:"categoria",value:S.categoria,onChange:R,options:f.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label)),error:T.categoria})]}),t.jsx(l.Z,{label:"Descri\xe7\xe3o",name:"descricao",value:S.descricao,onChange:R,placeholder:"Breve descri\xe7\xe3o da receita",rows:2}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx(s.Z,{label:"Tempo de Preparo (minutos) *",name:"tempoPreparo",type:"number",min:"1",value:S.tempoPreparo,onChange:R,error:T.tempoPreparo,placeholder:"Ex: 45"}),t.jsx(s.Z,{label:"Rendimento Total",name:"rendimentoTotal",type:"number",readOnly:!0,value:S.rendimentoTotal}),t.jsx(d.Z,{label:"Unidade de Rendimento *",name:"unidadeRendimento",value:S.unidadeRendimento,onChange:R,options:u.gZ,error:T.unidadeRendimento})]})]})}),t.jsx(o.Z,{title:"Ingredientes",children:(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-end",children:(0,t.jsxs)(c.Z,{type:"button",variant:"outline",onClick:C,children:[t.jsx("span",{className:"material-icons mr-1 text-sm",children:"add"}),"Adicionar Ingrediente"]})}),T.ingredientes&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:T.ingredientes}),t.jsx(h.ZP,{headers:["Produto","Quantidade","A\xe7\xf5es"],emptyMessage:"Nenhum ingrediente adicionado. Clique em 'Adicionar Ingrediente'.",children:S.ingredientes.map((e,a)=>(0,t.jsxs)(h.SC,{children:[t.jsx(h.pj,{children:G(e.produtoId)}),t.jsx(h.pj,{children:$(e.unidade,e.quantidade)}),t.jsx(h.pj,{children:t.jsx(c.Z,{variant:"outline",size:"sm",onClick:()=>M(a),children:t.jsx("span",{className:"material-icons text-sm text-red-500",children:"delete"})})})]},a))})]})}),t.jsx(o.Z,{title:"Modo de Preparo",children:t.jsx(l.Z,{label:"Instru\xe7\xf5es de Preparo *",name:"modoPreparo",value:S.modoPreparo,onChange:R,error:T.modoPreparo,placeholder:"Descreva passo a passo como preparar a receita",rows:6})}),t.jsx(o.Z,{title:"Observa\xe7\xf5es",children:t.jsx(l.Z,{label:"Observa\xe7\xf5es ou Dicas do Chef",name:"observacoes",value:S.observacoes,onChange:R,placeholder:"Dicas, varia\xe7\xf5es ou informa\xe7\xf5es adicionais sobre a receita",rows:4})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[t.jsx(c.Z,{type:"button",variant:"outline",onClick:()=>e.push("/fichas-tecnicas"),children:"Cancelar"}),t.jsx(c.Z,{type:"submit",variant:"primary",isLoading:b,children:"Salvar Ficha T\xe9cnica"})]})]})}),t.jsx(g.Z,{isOpen:y,onClose:N,title:"Adicionar Ingrediente",footer:(0,t.jsxs)(t.Fragment,{children:[t.jsx(c.Z,{variant:"outline",onClick:N,children:"Cancelar"}),t.jsx(c.Z,{variant:"primary",onClick:()=>{let e={};if(Z.produtoId||(e.produtoId="Selecione um produto"),Z.quantidade?(isNaN(Number(Z.quantidade))||0>=Number(Z.quantidade))&&(e.quantidade="Quantidade deve ser um n\xfamero positivo"):e.quantidade="Quantidade \xe9 obrigat\xf3ria",Z.unidade||(e.unidade="Selecione a unidade"),Object.keys(e).length>0){w(a=>({...a,...e}));return}let a={produtoId:Z.produtoId,quantidade:Number(Z.quantidade),unidade:Z.unidade};_(e=>({...e,ingredientes:[...e.ingredientes,a]})),I({produtoId:"",quantidade:"",unidade:""}),w(e=>{let a={...e};return delete a.produtoId,delete a.quantidade,delete a.unidade,a}),N()},children:"Adicionar"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx(d.Z,{label:"Produto *",name:"produtoId",value:Z.produtoId,onChange:E,error:T.produtoId,options:a.map(e=>({value:e.id,label:`${e.nome} (${e.unidadeMedida})`})).sort((e,a)=>e.label.localeCompare(a.label))}),t.jsx(s.Z,{label:"Quantidade *",name:"quantidade",type:"number",min:"0.1",step:"0.1",value:Z.quantidade,onChange:E,error:T.quantidade,placeholder:"Ex: 250"}),t.jsx(d.Z,{label:"Unidade *",name:"unidade",value:Z.unidade,onChange:E,error:T.unidade,options:r.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label))})]})})]})}},90523:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>n,__esModule:()=>i,default:()=>o});let t=(0,r(86843).createProxy)(String.raw`/workspaces/SistemaChef/src/app/fichas-tecnicas/nova/page.tsx`),{__esModule:i,$$typeof:n}=t,o=t.default}};var a=require("../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[1638,4485,337,4759,5664,3512],()=>r(87928));module.exports=t})();