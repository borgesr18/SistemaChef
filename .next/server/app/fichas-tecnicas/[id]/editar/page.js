(()=>{var e={};e.id=1072,e.ids=[1072],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},51549:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l});var t=r(50482),i=r(69108),n=r(62563),o=r.n(n),d=r(68300),s={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>d[e]);r.d(a,s);let l=["",{children:["fichas-tecnicas",{children:["[id]",{children:["editar",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,23320)),"/workspaces/SistemaChef/src/app/fichas-tecnicas/[id]/editar/page.tsx"]}]},{}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,57793)),"/workspaces/SistemaChef/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/workspaces/SistemaChef/src/app/fichas-tecnicas/[id]/editar/page.tsx"],u="/fichas-tecnicas/[id]/editar/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/fichas-tecnicas/[id]/editar/page",pathname:"/fichas-tecnicas/[id]/editar",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},45642:(e,a,r)=>{Promise.resolve().then(r.bind(r,72035))},72035:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>b});var t=r(95344),i=r(3729),n=r(8428),o=r(79956),d=r(10342),s=r(98649),l=r(34388),c=r(34034),u=r(34962),p=r(76617),m=r(48806),x=r(5175),h=r(19865),g=r(72522),f=r(42283);function b(){let e=(0,n.useParams)(),a=(0,n.useRouter)(),{obterFichaTecnicaPorId:r,atualizarFichaTecnica:b,isLoading:v}=(0,u.vG)(),{produtos:j}=(0,m.U)(),{unidades:P}=(0,x.x)(),{categorias:q}=(0,p.useCategoriasReceita)(),[y,C]=(0,i.useState)(!1),[N,I]=(0,i.useState)(""),R=e.id,S=r(R);(0,i.useEffect)(()=>{v||S||a.push("/fichas-tecnicas")},[v,S,a]);let{isOpen:T,openModal:_,closeModal:Z}=(0,g.d)(),[k,w]=(0,i.useState)({produtoId:"",quantidade:"",unidade:""}),[E,A]=(0,i.useState)({nome:"",descricao:"",categoria:"",ingredientes:[],modoPreparo:"",tempoPreparo:"",rendimentoTotal:"",unidadeRendimento:"",observacoes:""}),[M,G]=(0,i.useState)({});if((0,i.useEffect)(()=>{if(!N)return;let e=setTimeout(()=>I(""),3e3);return()=>clearTimeout(e)},[N]),(0,i.useEffect)(()=>{if(!E.unidadeRendimento)return;let e=(0,u.Gm)(E.ingredientes,E.unidadeRendimento);A(a=>({...a,rendimentoTotal:e?e.toString():"0"}))},[E.ingredientes,E.unidadeRendimento]),(0,i.useEffect)(()=>{!v&&S&&A({nome:S.nome,descricao:S.descricao||"",categoria:S.categoria,ingredientes:S.ingredientes.map(e=>({produtoId:e.produtoId,quantidade:e.quantidade,unidade:e.unidade||j.find(a=>a.id===e.produtoId)?.unidadeMedida||""})),modoPreparo:S.modoPreparo,tempoPreparo:S.tempoPreparo?.toString()||"",rendimentoTotal:S.rendimentoTotal?.toString()||"",unidadeRendimento:S.unidadeRendimento,observacoes:S.observacoes||""})},[v,S]),v)return t.jsx("p",{children:"Carregando..."});if(!S)return null;let $=e=>{let{name:a,value:r}=e.target;A(e=>({...e,[a]:r}))},O=e=>{let{name:a,value:r}=e.target;w(e=>{let t={...e,[a]:r};if("produtoId"===a){let e=j.find(e=>e.id===r);e&&(t.unidade=e.unidadeMedida)}return t})},z=e=>{A(a=>({...a,ingredientes:a.ingredientes.filter((a,r)=>r!==e)}))},D=()=>{let e={};return E.nome||(e.nome="Nome \xe9 obrigat\xf3rio"),E.categoria||(e.categoria="Categoria \xe9 obrigat\xf3ria"),E.modoPreparo||(e.modoPreparo="Modo de preparo \xe9 obrigat\xf3rio"),E.tempoPreparo?(isNaN(Number(E.tempoPreparo))||0>=Number(E.tempoPreparo))&&(e.tempoPreparo="Tempo de preparo deve ser um n\xfamero positivo"):e.tempoPreparo="Tempo de preparo \xe9 obrigat\xf3rio",E.unidadeRendimento||(e.unidadeRendimento="Unidade de rendimento \xe9 obrigat\xf3ria"),0===E.ingredientes.length&&(e.ingredientes="Adicione pelo menos um ingrediente"),G(e),0===Object.keys(e).length},Q=e=>{let a=j.find(a=>a.id===e);return a?a.nome:"Produto n\xe3o encontrado"},U=(e,a)=>{let r=P.find(a=>a.id===e)?.id||e;return`${a} ${r}`};return(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx(f.Z,{message:N,onClose:()=>I("")}),t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Editar Ficha T\xe9cnica"}),t.jsx("form",{onSubmit:e=>{if(e.preventDefault(),D()){C(!0);try{let e={...E,tempoPreparo:Number(E.tempoPreparo),rendimentoTotal:Number(E.rendimentoTotal)};b(R,e),a.push(`/fichas-tecnicas/${R}`)}catch(e){console.error("Erro ao atualizar ficha t\xe9cnica:",e),I("Erro ao atualizar ficha t\xe9cnica")}finally{C(!1)}}},children:(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx(o.Z,{title:"Informa\xe7\xf5es B\xe1sicas",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsx(d.default,{label:"Nome da Receita *",name:"nome",value:E.nome,onChange:$,error:M.nome,placeholder:"Ex: Risoto de Cogumelos"}),t.jsx(s.Z,{label:"Categoria *",name:"categoria",value:E.categoria,onChange:$,options:q.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label)),error:M.categoria})]}),t.jsx(l.Z,{label:"Descri\xe7\xe3o",name:"descricao",value:E.descricao,onChange:$,placeholder:"Breve descri\xe7\xe3o da receita",rows:2}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.jsx(d.default,{label:"Tempo de Preparo (minutos) *",name:"tempoPreparo",type:"number",min:"1",value:E.tempoPreparo,onChange:$,error:M.tempoPreparo,placeholder:"Ex: 45"}),t.jsx(d.default,{label:"Rendimento Total",name:"rendimentoTotal",type:"number",readOnly:!0,value:E.rendimentoTotal}),t.jsx(s.Z,{label:"Unidade de Rendimento *",name:"unidadeRendimento",value:E.unidadeRendimento,onChange:$,options:u.gZ,error:M.unidadeRendimento})]})]})}),t.jsx(o.Z,{title:"Ingredientes",children:(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx("div",{className:"flex justify-end",children:(0,t.jsxs)(c.default,{type:"button",variant:"outline",onClick:_,children:[t.jsx("span",{className:"material-icons mr-1 text-sm",children:"add"}),"Adicionar Ingrediente"]})}),M.ingredientes&&t.jsx("p",{className:"text-sm text-red-500 mt-1",children:M.ingredientes}),t.jsx(h.ZP,{headers:["Produto","Quantidade","A\xe7\xf5es"],emptyMessage:"Nenhum ingrediente adicionado. Clique em 'Adicionar Ingrediente'.",children:E.ingredientes.map((e,a)=>(0,t.jsxs)(h.SC,{children:[t.jsx(h.pj,{children:Q(e.produtoId)}),t.jsx(h.pj,{children:U(e.unidade,e.quantidade)}),t.jsx(h.pj,{children:t.jsx(c.default,{variant:"outline",size:"sm",onClick:()=>z(a),children:t.jsx("span",{className:"material-icons text-sm text-red-500",children:"delete"})})})]},a))})]})}),t.jsx(o.Z,{title:"Modo de Preparo",children:t.jsx(l.Z,{label:"Instru\xe7\xf5es de Preparo *",name:"modoPreparo",value:E.modoPreparo,onChange:$,error:M.modoPreparo,placeholder:"Descreva passo a passo como preparar a receita",rows:6})}),t.jsx(o.Z,{title:"Observa\xe7\xf5es",children:t.jsx(l.Z,{label:"Observa\xe7\xf5es ou Dicas do Chef",name:"observacoes",value:E.observacoes,onChange:$,placeholder:"Dicas, varia\xe7\xf5es ou informa\xe7\xf5es adicionais sobre a receita",rows:4})}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[t.jsx(c.default,{type:"button",variant:"outline",onClick:()=>a.push(`/fichas-tecnicas/${R}`),children:"Cancelar"}),t.jsx(c.default,{type:"submit",variant:"primary",isLoading:y,children:"Atualizar Ficha T\xe9cnica"})]})]})}),t.jsx(g.Z,{isOpen:T,onClose:Z,title:"Adicionar Ingrediente",footer:(0,t.jsxs)(t.Fragment,{children:[t.jsx(c.default,{variant:"outline",onClick:Z,children:"Cancelar"}),t.jsx(c.default,{variant:"primary",onClick:()=>{let e={};if(k.produtoId||(e.produtoId="Selecione um produto"),k.quantidade?(isNaN(Number(k.quantidade))||0>=Number(k.quantidade))&&(e.quantidade="Quantidade deve ser um n\xfamero positivo"):e.quantidade="Quantidade \xe9 obrigat\xf3ria",k.unidade||(e.unidade="Selecione a unidade"),Object.keys(e).length>0){G(a=>({...a,...e}));return}let a={produtoId:k.produtoId,quantidade:Number(k.quantidade),unidade:k.unidade};A(e=>({...e,ingredientes:[...e.ingredientes,a]})),w({produtoId:"",quantidade:"",unidade:""}),G(e=>{let a={...e};return delete a.produtoId,delete a.quantidade,delete a.unidade,a}),Z()},children:"Adicionar"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[t.jsx(s.Z,{label:"Produto *",name:"produtoId",value:k.produtoId,onChange:O,error:M.produtoId,options:j.map(e=>({value:e.id,label:`${e.nome} (${e.unidadeMedida})`})).sort((e,a)=>e.label.localeCompare(a.label))}),t.jsx(d.default,{label:"Quantidade *",name:"quantidade",type:"number",min:"0.1",step:"0.1",value:k.quantidade,onChange:O,error:M.quantidade,placeholder:"Ex: 250"}),t.jsx(s.Z,{label:"Unidade *",name:"unidade",value:k.unidade,onChange:O,error:M.unidade,options:P.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label))})]})})]})}},23320:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>n,__esModule:()=>i,default:()=>o});let t=(0,r(86843).createProxy)(String.raw`/workspaces/SistemaChef/src/app/fichas-tecnicas/[id]/editar/page.tsx`),{__esModule:i,$$typeof:n}=t,o=t.default}};var a=require("../../../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[1638,782,337,6408,5413,6365],()=>r(51549));module.exports=t})();