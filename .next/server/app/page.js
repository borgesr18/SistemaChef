(()=>{var e={};e.id=1931,e.ids=[1931],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},68822:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>o.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>l,routeModule:()=>h,tree:()=>d});var r=a(50482),s=a(69108),i=a(62563),o=a.n(i),c=a(68300),n={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>c[e]);a.d(t,n);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,51136)),"/workspaces/SistemaChef/src/app/page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,75459)),"/workspaces/SistemaChef/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["/workspaces/SistemaChef/src/app/page.tsx"],u="/page",m={require:a,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},39788:(e,t,a)=>{Promise.resolve().then(a.bind(a,91532))},91532:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(95344),s=a(3729),i=a(79956),o=a(62794),c=a(48806),n=a(34962);function d(){let{gerarRelatorioCompleto:e}=(0,o.j)(),{produtos:t}=(0,c.Ug)(),{fichasTecnicas:a}=(0,n.vG)(),[d,l]=(0,s.useState)(null),[u,m]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{m(!0);try{let t=await e();l(t)}catch(e){console.error("Erro ao gerar relat\xf3rio:",e)}finally{m(!1)}})()},[e]);let h=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);return u?(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"text-gray-500",children:"Carregando dados do dashboard..."})})]}):d?(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[r.jsx(i.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-500",children:"Total de Produtos"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:d.totalProdutos})]})}),r.jsx(i.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-500",children:"Total de Fichas T\xe9cnicas"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:d.totalFichasTecnicas})]})}),r.jsx(i.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-500",children:"Custo Total Estimado"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:h(d.custoTotalEstoque)})]})}),r.jsx(i.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-500",children:"Custo M\xe9dio por Ficha"}),r.jsx("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:h(d.custoMedioPorFicha)})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx(i.Z,{title:"Fichas T\xe9cnicas Mais Caras",children:r.jsx("div",{className:"space-y-4",children:d.fichasMaisCustos.length>0?r.jsx("ul",{className:"divide-y divide-gray-200",children:d.fichasMaisCustos.map((e,t)=>(0,r.jsxs)("li",{className:"py-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"bg-blue-100 text-blue-800 font-medium rounded-full w-6 h-6 flex items-center justify-center mr-3",children:t+1}),r.jsx("span",{className:"text-gray-900 font-medium",children:e.nome})]}),r.jsx("span",{className:"text-gray-700 font-medium",children:h(e.custo)})]},e.id))}):r.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})})}),r.jsx(i.Z,{title:"Fichas T\xe9cnicas Mais Econ\xf4micas",children:r.jsx("div",{className:"space-y-4",children:d.fichasMenosCustos.length>0?r.jsx("ul",{className:"divide-y divide-gray-200",children:d.fichasMenosCustos.map((e,t)=>(0,r.jsxs)("li",{className:"py-3 flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("span",{className:"bg-green-100 text-green-800 font-medium rounded-full w-6 h-6 flex items-center justify-center mr-3",children:t+1}),r.jsx("span",{className:"text-gray-900 font-medium",children:e.nome})]}),r.jsx("span",{className:"text-gray-700 font-medium",children:h(e.custo)})]},e.id))}):r.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})})})]}),r.jsx(i.Z,{title:"Ingredientes Mais Utilizados",children:r.jsx("div",{className:"space-y-4",children:d.ingredientesMaisUsados.length>0?r.jsx("ul",{className:"divide-y divide-gray-200",children:d.ingredientesMaisUsados.map(e=>(0,r.jsxs)("li",{className:"py-3 flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-900 font-medium",children:e.nome}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{className:"text-gray-700",children:[e.quantidade," ",e.unidade]}),(0,r.jsxs)("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-full text-xs",children:[e.ocorrencias," ",1===e.ocorrencias?"receita":"receitas"]})]})]},e.id))}):r.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhum ingrediente utilizado"})})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx(i.Z,{title:"Distribui\xe7\xe3o de Categorias de Produtos",children:r.jsx("div",{className:"space-y-4",children:d.distribuicaoCategoriasProdutos.length>0?r.jsx("ul",{className:"divide-y divide-gray-200",children:d.distribuicaoCategoriasProdutos.map(e=>(0,r.jsxs)("li",{className:"py-3 flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-900",children:e.categoria}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-48 bg-gray-200 rounded-full h-2.5 mr-2",children:r.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${e.quantidade/d.totalProdutos*100}%`}})}),r.jsx("span",{className:"text-gray-700",children:e.quantidade})]})]},e.categoria))}):r.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhum produto cadastrado"})})}),r.jsx(i.Z,{title:"Distribui\xe7\xe3o de Categorias de Receitas",children:r.jsx("div",{className:"space-y-4",children:d.distribuicaoCategoriasReceitas.length>0?r.jsx("ul",{className:"divide-y divide-gray-200",children:d.distribuicaoCategoriasReceitas.map(e=>(0,r.jsxs)("li",{className:"py-3 flex justify-between items-center",children:[r.jsx("span",{className:"text-gray-900",children:e.categoria}),(0,r.jsxs)("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-48 bg-gray-200 rounded-full h-2.5 mr-2",children:r.jsx("div",{className:"bg-green-600 h-2.5 rounded-full",style:{width:`${e.quantidade/d.totalFichasTecnicas*100}%`}})}),r.jsx("span",{className:"text-gray-700",children:e.quantidade})]})]},e.categoria))}):r.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhuma ficha t\xe9cnica cadastrada"})})})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"text-gray-500",children:"Erro ao carregar dados do dashboard"})})]})}},6158:(e,t,a)=>{"use strict";a.d(t,{D:()=>c,u:()=>n});var r=a(3729),s=a(94287);let i=async()=>{try{console.log("\uD83D\uDD0D Buscando categorias de produtos...");let e=await fetch("/api/categorias",{headers:(0,s.g)()});if(console.log(`ðŸ“¡ Response status: ${e.status}`),!e.ok){let t=await e.text();throw console.error(`âŒ Erro na API categorias: ${e.status} - ${t}`),Error(`Erro ao buscar categorias: ${e.status}`)}let t=await e.json();return console.log(`âœ… Categorias carregadas: ${t.length}`),t}catch(e){return console.error("âŒ Erro ao buscar categorias da API:",e),[]}},o=[{id:"hortifruti",nome:"Hortifruti"},{id:"carnes",nome:"Carnes"},{id:"laticinios",nome:"Latic\xednios"},{id:"graos",nome:"Gr\xe3os e Cereais"},{id:"bebidas",nome:"Bebidas"},{id:"temperos",nome:"Temperos"},{id:"outros",nome:"Outros"}],c=()=>{let[e,t]=(0,r.useState)([]),[a,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{try{c(!0);let e=await i();if(0===e.length){for(let t of o)try{if(!e.find(e=>e.nome===t.nome)){let a=await fetch("/api/categorias",{method:"POST",headers:(0,s.g)(),body:JSON.stringify({nome:t.nome})});if(a.ok){let t=await a.json();e.push(t)}else 409===a.status&&console.log(`Categoria '${t.nome}' j\xe1 existe, pulando...`)}}catch(e){console.error("Erro ao criar categoria padr\xe3o:",e)}e=await i()}console.log("Categorias loaded:",e?.length||0),t(e)}catch(e){console.error("Erro ao carregar categorias:",e),t([])}finally{c(!1)}})()},[]);let n=async a=>{try{let r=await fetch("/api/categorias",{method:"POST",headers:(0,s.g)(),body:JSON.stringify({nome:a})});if(!r.ok)throw Error("Erro ao criar categoria");let i=await r.json(),o=[...e,i];return t(o),i}catch(e){return console.error("Erro ao adicionar categoria:",e),null}},d=async(a,r)=>{try{let i=await fetch(`/api/categorias/${a}`,{method:"PUT",headers:(0,s.g)(),body:JSON.stringify({nome:r})});if(!i.ok)throw Error("Erro ao atualizar categoria");let o=await i.json(),c=e.map(e=>e.id===a?o:e);return t(c),o}catch(e){return console.error("Erro ao atualizar categoria:",e),null}},l=async a=>{try{if(!(await fetch(`/api/categorias/${a}`,{method:"DELETE",headers:(0,s.g)()})).ok)throw Error("Erro ao deletar categoria");let r=e.filter(e=>e.id!==a);return t(r),!0}catch(e){return console.error("Erro ao remover categoria:",e),!1}};return{categorias:e,isLoading:a,adicionarCategoria:n,atualizarCategoria:d,removerCategoria:l,obterCategoriaPorId:t=>e.find(e=>e.id===t)}},n=async e=>{if(!e)return"N\xe3o informado";let t=(await i()).find(t=>t.id===e);return t?t.nome:e}},34382:(e,t,a)=>{"use strict";a.d(t,{H:()=>c});var r=a(3729),s=a(48806),i=a(94287);let o=async()=>{try{let e=await fetch("/api/estoque",{headers:(0,i.g)()});if(!e.ok)throw Error("Erro ao buscar movimenta\xe7\xf5es");return await e.json()}catch(e){return console.error("Erro ao buscar movimenta\xe7\xf5es da API:",e),[]}},c=()=>{let[e,t]=(0,r.useState)([]),[a,c]=(0,r.useState)(!0),n=async e=>{if(e.preco)try{let t=(await (0,s.k0)()).find(t=>t.id===e.produtoId);if(t){let a=t.pesoEmbalagem||1,r=a>0?(e.preco||t.preco)/a:0,s={...t,preco:e.preco||t.preco,precoUnitario:r,fornecedor:e.fornecedor||t.fornecedor,marca:e.marca||t.marca};await fetch(`/api/produtos/${t.id}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(s)})}}catch(e){console.error("Erro ao atualizar produto:",e)}};(0,r.useEffect)(()=>{(async()=>{c(!0),t((await o()).filter(e=>"Producao"!==e.fornecedor)),c(!1)})()},[]);let d=async a=>{try{let r=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({...a,data:new Date().toISOString(),tipo:"entrada"})});if(!r.ok)throw Error("Erro ao registrar entrada");let s=await r.json(),o=[...e,s];return t(o),await n(s),s}catch(e){return console.error("Erro ao registrar entrada:",e),null}},l=async a=>{try{let r=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({produtoId:a.produtoId,quantidade:-Math.abs(a.quantidade),data:new Date().toISOString(),tipo:"saida"})});if(!r.ok)throw Error("Erro ao registrar sa\xedda");let s=await r.json(),o=[...e,s];return t(o),s}catch(e){return console.error("Erro ao registrar sa\xedda:",e),null}},u=async(a,r)=>{try{let s=await fetch(`/api/estoque/${a}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(r)});if(!s.ok)throw Error("Erro ao atualizar movimenta\xe7\xe3o");let o=await s.json(),c=e.map(e=>e.id===a?o:e);return t(c),"entrada"===o.tipo&&await n(o),o}catch(e){return console.error("Erro ao atualizar movimenta\xe7\xe3o:",e),null}},m=async a=>{try{if(!(await fetch(`/api/estoque/${a}`,{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar movimenta\xe7\xe3o");let r=e.filter(e=>e.id!==a);return t(r),!0}catch(e){return console.error("Erro ao remover movimenta\xe7\xe3o:",e),!1}},h=(0,r.useCallback)(t=>e.filter(e=>e.produtoId===t).reduce((e,t)=>e+t.quantidade,0),[e]);return{movimentacoes:e,isLoading:a,registrarEntrada:d,registrarSaida:l,atualizarMovimentacao:u,removerMovimentacao:m,obterHistoricoPorProduto:t=>e.filter(e=>e.produtoId===t),calcularEstoqueAtual:h}}},62794:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var r=a(3729),s=a(48806),i=a(6158),o=a(34382),c=a(34962);let n=()=>{let{produtos:e}=(0,s.Ug)(),{fichasTecnicas:t}=(0,c.vG)(),{calcularEstoqueAtual:a}=(0,o.H)(),n=(0,r.useCallback)(async()=>{let a=e.length,r=t.length,s=e.reduce((e,t)=>e+t.preco,0),o=t.length>0?t.reduce((e,t)=>e+t.custoTotal,0)/t.length:0,n=[...t].sort((e,t)=>t.custoTotal-e.custoTotal),d=n.slice(0,5).map(e=>({id:e.id,nome:e.nome,custo:e.custoTotal})),l=[...n].reverse().slice(0,5).map(e=>({id:e.id,nome:e.nome,custo:e.custoTotal})),u={};t.forEach(e=>{e.ingredientes.forEach(e=>{u[e.produtoId]||(u[e.produtoId]={quantidade:0,ocorrencias:0}),u[e.produtoId].quantidade+=e.quantidade,u[e.produtoId].ocorrencias+=1})});let m=Object.entries(u).map(([t,a])=>{let r=e.find(e=>e.id===t);return{id:t,nome:r?r.nome:"Produto n\xe3o encontrado",quantidade:a.quantidade,unidade:r?r.unidadeMedida:"",ocorrencias:a.ocorrencias}}).sort((e,t)=>t.ocorrencias-e.ocorrencias).slice(0,10),h={};e.forEach(e=>{let t=e.categoria||"N\xe3o informado";h[t]||(h[t]=0),h[t]+=1});let x=await Promise.all(Object.entries(h).map(async([e,t])=>({categoria:await (0,i.u)(e),quantidade:t}))).then(e=>e.sort((e,t)=>t.quantidade-e.quantidade)),g={};return t.forEach(e=>{let t=e.categoria;g[t]||(g[t]=0),g[t]+=1}),{totalProdutos:a,totalFichasTecnicas:r,custoTotalEstoque:s,custoMedioPorFicha:o,fichasMaisCustos:d,fichasMenosCustos:l,ingredientesMaisUsados:m,distribuicaoCategoriasProdutos:x,distribuicaoCategoriasReceitas:(await Promise.all(Object.entries(g).map(async([e,t])=>({categoria:await (0,c.Q_)(e),quantidade:t})))).sort((e,t)=>t.quantidade-e.quantidade)}},[e,t,a]),d=async()=>{let e=await n();return{custoTotalEstoque:e.custoTotalEstoque,custoMedioPorFicha:e.custoMedioPorFicha,fichasMaisCustos:e.fichasMaisCustos,fichasMenosCustos:e.fichasMenosCustos}},l=async()=>{let e=await n();return{ingredientesMaisUsados:e.ingredientesMaisUsados,distribuicaoCategoriasProdutos:e.distribuicaoCategoriasProdutos}},u=async()=>{let e=await n();return{totalFichasTecnicas:e.totalFichasTecnicas,distribuicaoCategoriasReceitas:e.distribuicaoCategoriasReceitas}};return{gerarRelatorioCompleto:n,gerarRelatorioCustos:d,gerarRelatorioIngredientes:l,gerarRelatorioReceitas:u,gerarRelatorioEstoque:()=>{let t=e.map(e=>{let t=a(e.id);return{id:e.id,nome:e.nome,quantidade:t,preco:e.preco,valorTotal:t*e.preco}}),r=t.reduce((e,t)=>e+t.valorTotal,0);return{itens:t,valorTotalEstoque:r}}}}},51136:(e,t,a)=>{"use strict";a.r(t),a.d(t,{$$typeof:()=>i,__esModule:()=>s,default:()=>o});let r=(0,a(86843).createProxy)(String.raw`/workspaces/SistemaChef/src/app/page.tsx`),{__esModule:s,$$typeof:i}=r,o=r.default}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[1638,265,337,2273],()=>a(68822));module.exports=r})();