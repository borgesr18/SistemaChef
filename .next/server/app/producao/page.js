(()=>{var e={};e.id=879,e.ids=[879],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},87340:(e,a,r)=>{"use strict";r.r(a),r.d(a,{GlobalError:()=>s.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>l});var t=r(50482),o=r(69108),i=r(62563),s=r.n(i),d=r(68300),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);r.d(a,n);let l=["",{children:["producao",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,29123)),"/workspaces/SistemaChef/src/app/producao/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,57793)),"/workspaces/SistemaChef/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/workspaces/SistemaChef/src/app/producao/page.tsx"],u="/producao/page",p={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/producao/page",pathname:"/producao",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},64114:(e,a,r)=>{Promise.resolve().then(r.bind(r,33175))},33175:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>g});var t=r(95344),o=r(3729),i=r(79956),s=r(10342),d=r(98649),n=r(34034),l=r(19865),c=r(72522),u=r(34962),p=r(48806),m=r(34382),h=r(15688),x=r(67369);function g(){let{fichasTecnicas:e}=(0,u.vG)(),{produtos:a}=(0,p.Ug)(),{registrarSaida:r}=(0,m.H)(),{registrarEntrada:g}=(0,h.u)(),{producoes:f,registrarProducao:v,atualizarProducao:y,removerProducao:b}=(0,x.G)(),[j,w]=(0,o.useState)({fichaId:"",quantidade:"",unidadeQtd:"kg",pesoUnitario:"",unidadePeso:"g",data:new Date().toISOString().split("T")[0],validade:""}),[N,E]=(0,o.useState)({}),[P,q]=(0,o.useState)(null),[k,S]=(0,o.useState)(null),{isOpen:C,openModal:I,closeModal:T}=(0,c.d)(),U=e=>e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),z=e=>{let{name:a,value:r}=e.target;w(e=>({...e,[a]:r}))},Z=()=>{let e={};return j.fichaId||(e.fichaId="Ficha \xe9 obrigat\xf3ria"),(!j.quantidade||isNaN(Number(j.quantidade)))&&(e.quantidade="Qtd inv\xe1lida"),(!j.pesoUnitario||isNaN(Number(j.pesoUnitario)))&&(e.pesoUnitario="Peso inv\xe1lido"),j.data||(e.data="Data obrigat\xf3ria"),j.validade||(e.validade="Validade obrigat\xf3ria"),E(e),0===Object.keys(e).length},$=e=>{q({...e}),I()};(0,o.useEffect)(()=>{if(!P)return;let a=e.find(e=>e.id===P.fichaId);if(!a)return;let r=(0,u.zP)(P.quantidadeTotal,P.unidadeQuantidade,"g"),t=(0,u.zP)(a.rendimentoTotal,a.unidadeRendimento,"g"),o=Math.round(r/(0,u.zP)(P.pesoUnitario,P.unidadePeso,"g")),i=a.custoTotal*(r/t),s=o?i/o:0;q(e=>e&&(e.unidadesGeradas!==o||e.custoTotal!==i||e.custoUnitario!==s)?{...e,unidadesGeradas:o,custoTotal:i,custoUnitario:s}:e)},[P?.quantidadeTotal,P?.unidadeQuantidade,P?.pesoUnitario,P?.unidadePeso,P?.fichaId,e]);let O=e=>e?new Date(e+"T00:00:00").toLocaleDateString():"";return(0,t.jsxs)("div",{className:"space-y-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Produ\xe7\xe3o"}),t.jsx(i.Z,{children:(0,t.jsxs)("form",{onSubmit:t=>{if(t.preventDefault(),!Z())return;let o=e.find(e=>e.id===j.fichaId);if(!o)return;let i=(0,u.zP)(Number(j.quantidade),j.unidadeQtd,"g"),s=i/(0,u.zP)(o.rendimentoTotal,o.unidadeRendimento,"g");o.ingredientes.forEach(e=>{let t=a.find(a=>a.id===e.produtoId);if(!t)return;let o=(0,u.zP)(e.quantidade*s,e.unidade,t.unidadeMedida);r({produtoId:t.id,quantidade:o})});let d=Math.round(i/(0,u.zP)(Number(j.pesoUnitario),j.unidadePeso,"g")),n=o.custoTotal*s,l=n/d;g({fichaId:j.fichaId,quantidade:d,validade:j.validade}),v({fichaId:j.fichaId,quantidadeTotal:Number(j.quantidade),unidadeQuantidade:j.unidadeQtd,pesoUnitario:Number(j.pesoUnitario),unidadePeso:j.unidadePeso,unidadesGeradas:d,custoTotal:n,custoUnitario:l,validade:j.validade,data:j.data}),w({fichaId:"",quantidade:"",unidadeQtd:"kg",pesoUnitario:"",unidadePeso:"g",data:new Date().toISOString().split("T")[0],validade:""})},className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[t.jsx(d.Z,{label:"Ficha T\xe9cnica *",name:"fichaId",value:j.fichaId,onChange:z,options:e.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label)),error:N.fichaId}),t.jsx(s.Z,{label:"Quantidade *",name:"quantidade",value:j.quantidade,onChange:z,error:N.quantidade}),t.jsx(d.Z,{label:"Unidade",name:"unidadeQtd",value:j.unidadeQtd,onChange:z,options:[{value:"g",label:"g"},{value:"kg",label:"kg"}]}),t.jsx(s.Z,{label:"Peso por unidade *",name:"pesoUnitario",value:j.pesoUnitario,onChange:z,error:N.pesoUnitario}),t.jsx(d.Z,{label:"Unidade",name:"unidadePeso",value:j.unidadePeso,onChange:z,options:[{value:"g",label:"g"},{value:"kg",label:"kg"}]}),t.jsx(s.Z,{label:"Data *",type:"date",name:"data",value:j.data,onChange:z,error:N.data}),t.jsx(s.Z,{label:"Validade *",type:"date",name:"validade",value:j.validade,onChange:z,error:N.validade}),t.jsx("div",{className:"md:col-span-5 flex justify-end",children:t.jsx(n.Z,{type:"submit",variant:"primary",children:"Registrar Produ\xe7\xe3o"})})]})}),t.jsx(i.Z,{title:"Hist\xf3rico de Produ\xe7\xf5es",children:t.jsx(l.ZP,{headers:["Data","Validade","Ficha","Qtd.","Peso/Unid.","Unid.","Custo","Custo/Unid.","A\xe7\xf5es"],emptyMessage:"Nenhuma produ\xe7\xe3o registrada",className:"text-sm",children:f.map(a=>{let r=e.find(e=>e.id===a.fichaId);return(0,t.jsxs)(l.SC,{children:[t.jsx(l.pj,{compact:!0,children:O(a.data)}),t.jsx(l.pj,{compact:!0,children:O(a.validade)}),t.jsx(l.pj,{compact:!0,children:r?.nome||"Ficha removida"}),(0,t.jsxs)(l.pj,{compact:!0,children:[a.quantidadeTotal,a.unidadeQuantidade]}),(0,t.jsxs)(l.pj,{compact:!0,children:[a.pesoUnitario,a.unidadePeso]}),t.jsx(l.pj,{compact:!0,children:a.unidadesGeradas}),t.jsx(l.pj,{compact:!0,children:U(a.custoTotal)}),t.jsx(l.pj,{compact:!0,children:U(a.custoUnitario)}),(0,t.jsxs)(l.pj,{className:"relative text-right",children:[t.jsx("button",{className:"p-1 rounded hover:bg-gray-100",onClick:()=>S(k===a.id?null:a.id),children:t.jsx("span",{className:"material-icons text-gray-600",children:"more_vert"})}),k===a.id&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-32 bg-white border rounded shadow z-10",children:[(0,t.jsxs)("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-50 flex items-center",onClick:()=>{S(null),$(a)},children:[t.jsx("span",{className:"material-icons mr-1 text-black text-sm",children:"edit"}),"Editar"]}),(0,t.jsxs)("button",{className:"block w-full text-left px-3 py-2 hover:bg-gray-50 flex items-center text-red-600",onClick:()=>{S(null),b(a.id)},children:[t.jsx("span",{className:"material-icons mr-1 text-black text-sm",children:"delete"}),"Excluir"]})]})]})]},a.id)})})}),t.jsx(c.Z,{isOpen:C,onClose:T,title:"Editar Produ\xe7\xe3o",size:"xl",children:P&&(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),P&&(y(P.id,{fichaId:P.fichaId,quantidadeTotal:Number(P.quantidadeTotal),unidadeQuantidade:P.unidadeQuantidade,pesoUnitario:Number(P.pesoUnitario),unidadePeso:P.unidadePeso,unidadesGeradas:Number(P.unidadesGeradas),custoTotal:P.custoTotal,custoUnitario:P.custoUnitario,validade:P.validade,data:P.data}),T())},className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[t.jsx(d.Z,{label:"Ficha T\xe9cnica",name:"fichaId",value:P.fichaId,onChange:e=>q({...P,fichaId:e.target.value}),options:e.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label))}),t.jsx(s.Z,{label:"Quantidade",name:"quantidadeTotal",value:String(P.quantidadeTotal),onChange:e=>q({...P,quantidadeTotal:Number(e.target.value)})}),t.jsx(d.Z,{label:"Unidade",name:"unidadeQuantidade",value:P.unidadeQuantidade,onChange:e=>q({...P,unidadeQuantidade:e.target.value}),options:[{value:"g",label:"g"},{value:"kg",label:"kg"}]}),t.jsx(s.Z,{label:"Peso por unidade",name:"pesoUnitario",value:String(P.pesoUnitario),onChange:e=>q({...P,pesoUnitario:Number(e.target.value)})}),t.jsx(d.Z,{label:"Unidade",name:"unidadePeso",value:P.unidadePeso,onChange:e=>q({...P,unidadePeso:e.target.value}),options:[{value:"g",label:"g"},{value:"kg",label:"kg"}]}),t.jsx(s.Z,{label:"Data",type:"date",name:"data",value:P.data,onChange:e=>q({...P,data:e.target.value})}),t.jsx(s.Z,{label:"Validade",type:"date",name:"validade",value:P.validade,onChange:e=>q({...P,validade:e.target.value})}),(0,t.jsxs)("div",{className:"md:col-span-6 flex justify-end space-x-2",children:[t.jsx(n.Z,{type:"button",variant:"secondary",onClick:T,children:"Cancelar"}),t.jsx(n.Z,{type:"submit",variant:"primary",children:"Salvar"})]})]})})]})}},34034:(e,a,r)=>{"use strict";r.d(a,{Z:()=>o});var t=r(95344);r(3729);let o=({children:e,variant:a="primary",size:r="md",isLoading:o=!1,fullWidth:i=!1,className:s="",disabled:d,...n})=>{let l=d||o?"opacity-50 cursor-not-allowed":"";return(0,t.jsxs)("button",{className:`inline-flex items-center justify-center rounded-md font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 ${{primary:"bg-[var(--cor-acao)] text-white hover:brightness-90 focus:ring-[var(--cor-acao)]",secondary:"bg-[var(--cor-secundaria)] text-white hover:brightness-90 focus:ring-[var(--cor-secundaria)]",success:"bg-[var(--cor-sucesso)] text-white hover:brightness-90 focus:ring-[var(--cor-sucesso)]",danger:"bg-[var(--cor-erro)] text-white hover:brightness-90 focus:ring-[var(--cor-erro)]",outline:"bg-white text-[var(--cor-texto-principal)] border border-[var(--cor-borda)] hover:bg-gray-50 focus:ring-[var(--cor-acao)]"}[a]} ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"}[r]} ${i?"w-full":""} ${l} ${s}`,disabled:d||o,...n,children:[o&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),e]})}},10342:(e,a,r)=>{"use strict";r.d(a,{Z:()=>i});var t=r(95344);let o=(0,r(3729).forwardRef)(({label:e,error:a,helperText:r,className:o="",...i},s)=>(0,t.jsxs)("div",{className:"mb-4",children:[e&&t.jsx("label",{className:"block text-sm font-medium mb-1",style:{color:"var(--cor-texto-principal)"},children:e}),t.jsx("input",{ref:s,className:`w-full input ${a?"border-[var(--cor-erro)]":""} ${o}`,...i}),a&&t.jsx("p",{className:"mt-1 text-sm",style:{color:"var(--cor-erro)"},children:a}),r&&!a&&t.jsx("p",{className:"mt-1 text-sm",style:{color:"var(--cor-texto-secundario)"},children:r})]}));o.displayName="Input";let i=o},72522:(e,a,r)=>{"use strict";r.d(a,{Z:()=>s,d:()=>i});var t=r(95344),o=r(3729);let i=(e=!1)=>{let[a,r]=(0,o.useState)(e);return{isOpen:a,openModal:()=>r(!0),closeModal:()=>r(!1),toggleModal:()=>r(!a)}},s=({isOpen:e,onClose:a,title:r,children:i,footer:s,size:d="md"})=>{let[n,l]=(0,o.useState)(!1);return((0,o.useEffect)(()=>(e?(l(!0),document.body.style.overflow="hidden"):(setTimeout(()=>{l(!1)},200),document.body.style.overflow="auto"),()=>{document.body.style.overflow="auto"}),[e]),n||e)?(0,t.jsxs)("div",{className:`fixed inset-0 z-50 flex items-center justify-center p-4 ${e?"opacity-100":"opacity-0"} transition-opacity duration-200`,children:[t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:a}),(0,t.jsxs)("div",{className:`bg-white rounded-lg shadow-xl w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[d]} z-10 ${e?"translate-y-0":"translate-y-4"} transition-transform duration-200`,children:[(0,t.jsxs)("div",{className:"flex justify-between items-center px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:[t.jsx("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:r}),(0,t.jsxs)("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:a,children:[t.jsx("span",{className:"sr-only",children:"Fechar"}),t.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})]}),t.jsx("div",{className:"px-6 py-4",children:i}),s&&t.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-end space-x-3",style:{borderColor:"var(--cor-borda)"},children:s})]})]}):null}},98649:(e,a,r)=>{"use strict";r.d(a,{Z:()=>i});var t=r(95344);let o=(0,r(3729).forwardRef)(({label:e,error:a,helperText:r,options:o,className:i="",...s},d)=>(0,t.jsxs)("div",{className:"mb-4",children:[e&&t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),(0,t.jsxs)("select",{ref:d,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 
            ${a?"border-red-500":"border-gray-300"} 
            ${i}`,...s,children:[t.jsx("option",{value:"",children:"Selecione..."}),o.map(e=>t.jsx("option",{value:e.value,children:e.label},e.value))]}),a&&t.jsx("p",{className:"mt-1 text-sm text-red-600",children:a}),r&&!a&&t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]}));o.displayName="Select";let i=o},19865:(e,a,r)=>{"use strict";r.d(a,{SC:()=>s,ZP:()=>n,pj:()=>d});var t=r(95344),o=r(3729),i=r.n(o);let s=({children:e,className:a="",...r})=>t.jsx("tr",{className:`odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ${a}`,...r,children:e}),d=({children:e,className:a="",compact:r=!1})=>t.jsx("td",{className:`${r?"px-2 py-2":"px-6 py-4"} text-sm ${a}`,style:{color:"var(--cor-texto-secundario)"},children:e}),n=({headers:e,children:a,className:r="",emptyMessage:o="Nenhum dado encontrado",isLoading:s=!1})=>t.jsx("div",{className:`w-full overflow-x-hidden rounded-lg border ${r}`,style:{borderColor:"var(--cor-borda)"},children:(0,t.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[t.jsx("thead",{className:"bg-gray-100",children:t.jsx("tr",{children:e.map((e,a)=>t.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},a))})}),t.jsx("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:s?t.jsx("tr",{children:t.jsx("td",{colSpan:e.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,t.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[t.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),t.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),t.jsx("span",{className:"ml-2",children:"Carregando..."})]})})}):i().Children.count(a)>0?a:t.jsx("tr",{children:t.jsx("td",{colSpan:e.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:o})})})]})})},15688:(e,a,r)=>{"use strict";r.d(a,{u:()=>s});var t=r(3729),o=r(94287);let i=async()=>{try{let e=await fetch("/api/estoque-producao",{headers:(0,o.g)()});if(!e.ok)throw Error("Erro ao buscar movimenta\xe7\xf5es de produ\xe7\xe3o");return await e.json()}catch(e){return console.error("Erro ao buscar movimenta\xe7\xf5es de produ\xe7\xe3o da API:",e),[]}},s=()=>{let[e,a]=(0,t.useState)([]),[r,s]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(async()=>{s(!0),a(await i()),s(!1)})()},[]);let d=async r=>{try{let t=await fetch("/api/estoque-producao",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({...r,data:new Date().toISOString(),tipo:"entrada"})});if(!t.ok)throw Error("Erro ao registrar entrada de produ\xe7\xe3o");let i=await t.json(),s=[...e,i];return a(s),i}catch(e){return console.error("Erro ao registrar entrada de produ\xe7\xe3o:",e),null}},n=async r=>{try{let t=await fetch("/api/estoque-producao",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({fichaId:r.fichaId,quantidade:-Math.abs(r.quantidade),data:new Date().toISOString(),tipo:"saida"})});if(!t.ok)throw Error("Erro ao registrar sa\xedda de produ\xe7\xe3o");let i=await t.json(),s=[...e,i];return a(s),i}catch(e){return console.error("Erro ao registrar sa\xedda de produ\xe7\xe3o:",e),null}},l=async(r,t)=>{try{let i=await fetch(`/api/estoque-producao/${r}`,{method:"PUT",headers:(0,o.g)(),body:JSON.stringify(t)});if(!i.ok)throw Error("Erro ao atualizar movimenta\xe7\xe3o de produ\xe7\xe3o");let s=await i.json(),d=e.map(e=>e.id===r?s:e);return a(d),s}catch(e){return console.error("Erro ao atualizar movimenta\xe7\xe3o de produ\xe7\xe3o:",e),null}},c=async r=>{try{if(!(await fetch(`/api/estoque-producao/${r}`,{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar movimenta\xe7\xe3o de produ\xe7\xe3o");let t=e.filter(e=>e.id!==r);return a(t),!0}catch(e){return console.error("Erro ao remover movimenta\xe7\xe3o de produ\xe7\xe3o:",e),!1}};return{movimentacoes:e,isLoading:r,registrarEntrada:d,registrarSaida:n,calcularEstoqueAtual:a=>e.filter(e=>e.fichaId===a).reduce((e,a)=>e+a.quantidade,0),atualizarMovimentacao:l,removerMovimentacao:c}}},34382:(e,a,r)=>{"use strict";r.d(a,{H:()=>d});var t=r(3729),o=r(48806),i=r(94287);let s=async()=>{try{let e=await fetch("/api/estoque",{headers:(0,i.g)()});if(!e.ok)throw Error("Erro ao buscar movimenta\xe7\xf5es");return await e.json()}catch(e){return console.error("Erro ao buscar movimenta\xe7\xf5es da API:",e),[]}},d=()=>{let[e,a]=(0,t.useState)([]),[r,d]=(0,t.useState)(!0),n=async e=>{if(e.preco)try{let a=(await (0,o.k0)()).find(a=>a.id===e.produtoId);if(a){let r=a.pesoEmbalagem||1,t=r>0?(e.preco||a.preco)/r:0,o={...a,preco:e.preco||a.preco,precoUnitario:t,fornecedor:e.fornecedor||a.fornecedor,marca:e.marca||a.marca};await fetch(`/api/produtos/${a.id}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(o)})}}catch(e){console.error("Erro ao atualizar produto:",e)}};(0,t.useEffect)(()=>{(async()=>{d(!0),a((await s()).filter(e=>"Producao"!==e.fornecedor)),d(!1)})()},[]);let l=async r=>{try{let t=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({...r,data:new Date().toISOString(),tipo:"entrada"})});if(!t.ok)throw Error("Erro ao registrar entrada");let o=await t.json(),s=[...e,o];return a(s),await n(o),o}catch(e){return console.error("Erro ao registrar entrada:",e),null}},c=async r=>{try{let t=await fetch("/api/estoque",{method:"POST",headers:(0,i.g)(),body:JSON.stringify({produtoId:r.produtoId,quantidade:-Math.abs(r.quantidade),data:new Date().toISOString(),tipo:"saida"})});if(!t.ok)throw Error("Erro ao registrar sa\xedda");let o=await t.json(),s=[...e,o];return a(s),o}catch(e){return console.error("Erro ao registrar sa\xedda:",e),null}},u=async(r,t)=>{try{let o=await fetch(`/api/estoque/${r}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(t)});if(!o.ok)throw Error("Erro ao atualizar movimenta\xe7\xe3o");let s=await o.json(),d=e.map(e=>e.id===r?s:e);return a(d),"entrada"===s.tipo&&await n(s),s}catch(e){return console.error("Erro ao atualizar movimenta\xe7\xe3o:",e),null}},p=async r=>{try{if(!(await fetch(`/api/estoque/${r}`,{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar movimenta\xe7\xe3o");let t=e.filter(e=>e.id!==r);return a(t),!0}catch(e){return console.error("Erro ao remover movimenta\xe7\xe3o:",e),!1}},m=(0,t.useCallback)(a=>e.filter(e=>e.produtoId===a).reduce((e,a)=>e+a.quantidade,0),[e]);return{movimentacoes:e,isLoading:r,registrarEntrada:l,registrarSaida:c,atualizarMovimentacao:u,removerMovimentacao:p,obterHistoricoPorProduto:a=>e.filter(e=>e.produtoId===a),calcularEstoqueAtual:m}}},67369:(e,a,r)=>{"use strict";r.d(a,{G:()=>l});var t=r(3729),o=r(34962),i=r(94287);let s=async()=>{try{let e=await fetch("/api/producao",{headers:(0,i.g)()});if(!e.ok)throw Error("Erro ao buscar produ\xe7\xf5es");return(await e.json()).map(e=>({custoTotal:0,custoUnitario:0,validade:"",...e}))}catch(e){return console.error("Erro ao buscar produ\xe7\xf5es da API:",e),[]}},d=async(e,a)=>e.map(e=>n(e,a)),n=(e,a)=>{let r=a.find(a=>a.id===e.fichaId);if(!r)return e;let t=(0,o.zP)(e.quantidadeTotal,e.unidadeQuantidade,"g"),i=(0,o.zP)(r.rendimentoTotal,r.unidadeRendimento,"g"),s=(0,o.zP)(e.pesoUnitario,e.unidadePeso,"g"),d=s?Math.round(t/s):e.unidadesGeradas,n=r.custoTotal*(i?t/i:0);return{...e,unidadesGeradas:d,custoTotal:n,custoUnitario:d?n/d:0}},l=()=>{let{fichasTecnicas:e}=(0,o.vG)(),[a,r]=(0,t.useState)([]);(0,t.useEffect)(()=>{(async()=>{let a=await s(),t=e.length?e:await (0,o.lB)();r(await d(a,t))})()},[]),(0,t.useEffect)(()=>{(async()=>{a.length&&r(await d(a,e))})()},[e]);let n=async e=>{try{let t=await fetch("/api/producao",{method:"POST",headers:(0,i.g)(),body:JSON.stringify(e)});if(!t.ok)throw Error("Erro ao registrar produ\xe7\xe3o");let o=await t.json(),s=[...a,o];return r(s),o}catch(e){return console.error("Erro ao registrar produ\xe7\xe3o:",e),null}},l=async(e,t)=>{try{let o=await fetch(`/api/producao/${e}`,{method:"PUT",headers:(0,i.g)(),body:JSON.stringify(t)});if(!o.ok)throw Error("Erro ao atualizar produ\xe7\xe3o");let s=await o.json(),d=a.map(a=>a.id===e?s:a);return r(d),s}catch(e){return console.error("Erro ao atualizar produ\xe7\xe3o:",e),null}},c=async e=>{try{if(!(await fetch(`/api/producao/${e}`,{method:"DELETE",headers:(0,i.g)()})).ok)throw Error("Erro ao deletar produ\xe7\xe3o");let t=a.filter(a=>a.id!==e);return r(t),!0}catch(e){return console.error("Erro ao remover produ\xe7\xe3o:",e),!1}};return{producoes:a,registrarProducao:n,atualizarProducao:l,removerProducao:c}}},29123:(e,a,r)=>{"use strict";r.r(a),r.d(a,{$$typeof:()=>i,__esModule:()=>o,default:()=>s});let t=(0,r(86843).createProxy)(String.raw`/workspaces/SistemaChef/src/app/producao/page.tsx`),{__esModule:o,$$typeof:i}=t,s=t.default}};var a=require("../../webpack-runtime.js");a.C(e);var r=e=>a(a.s=e),t=a.X(0,[1638,4485,337,4759,5664],()=>r(87340));module.exports=t})();