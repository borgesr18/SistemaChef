(()=>{var e={};e.id=7151,e.ids=[7151],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},71017:e=>{"use strict";e.exports=require("path")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},59796:e=>{"use strict";e.exports=require("zlib")},55356:(e,a,t)=>{"use strict";t.r(a),t.d(a,{GlobalError:()=>s.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>l,routeModule:()=>h,tree:()=>c});var r=t(50482),o=t(69108),i=t(62563),s=t.n(i),d=t(68300),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);t.d(a,n);let c=["",{children:["estoque-producao",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,82389)),"/workspaces/SistemaChef/src/app/estoque-producao/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,57793)),"/workspaces/SistemaChef/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,73881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["/workspaces/SistemaChef/src/app/estoque-producao/page.tsx"],u="/estoque-producao/page",p={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:o.x.APP_PAGE,page:"/estoque-producao/page",pathname:"/estoque-producao",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},63909:(e,a,t)=>{Promise.resolve().then(t.bind(t,2875))},2875:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>p});var r=t(95344),o=t(3729),i=t(79956),s=t(19865),d=t(34034),n=t(98649),c=t(10342),l=t(15688),u=t(34962);function p(){let{movimentacoes:e,calcularEstoqueAtual:a,registrarEntrada:t,registrarSaida:p}=(0,l.u)(),{fichasTecnicas:h}=(0,u.vG)(),[m,f]=(0,o.useState)({fichaId:"",tipo:"saida",quantidade:"",validade:""}),[x,g]=(0,o.useState)(""),v=e=>{let{name:a,value:t}=e.target;f(e=>({...e,[a]:t}))};return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Estoque de Produ\xe7\xe3o"}),r.jsx(i.Z,{children:(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!m.fichaId||!m.quantidade||isNaN(Number(m.quantidade))){g("Dados inv\xe1lidos");return}"entrada"===m.tipo?t({fichaId:m.fichaId,quantidade:Number(m.quantidade),validade:m.validade}):p({fichaId:m.fichaId,quantidade:Number(m.quantidade)}),f({fichaId:"",tipo:"saida",quantidade:"",validade:""}),g("")},className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(n.Z,{label:"Ficha T\xe9cnica *",name:"fichaId",value:m.fichaId,onChange:v,options:h.map(e=>({value:e.id,label:e.nome})).sort((e,a)=>e.label.localeCompare(a.label)),error:x&&!m.fichaId?x:void 0}),r.jsx(n.Z,{label:"Tipo",name:"tipo",value:m.tipo,onChange:v,options:[{value:"entrada",label:"Entrada"},{value:"saida",label:"Sa\xedda"}]}),r.jsx(c.default,{label:"Quantidade *",name:"quantidade",value:m.quantidade,onChange:v,error:x&&!m.quantidade?x:void 0}),"entrada"===m.tipo&&r.jsx(c.default,{label:"Validade",type:"date",name:"validade",value:m.validade,onChange:v}),r.jsx("div",{className:"flex items-end",children:r.jsx(d.default,{type:"submit",variant:"primary",children:"Registrar"})})]})}),r.jsx(i.Z,{title:"Hist\xf3rico de Produ\xe7\xe3o",children:r.jsx(s.ZP,{headers:["Ficha T\xe9cnica","Quantidade","Data","Validade","Estoque Total"],emptyMessage:"Nenhuma movimenta\xe7\xe3o",children:(()=>{let a={};return e.slice().sort((e,a)=>e.data.localeCompare(a.data)).map(e=>{a[e.fichaId]=(a[e.fichaId]||0)+e.quantidade;let t=a[e.fichaId],o=h.find(a=>a.id===e.fichaId);return(0,r.jsxs)(s.SC,{children:[r.jsx(s.pj,{children:o?.nome||"Ficha removida"}),r.jsx(s.pj,{children:e.quantidade}),r.jsx(s.pj,{children:new Date(e.data).toLocaleDateString()}),r.jsx(s.pj,{children:e.validade?new Date(e.validade).toLocaleDateString():"-"}),r.jsx(s.pj,{children:t})]},e.id)})})()})}),r.jsx(i.Z,{title:"Estoque Atual",children:r.jsx(s.ZP,{headers:["Ficha T\xe9cnica","Quantidade"],emptyMessage:"Nenhum produto produzido",children:h.map(e=>{let t=a(e.id);return 0===t?null:(0,r.jsxs)(s.SC,{children:[r.jsx(s.pj,{children:e.nome}),r.jsx(s.pj,{children:t})]},e.id)})})})]})}},79956:(e,a,t)=>{"use strict";t.d(a,{Z:()=>o});var r=t(95344);t(3729);let o=({children:e,title:a,className:t="",footer:o})=>(0,r.jsxs)("div",{className:`card overflow-hidden ${t}`,children:[a&&r.jsx("div",{className:"px-6 py-4 border-b",style:{borderColor:"var(--cor-borda)"},children:r.jsx("h3",{className:"text-lg font-medium",style:{color:"var(--cor-texto-principal)"},children:a})}),r.jsx("div",{className:"p-6",children:e}),o&&r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t",style:{borderColor:"var(--cor-borda)"},children:o})]})},10342:(e,a,t)=>{"use strict";t.d(a,{I:()=>s});var r=t(95344),o=t(3729),i=t(11453);let s=o.forwardRef(({className:e,type:a,...t},o)=>r.jsx("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:o,...t}));s.displayName="Input"},98649:(e,a,t)=>{"use strict";t.d(a,{Z:()=>i});var r=t(95344);let o=(0,t(3729).forwardRef)(({label:e,error:a,helperText:t,options:o,className:i="",...s},d)=>(0,r.jsxs)("div",{className:"mb-4",children:[e&&r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),(0,r.jsxs)("select",{ref:d,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 
            ${a?"border-red-500":"border-gray-300"} 
            ${i}`,...s,children:[r.jsx("option",{value:"",children:"Selecione..."}),o.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))]}),a&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:a}),t&&!a&&r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:t})]}));o.displayName="Select";let i=o},19865:(e,a,t)=>{"use strict";t.d(a,{SC:()=>s,ZP:()=>n,pj:()=>d});var r=t(95344),o=t(3729),i=t.n(o);let s=({children:e,className:a="",...t})=>r.jsx("tr",{className:`odd:bg-gray-50 hover:bg-[var(--cor-secundaria)/10] hover:shadow-sm rounded-lg ${a}`,...t,children:e}),d=({children:e,className:a="",compact:t=!1})=>r.jsx("td",{className:`${t?"px-2 py-2":"px-6 py-4"} text-sm ${a}`,style:{color:"var(--cor-texto-secundario)"},children:e}),n=({headers:e,children:a,className:t="",emptyMessage:o="Nenhum dado encontrado",isLoading:s=!1})=>r.jsx("div",{className:`w-full overflow-x-hidden rounded-lg border ${t}`,style:{borderColor:"var(--cor-borda)"},children:(0,r.jsxs)("table",{className:"w-full table-fixed divide-y",style:{borderColor:"var(--cor-borda)"},children:[r.jsx("thead",{className:"bg-gray-100",children:r.jsx("tr",{children:e.map((e,a)=>r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"var(--cor-texto-secundario)"},children:e},a))})}),r.jsx("tbody",{className:"bg-white divide-y",style:{borderColor:"var(--cor-borda)"},children:s?r.jsx("tr",{children:r.jsx("td",{colSpan:e.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:(0,r.jsxs)("div",{className:"flex justify-center items-center py-4",children:[(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r.jsx("span",{className:"ml-2",children:"Carregando..."})]})})}):i().Children.count(a)>0?a:r.jsx("tr",{children:r.jsx("td",{colSpan:e.length,className:"px-6 py-4 text-center text-sm text-gray-500",children:o})})})]})})},94287:(e,a,t)=>{"use strict";t.d(a,{g:()=>r,x:()=>o});let r=()=>{let e=document.cookie?.split("; ").find(e=>e.startsWith("sb-access-token="))?.split("=")[1];return{Authorization:e?`Bearer ${e}`:""}},o={get:async e=>await fetch(e,{method:"GET",headers:{...r(),"Content-Type":"application/json"}}),post:async(e,a)=>await fetch(e,{method:"POST",headers:{...r(),"Content-Type":"application/json"},body:JSON.stringify(a)}),put:async(e,a)=>await fetch(e,{method:"PUT",headers:{...r(),"Content-Type":"application/json"},body:JSON.stringify(a)}),delete:async e=>await fetch(e,{method:"DELETE",headers:{...r(),"Content-Type":"application/json"}})}},76617:(e,a,t)=>{"use strict";t(46179)},15688:(e,a,t)=>{"use strict";t.d(a,{u:()=>s});var r=t(3729),o=t(94287);let i=async()=>{try{let e=await fetch("/api/estoque-producao",{headers:(0,o.g)()});if(!e.ok)throw Error("Erro ao buscar movimenta\xe7\xf5es de produ\xe7\xe3o");return await e.json()}catch(e){return console.error("Erro ao buscar movimenta\xe7\xf5es de produ\xe7\xe3o da API:",e),[]}},s=()=>{let[e,a]=(0,r.useState)([]),[t,s]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{s(!0),a(await i()),s(!1)})()},[]);let d=async t=>{try{let r=await fetch("/api/estoque-producao",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({...t,data:new Date().toISOString(),tipo:"entrada"})});if(!r.ok)throw Error("Erro ao registrar entrada de produ\xe7\xe3o");let i=await r.json(),s=[...e,i];return a(s),i}catch(e){return console.error("Erro ao registrar entrada de produ\xe7\xe3o:",e),null}},n=async t=>{try{let r=await fetch("/api/estoque-producao",{method:"POST",headers:(0,o.g)(),body:JSON.stringify({fichaId:t.fichaId,quantidade:-Math.abs(t.quantidade),data:new Date().toISOString(),tipo:"saida"})});if(!r.ok)throw Error("Erro ao registrar sa\xedda de produ\xe7\xe3o");let i=await r.json(),s=[...e,i];return a(s),i}catch(e){return console.error("Erro ao registrar sa\xedda de produ\xe7\xe3o:",e),null}},c=async(t,r)=>{try{let i=await fetch(`/api/estoque-producao/${t}`,{method:"PUT",headers:(0,o.g)(),body:JSON.stringify(r)});if(!i.ok)throw Error("Erro ao atualizar movimenta\xe7\xe3o de produ\xe7\xe3o");let s=await i.json(),d=e.map(e=>e.id===t?s:e);return a(d),s}catch(e){return console.error("Erro ao atualizar movimenta\xe7\xe3o de produ\xe7\xe3o:",e),null}},l=async t=>{try{if(!(await fetch(`/api/estoque-producao/${t}`,{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar movimenta\xe7\xe3o de produ\xe7\xe3o");let r=e.filter(e=>e.id!==t);return a(r),!0}catch(e){return console.error("Erro ao remover movimenta\xe7\xe3o de produ\xe7\xe3o:",e),!1}};return{movimentacoes:e,isLoading:t,registrarEntrada:d,registrarSaida:n,calcularEstoqueAtual:a=>e.filter(e=>e.fichaId===a).reduce((e,a)=>e+a.quantidade,0),atualizarMovimentacao:c,removerMovimentacao:l}}},34962:(e,a,t)=>{"use strict";t.d(a,{Gm:()=>l,IO:()=>p,N2:()=>f,Q_:()=>i.obterLabelCategoriaReceita,eW:()=>h,gZ:()=>x,lB:()=>n,vG:()=>u,vT:()=>g,zP:()=>d});var r=t(3729),o=t(94287),i=t(76617);let s={g:{tipo:"peso",fator:1},kg:{tipo:"peso",fator:1e3},ml:{tipo:"volume",fator:1},l:{tipo:"volume",fator:1e3},un:{tipo:"unidade",fator:1},cx:{tipo:"unidade",fator:1},pct:{tipo:"unidade",fator:1}},d=(e,a,t)=>{let r=s[a],o=s[t];return r&&o&&r.tipo===o.tipo?e*r.fator/o.fator:e},n=async()=>{try{let e=await fetch("/api/fichas-tecnicas",{headers:(0,o.g)()});if(!e.ok)throw Error(`Erro ao buscar fichas t\xe9cnicas: ${e.status}`);return await e.json()}catch(e){return console.error("Error loading fichas t\xe9cnicas:",e),[]}},c=(e,a)=>e.reduce((e,t)=>{let r=a.find(e=>e.id===t.produtoId);if(!r)return e;let o=t.unidade||r.unidadeMedida,i=s[o]?.tipo;if("peso"===i)return e+d(t.quantidade,o,"g");if("volume"===i)return e+d(t.quantidade,o,"ml");{let a=r.pesoEmbalagem||s[r.unidadeMedida]?.fator||1;return e+d(t.quantidade,o,r.unidadeMedida)*a}},0),l=(e,a,t)=>{let r=s[a]?.tipo;return"peso"===r||"volume"===r?d(c(e,t),"peso"===r?"g":"ml",a):e.reduce((e,r)=>{let o=t.find(e=>e.id===r.produtoId),i=r.unidade||o?.unidadeMedida||"un";return e+d(r.quantidade,i,a)},0)},u=()=>{let[e,a]=(0,r.useState)([]),[t,o]=(0,r.useState)(!1);return{fichasTecnicas:e,isLoading:t,setFichasTecnicas:a,setIsLoading:o,obterFichaTecnicaPorId:a=>e.find(e=>e.id===a),calcularRendimentoTotal:l,atualizarFichaTecnica:m,removerFichaTecnica:f}},p=async e=>{try{let a=await fetch(`/api/fichas-tecnicas/${e}`,{headers:(0,o.g)()});if(!a.ok){if(404===a.status)return null;throw Error("Erro ao buscar ficha t\xe9cnica")}let t=await a.json();return{...t,dataCriacao:t.createdAt?new Date(t.createdAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",dataModificacao:t.updatedAt?new Date(t.updatedAt).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",tempoPreparo:parseInt(t.tempoPreparo)||0,custoTotal:Number(t.custoTotal)||0,custoPorcao:Number(t.custoPorcao)||0,custoPorKg:t.custoTotal&&t.rendimentoTotal?t.custoTotal/t.rendimentoTotal*1e3:0}}catch(e){return console.error("Erro ao buscar ficha t\xe9cnica por ID:",e),null}},h=async e=>{try{let a=await fetch("/api/fichas-tecnicas",{method:"POST",headers:(0,o.g)(),body:JSON.stringify(e)});if(!a.ok){let e=await a.text();throw console.error("Erro na resposta da API:",a.status,e),Error(`Erro ao criar ficha t\xe9cnica: ${a.status}`)}return await a.json()}catch(e){return console.error("Erro ao adicionar ficha t\xe9cnica:",e),null}},m=async(e,a)=>{try{let t=await fetch(`/api/fichas-tecnicas/${e}`,{method:"PUT",headers:(0,o.g)(),body:JSON.stringify(a)});if(!t.ok)throw Error("Erro ao atualizar ficha t\xe9cnica");return await t.json()}catch(e){return console.error("Erro ao atualizar ficha t\xe9cnica:",e),null}},f=async e=>{try{if(!(await fetch(`/api/fichas-tecnicas/${e}`,{method:"DELETE",headers:(0,o.g)()})).ok)throw Error("Erro ao deletar ficha t\xe9cnica");return!0}catch(e){return console.error("Erro ao remover ficha t\xe9cnica:",e),!1}},x=[{value:"porcoes",label:"Por\xe7\xf5es"},{value:"unidades",label:"Unidades"},{value:"kg",label:"Quilogramas (kg)"},{value:"g",label:"Gramas (g)"},{value:"l",label:"Litros (l)"},{value:"ml",label:"Mililitros (ml)"}],g=e=>{let a=x.find(a=>a.value===e);return a?a.label:e}},82389:(e,a,t)=>{"use strict";t.r(a),t.d(a,{$$typeof:()=>i,__esModule:()=>o,default:()=>s});let r=(0,t(86843).createProxy)(String.raw`/workspaces/SistemaChef/src/app/estoque-producao/page.tsx`),{__esModule:o,$$typeof:i}=r,s=r.default}};var a=require("../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[1638,782,337,6408,5413],()=>t(55356));module.exports=r})();